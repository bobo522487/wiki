{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":"<p>\u9996\u9875\uff1a\u4f5c\u4e3a\u77e5\u8bc6\u5e93\u7684\u5165\u53e3\uff0c\u63d0\u4f9b\u7b80\u4ecb\u548c\u5feb\u901f\u94fe\u63a5\u5230\u5176\u4ed6\u90e8\u5206\u3002</p> <p>\u5f15\u8a00\uff1a\u5305\u62ec\u5b66\u4e60\u76ee\u6807\u548c\u77e5\u8bc6\u5e93\u7684\u5bfc\u89c8\u3002</p> <p>\u7f16\u7a0b\u8bed\u8a00\uff1a\u6839\u636e\u4e0d\u540c\u7684\u7f16\u7a0b\u8bed\u8a00\u5206\u7c7b\uff0c\u6bcf\u4e2a\u8bed\u8a00\u4e0b\u6709\u57fa\u7840\u3001\u8fdb\u9636\u548c\u76f8\u5173\u6846\u67b6\u6216\u5e93\u7684\u6587\u6863\u3002</p> <p>\u8f6f\u4ef6\u5f00\u53d1\uff1a\u5305\u62ec\u7248\u672c\u63a7\u5236\u3001\u8f6f\u4ef6\u5de5\u7a0b\u5b9e\u8df5\u548c\u7cfb\u7edf\u67b6\u6784\u7684\u77e5\u8bc6\u3002</p> <p>\u6570\u636e\u79d1\u5b66\uff1a\u6db5\u76d6\u6570\u636e\u5206\u6790\u3001\u673a\u5668\u5b66\u4e60\u4ee5\u53ca\u6570\u636e\u53ef\u89c6\u5316\u7684\u77e5\u8bc6\u70b9\u3002</p> <p>\u7f51\u7edc\u6280\u672f\uff1a\u7f51\u7edc\u534f\u8bae\u3001API \u8bbe\u8ba1\u548c\u7f51\u7edc\u5b89\u5168\u7684\u57fa\u7840\u77e5\u8bc6\u3002</p> <p>\u5de5\u5177\u548c\u73af\u5883\uff1a\u5e38\u7528\u7684\u5f00\u53d1\u5de5\u5177\u3001\u547d\u4ee4\u884c\u64cd\u4f5c\u548c\u73af\u5883\u7ba1\u7406\u6280\u5de7\u3002</p> <p>\u5b66\u4e60\u8d44\u6e90\uff1a\u63a8\u8350\u7684\u5b66\u4e60\u8d44\u6e90\uff0c\u5982\u5728\u7ebf\u8bfe\u7a0b\u3001\u4e66\u7c4d\u548c\u793e\u533a\u3002</p> <p>\u4e2a\u4eba\u9879\u76ee\uff1a\u8bb0\u5f55\u4e2a\u4eba\u9879\u76ee\u7684\u6587\u6863\u548c\u7ecf\u9a8c\u603b\u7ed3\u3002</p>"},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/chia/GUI%E8%AE%BF%E9%97%AE%E8%BF%9C%E7%A8%8BCHIA/","title":"GUI\u8bbf\u95ee\u8fdc\u7a0bCHIA","text":""},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/chia/GUI%E8%AE%BF%E9%97%AE%E8%BF%9C%E7%A8%8BCHIA/#gui-full-node","title":"GUI\u8bbf\u95ee\u8fdc\u7a0b full node","text":""},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/chia/GUI%E8%AE%BF%E9%97%AE%E8%BF%9C%E7%A8%8BCHIA/#on-the-daemon-host","title":"On the daemon host","text":""},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/chia/GUI%E8%AE%BF%E9%97%AE%E8%BF%9C%E7%A8%8BCHIA/#expose-the-daemon-to-the-network","title":"Expose the daemon to the network","text":"<p>In <code>config.yaml</code>, change <code>self_hostname</code> from <code>localhost</code> to <code>0.0.0.0</code>. This binds the daemon to all IPv4 addresses on the local machine.</p> <p>Next, open the port that the daemon is listening on (55400 by default). The UI assumes that the daemon is already running and it will not attempt to start a remote daemon. Using ufw and restricting traffic to just the UI's host:</p> <pre><code>sudo ufw allow from &lt;IP of UI machine&gt; to any port 55400 proto tcp\n</code></pre>"},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/chia/GUI%E8%AE%BF%E9%97%AE%E8%BF%9C%E7%A8%8BCHIA/#copy-the-daemons-cert-files","title":"Copy the daemon's cert files","text":"<p>To secure their connection, the GUI will need the daemon's certificates. Copy these files to the Windows machine:</p> <pre><code>~/.chia/mainnet/config/ssl/daemon/private_daemon.crt\n~/.chia/mainnet/config/ssl/daemon/private_daemon.key\n</code></pre>"},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/chia/GUI%E8%AE%BF%E9%97%AE%E8%BF%9C%E7%A8%8BCHIA/#on-the-gui-host","title":"On the GUI host","text":""},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/chia/GUI%E8%AE%BF%E9%97%AE%E8%BF%9C%E7%A8%8BCHIA/#reference-the-daemons-cert-files","title":"Reference the daemon's cert files","text":"<p>Place the daemon's cert files, copied earlier, in the following location:</p> <pre><code>~/.chia/mainnet/config/ssl/ui/\n~/.chia/mainnet/config/ssl/ui/\n</code></pre> <p>Find the <code>ui</code> section in <code>config.yaml</code> and specify the following settings:</p> <pre><code>daemon_host: &lt;name or IP of the daemon host&gt;\ndaemon_port: 55400\ndaemon_ssl:\n  private_crt: config/ssl/ui/private_daemon.crt\n  private_key: config/ssl/ui/private_daemon.key\n</code></pre>"},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/chia/%E5%AE%89%E8%A3%85%E6%8C%87%E5%8D%97/","title":"\u5b89\u88c5\u6307\u5357","text":"<pre><code>launcherId: 0x5430b6b76a6546c1196d6235c1b50d3509173f3921383b29f95eb6679a4e9fd7\nDeveloper-Key: ioM34M84JFb2biej1Hhl9Nw1GKbcartkKz8G1MvSX0yIchZxDbiyXVXQsndBfePv\nUser-Agent: Mozilla/5.0 (Linux; Android 10; K) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Mobile Safari/537.36\n</code></pre> <pre><code># \u66f4\u65b0\u8f6f\u4ef6\napt update\n\n# \u5b89\u88c5\u78c1\u76d8\u5de5\u5177\napt install -y duf docker-compose glances nvtop smartmontools\n</code></pre> <p>Nvidia\u82f1\u4f1f\u8fbe\u663e\u5361\u9a71\u52a8</p> <pre><code># \u67e5\u770b\u7cfb\u7edf\u4e2d\u662f\u5426\u6709nvidia\u663e\u5361\nlspci | grep -i nvidia\n\n# \u68c0\u67e5\u53ef\u7528\u7684\u9a71\u52a8\nubuntu-drivers devices\n\n# \u5b89\u88c5\u6807\u8bb0\u6709recommended\u6807\u5fd7\u7684\u9a71\u52a8\nsudo apt install nvidia-driver-535 -y\n# sudo apt install nvidia-driver-470 -y\n\n# \u5b89\u88c5\u5b8c\u9a71\u52a8\u540e\uff0c\u5fc5\u987b\u91cd\u542f\u7535\u8111\uff0c\u91cd\u542f\u540e\u518d\u6b21\u8fd0\u884c nvidia-smi \u53ef\u4ee5\u770b\u5230\u663e\u5361\u4fe1\u606f\n</code></pre> <pre><code># Add NVIDIA package repositories\ncurl -s -L https://nvidia.github.io/nvidia-docker/gpgkey | sudo apt-key add -\ndistribution=$(lsb_release -cs)\ncurl -s -L https://nvidia.github.io/nvidia-docker/$distribution/nvidia-docker.list | sudo tee /etc/apt/sources.list.d/nvidia-docker.list\n\n# Install NVIDIA Docker runtime\nsudo apt-get update\nsudo apt-get install -y nvidia-docker2\n\n# Restart Docker service to apply changes\nsudo systemctl restart docker\n\n\n# \u542f\u52a8\u5bb9\u5668\ndocker run -d --gpus all --rm --cap-add SYS_ADMIN -p 9400:9400 nvcr.io/nvidia/k8s/dcgm-exporter:3.1.8-3.1.5-ubuntu20.04\n\ndocker pull nvidia/dcgm-exporter:3.3.0-3.2.0-ubuntu22.04\n\n# \u4e0b\u8f7dgrafana\u95e8\u6237\u914d\u7f6e\u6587\u4ef6\u5230\u672c\u5730\nhttps://github.com/NVIDIA/dcgm-exporter/blob/main/grafana/dcgm-exporter-dashboard.json\n\n# \u8fdb\u5165grafana\uff0cDashboard / new / import \uff0c\u4e0a\u4f20\u914d\u7f6e\u6587\u4ef6\uff0c \u70b9\u51fb import\n</code></pre> <pre><code>&lt;farmer_public_key&gt;\na95b4750acc1fbbcddb133e25f5baf3add752a4e2213c39455dd7511ad792bcda5caa492cba1a507b62ffba915a54478\n\n&lt;pool_contract_address&gt;\nxch1vww5cnu9kgtrcevjaw9nqr3ps4uz3erg9lpq4dakcur9u8nrpq2s5p234z\n</code></pre> <pre><code>screen -S plow\npython3 /root/plow/plow.py\n</code></pre> <p>\u5e38\u7528\u547d\u4ee4</p> <pre><code>#\u6279\u91cf\u6dfb\u52a0\u519c\u7530\u76ee\u5f55\nlsblk | grep farm | awk '{print $7}' &gt; hdd.txt\nfor i in $(cat hdd.txt); do echo $i ; docker exec chia-harvester chia plots add -d $i; done\n\n#\u5b89\u88c5nfs\nsudo apt-get install nfs-common\n\n#\u7f16\u8f91 \nvim /etc/fstab\n#\u6dfb\u52a0\u5230\u6700\u540e\u4e00\u884c 10.10.10.18:/volume1/plots /data1 nfs defaults 0 0\nmount -a\n\n\u4e3b\u673a\u62f7\u8d1dca\u76ee\u5f55\u5230\u8fdc\u7a0b\u6536\u5272\u673a\nscp -r /root/.chia/mainnet/config/ssl/ca/ root@10.10.10.21:/root/\n</code></pre> <pre><code>sudo apt update\nsudo apt upgrade -y\nsudo apt install docker-compose duf glances smartmontools nvtop nvidia-driver-535 git -y\n\n#\u6dfb\u52a0\u5305\u5b58\u50a8\u5e93\ndistribution=$(. /etc/os-release;echo $ID$VERSION_ID)\ncurl -s -L https://nvidia.github.io/nvidia-docker/gpgkey | sudo apt-key add -\ncurl -s -L https://nvidia.github.io/nvidia-docker/$distribution/nvidia-docker.list | sudo tee /etc/apt/sources.list.d/nvidia-docker.list\n\n#\u4e0b\u8f7d\u5b89\u88c5nvidia\u5305\nsudo apt update\nsudo apt install -y nvidia-container-toolkit\nsudo nvidia-ctk runtime configure\nsudo systemctl restart docker\n\ngit clone https://github.com/madMAx43v3r/chia-gigahorse.git\nsudo reboot now\n\nsudo swapoff -a\nsudo wipefs -fa /dev/nvme0n1\nsudo mkfs.btrfs /dev/nvme0n1\nsudo mkdir -v /mnt/plottemp\nsudo mount -o discard=async,nodatacow,nodatasum /dev/nvme0n1 /mnt/plottemp\nsudo chmod -R uo+rw /mnt/plottemp\n\n# gigahorse 128G\u5185\u5b58\u6a21\u5f0f  10.10.10.41\nnohup /root/chia-gigahorse/cuda-plotter/linux/x86_64/cuda_plot_k32_v3 -n -1 -C 31 -t /mnt/plottemp/ -2 /mnt/plottemp/ -d @harvester01 -d @harvester02 -d @harvester03 -c xch1vww5cnu9kgtrcevjaw9nqr3ps4uz3erg9lpq4dakcur9u8nrpq2s5p234z -f a95b4750acc1fbbcddb133e25f5baf3add752a4e2213c39455dd7511ad792bcda5caa492cba1a507b62ffba915a54478 &gt; /root/output.log 2&gt;&amp;1 &amp;\n\n# gigahorse 128G\u5185\u5b58\u6a21\u5f0f  10.10.10.42\nnohup /root/chia-gigahorse/cuda-plotter/linux/x86_64/cuda_plot_k32 -n -1 -C 18 -t /mnt/plottemp/ -2 /mnt/plottemp/ -d /farm/hdd21-3FGMX8PT/ -d /farm/hdd22-3WJRBVZJ/ -d /farm/hdd23-3FH9X0BU/ -d /farm/hdd24-3FHBWUSU/ -d /farm/hdd25-3RHAJ2XA/ -d /farm/hdd26-3RHHJMMA/ -d /farm/hdd27-3FHBRXHU/ -d /farm/hdd28-3FGPP2HT/ -d /farm/hdd29-3FHBX3PU/ -d /farm/hdd30-3RHDYKMA/ -d /farm/hdd31-3RHAHGKA/ -d /farm/hdd32-3GJBSRGK/ -d /farm/hdd33-3FHBRLJU/ -d /farm/hdd34-3FHBWXHU/ -d /farm/hdd35-3RHD1TMA/ -d /farm/hdd36-3FGP3LAT/ -d /farm/hdd37-3FGPP2JT/ -d /farm/hdd38-3FGNDK7T/ -d /farm/hdd39-3FGR191T/ -d /farm/hdd40-3RHBBATA/ -d /farm/hdd41-3FGJX90T/ -d /farm/hdd42-3FGLT48U/ -d /farm/hdd43-3GKLWXJF/ -d /farm/hdd44-3GHHA3SE/ -d /farm/hdd45-3RHDGDUA/ -d /farm/hdd46-3RHB8TNA/ -d /farm/hdd47-3GKKHE3F/ -d /farm/hdd48-3FGPB7HT/ -c xch1vww5cnu9kgtrcevjaw9nqr3ps4uz3erg9lpq4dakcur9u8nrpq2s5p234z -f a95b4750acc1fbbcddb133e25f5baf3add752a4e2213c39455dd7511ad792bcda5caa492cba1a507b62ffba915a54478 &gt; /root/output.log 2&gt;&amp;1 &amp;\n\nnohup /root/chia-gigahorse/cuda-plotter/linux/x86_64/cuda_plot_k32_v3 -n -1 -C 31 -t /mnt/plottemp/ -2 /mnt/plottemp/ -d /farm/hdd01-3RHDYYZA/ -d /farm/hdd02-3FGNRM6T/ -d /farm/hdd03-3FHDDE4U/ -d /farm/hdd04-3GKL329F/ -d /farm/hdd05-3FGLT55U/ -d /farm/hdd06-3WJDAS4J/  -c xch1vww5cnu9kgtrcevjaw9nqr3ps4uz3erg9lpq4dakcur9u8nrpq2s5p234z -f a95b4750acc1fbbcddb133e25f5baf3add752a4e2213c39455dd7511ad792bcda5caa492cba1a507b62ffba915a54478 &gt; /root/output.log 2&gt;&amp;1 &amp;\n\n\n\n\nnohup /root/chia-gigahorse/plot-sink/linux/x86_64/chia_plot_sink -- /farm/hdd31-3RHAHGKA/ /farm/hdd32-3GJBSRGK/ /farm/hdd33-3FHBRLJU/ /farm/hdd34-3FHBWXHU/ /farm/hdd35-3RHD1TMA/ /farm/hdd36-3FGP3LAT/ /farm/hdd37-3FGPP2JT/ /farm/hdd38-3FGNDK7T/ /farm/hdd39-3FGR191T/ &gt; /root/plot-sink.log 2&gt;&amp;1 &amp;\n\n# 43\nnohup /root/chia-gigahorse/cuda-plotter/linux/x86_64/cuda_plot_k32 -n -1 -C 18 -t /mnt/plottemp/ -d /farm/hdd31-3FGPAAJT/ -d /farm/hdd32-3GKLWULF/ -d /farm/hdd33-3WJ3M6LJ/ -d /farm/hdd34-3FGNRMZT/ -d /farm/hdd35-3RHDL4YA/ -d /farm/hdd36-3FHG4YET/ -d /farm/hdd37-3RHAKHLA/ -d /farm/hdd38-61Q0A1QNF57H/ -d /farm/hdd39-3FHDD92U/ -d /farm/hdd40-61Q0A1UJF57H/ -d /farm/hdd41-61Q0A1QYF57H/ -d /farm/hdd42-61Q0A1QAF57H/ -d /farm/hdd43-61Q0A1RAF57H/ -d /farm/hdd44-61Q0A1MTF57H/ -d /farm/hdd45-61Q0A1NUF57H/ -d /farm/hdd46-61Q0A1Q2F57H/ -d /farm/hdd47-61Q0A1TQF57H/ -d /farm/hdd48-61Q0A1R7F57H/ -d /farm/hdd49-61Q0A1QKF57H/ -d /farm/hdd50-61Q0A1PLF57H/ -d /farm/hdd51-61Q0A1R3F57H/ -d /farm/hdd52-ZL2J22Y0/ -d /farm/hdd53-ZL2GNFTM/ -c xch1vww5cnu9kgtrcevjaw9nqr3ps4uz3erg9lpq4dakcur9u8nrpq2s5p234z -f a95b4750acc1fbbcddb133e25f5baf3add752a4e2213c39455dd7511ad792bcda5caa492cba1a507b62ffba915a54478 &gt; /root/output.log 2&gt;&amp;1 &amp;\n\nnohup /root/chia-gigahorse/plot-sink/linux/x86_64/chia_plot_sink -- /farm/hdd01-3FGPNLUT/ /farm/hdd02-3FHBRRMU/ /farm/hdd03-3JG15MAG/ /farm/hdd04-3RG5J09A/ /farm/hdd05-3RHDMPHA/ /farm/hdd06-3FGR7DET/ /farm/hdd07-3FHBTLLU/ /farm/hdd08-3FGR1D6T/ /farm/hdd09-3RHHJR0A/ /farm/hdd10-3FHBP5VU/ /farm/hdd11-3RHHJMXA/ /farm/hdd12-3RHDWAZA/ &gt; /root/plot-sink.log 2&gt;&amp;1 &amp;\n\n# 44\nnohup /root/chia-gigahorse/cuda-plotter/linux/x86_64/cuda_plot_k32 -n -1 -C 18 -t /mnt/plottemp/ -2 /mnt/plottemp/ -d /mnt/plottemp/ -c xch1vww5cnu9kgtrcevjaw9nqr3ps4uz3erg9lpq4dakcur9u8nrpq2s5p234z -f a95b4750acc1fbbcddb133e25f5baf3add752a4e2213c39455dd7511ad792bcda5caa492cba1a507b62ffba915a54478 &gt; /root/output.log 2&gt;&amp;1 &amp;\n\nnohup ./root/scp.sh &gt; /root/scp.log 2&gt;&amp;1 &amp;\n\nchia_plot_sink -- /mnt/disk0/ /mnt/disk1/\n\nnohup /root/chia-gigahorse/plot-sink/linux/x86_64/chia_plot_sink -- /farm/hdd01-3FGPNLUT/ /farm/hdd02-3FHBRRMU/ /farm/hdd03-3JG15MAG/ /farm/hdd04-3RG5J09A/ /farm/hdd05-3RHDMPHA/ /farm/hdd06-3FGR7DET/ /farm/hdd07-3FHBTLLU/ /farm/hdd08-3FGR1D6T/ /farm/hdd09-3RHHJR0A/ /farm/hdd10-3FHBP5VU/ /farm/hdd11-3RHHJMXA/ /farm/hdd12-3RHDWAZA/  &gt; /root/plot-sink.log 2&gt;&amp;1 &amp;\n\nnohup /root/chia-gigahorse/plot-sink/linux/x86_64/chia_plot_copy -d -t 172.16.109.42 -- /mnt/plottemp/plot-k32-c*.plot  &gt; /root/plot-copy.log 2&gt;&amp;1 &amp;\n</code></pre> <p>\u683c\u5f0f\u5316\u786c\u76d8</p> <pre><code># \u683c\u5f0f\u5316\uff0c\u4ecesdb\u5f00\u59cb\u4e4b\u540e\u7684\u786c\u76d8\ncd ~/scripts/mount\n./format.sh\n\n# \u67e5\u770b\u7ed3\u679c\nlsblk -o NAME,UUID\n\n# \u6302\u8f7d\u786c\u76d8\n./mount.sh\n\ndd if=/dev/sda of=/dev/sdb bs=4096 progress=yes\n\n\nsudo wipefs -fa /dev/sdb\nsudo mkfs.ext4 -m 0 -T largefile4 -F /dev/sdb\n\n</code></pre> <pre><code>\n\nlsblk -o name,uuid,size | awk -v drive=\"$drive\" '$1 == drive {print $2}'\nsmartctl -a \"/dev/$drive\" | grep \"Serial Number\" | awk '{print $3}'\n\nProofOfSpace farm -r 8 --diff 35 -f xxxx 1000\n\ncurl -X POST http://172.16.109.40:9090/-/reload\ncurl -X POST http://127.0.0.1:9093/-/reload\n# \u4fee\u6539\u65f6\u533a\ntimedatectl set-timezone Asia/Shanghai\n</code></pre>"},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/robot/%E5%B7%A1%E7%BA%BF/","title":"\u5de1\u7ebf","text":""},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/robot/%E5%B7%A1%E7%BA%BF/#_1","title":"\u5de1\u7ebf\u8fd0\u52a8","text":"<p>\u7f16\u5199\u4e00\u4e2a\u57fa\u4e8e\u6536\u5230\u7684\u5f53\u524d\u8def\u7ebf\u4e2d\u5fc3\u70b9\u5750\u6807\u7684\u5de1\u7ebf\u7a0b\u5e8f\uff1a</p> <ol> <li>\u4f7f\u7528<code>geometry_msgs/msg/PointStamped</code>\u6d88\u606f\u8ba2\u9605 <code>/yolov8_interface</code> \u4e3b\u9898\uff0c\u8fd9\u4e2a\u6d88\u606f\u5305\u542b\u4e86\u5f53\u524d\u8def\u7ebf\u4e2d\u5fc3\u70b9\u7684\u59ff\u6001\u5750\u6807\u3002</li> <li>\u4f7f\u7528<code>sensor_msgs.msg import Imu</code>\u6d88\u606f\u8ba2\u9605 <code>/imu/data</code> \u4e3b\u9898\uff0c\u83b7\u53d6\u5f53\u524d\u9640\u87ba\u4eea\u4fe1\u606f</li> <li>\u7f16\u5199\u4e00\u4e2a ROS 2 Python \u8282\u70b9\uff0c\u5b83\u8ba2\u9605 <code>/yolov8_interface</code> \u4e3b\u9898\uff0c\u5e76\u6839\u636e\u63a5\u6536\u5230\u7684\u5750\u6807\u8ba1\u7b97\u51fa\u5de1\u7ebf\u6240\u9700\u7684\u63a7\u5236\u6307\u4ee4\u3002</li> <li>\u6211\u4eec\u5c06\u4f7f\u7528 <code>geometry_msgs.msg.Twist</code> \u6d88\u606f\u6765\u53d1\u5e03\u63a7\u5236\u6307\u4ee4\uff0c\u8fd9\u4e9b\u6307\u4ee4\u5c06\u88ab\u53d1\u9001\u5230\u673a\u5668\u4eba\u7684\u5e95\u5ea7\u6216\u5176\u4ed6\u76f8\u5173\u786c\u4ef6\u63a5\u53e3\u4e0a\u3002</li> <li>\u521b\u5efa\u4e00\u4e2a\u589e\u91cf\u5f0fPID\u63a7\u5236\u5668\u7684\u7c7b\uff08\u542b\u4e8c\u6b21\u9879 &amp; \u9640\u87ba\u4eea\uff09\uff0c\u4f9b\u53d1\u5e03\u63a7\u5236\u6307\u4ee4\u65f6\u8c03\u7528</li> </ol> <pre><code>import rclpy\nfrom rclpy.node import Node\nfrom geometry_msgs.msg import PointStamped, Twist\nfrom sensor_msgs.msg import Imu\n\nclass PIDController:\n    def __init__(self, kp, kp2, kd, kd2):\n        # PID\u63a7\u5236\u5668\u521d\u59cb\u5316\n        self.kp = kp  # \u6bd4\u4f8b\u7cfb\u6570\n        self.kp2 = kp2  # \u975e\u7ebf\u6027\u6bd4\u4f8b\u7cfb\u6570\n        self.kd = kd  # \u5fae\u5206\u7cfb\u6570\n        self.kd2 = kd2  # \u5fae\u5206\u9879\u7684\u8865\u507f\u7cfb\u6570\n        self.prev_position_error = 0  # \u4e0a\u4e00\u6b21\u7684\u4f4d\u7f6e\u8bef\u5dee\n\n    def update(self, position_error, angular_velocity):\n        # \u66f4\u65b0PID\u63a7\u5236\u5668\u7684\u8f93\u51fa\n        proportional_term = position_error * self.kp + abs(position_error) * position_error * self.kp2\n        derivative_term = (position_error - self.prev_position_error) * self.kd\n        gyro_term = angular_velocity * self.kd2\n        output = proportional_term + derivative_term + gyro_term\n        self.prev_position_error = position_error\n        return output\n\nclass LineFollowingController(Node):\n    def __init__(self):\n        super().__init__('line_following_controller')\n        # \u4ece\u53c2\u6570\u670d\u52a1\u5668\u83b7\u53d6PID\u53c2\u6570\uff0c\u5982\u679c\u6ca1\u6709\u8bbe\u7f6e\u5219\u4f7f\u7528\u9ed8\u8ba4\u503c\n        self.pid_controller = self.get_pid_controller()\n\n        self.current_x = 0\n        self.bottom_center = 380  # \u76ee\u6807X\u5750\u6807\n        self.linear_velocity = 0.2  # \u7ebf\u901f\u5ea6\n\n        # \u521b\u5efa\u8ba2\u9605\u8005\u548c\u53d1\u5e03\u8005\n        self.create_subscription(PointStamped, '/yolo/detect_pos', self.yolo_callback, 10)\n        self.create_subscription(Imu, '/imu/data', self.imu_callback, 10)\n        self.cmd_vel_publisher = self.create_publisher(Twist, \"/cmd_vel\", 1)\n\n    def get_pid_controller(self):\n        # \u4ece\u53c2\u6570\u670d\u52a1\u5668\u83b7\u53d6PID\u53c2\u6570\uff0c\u5982\u679c\u6ca1\u6709\u8bbe\u7f6e\u5219\u4f7f\u7528\u9ed8\u8ba4\u503c\n        kp = self.get_parameter('kp').get_parameter_value().double_value\n        kp2 = self.get_parameter('kp2').get_parameter_value().double_value\n        kd = self.get_parameter('kd').get_parameter_value().double_value\n        kd2 = self.get_parameter('kd2').get_parameter_value().double_value\n        return PIDController(kp, kp2, kd, kd2)\n\n    def yolo_callback(self, msg):\n        # yolo_callback\u56de\u8c03\u51fd\u6570\uff0c\u5904\u7406YOLO\u68c0\u6d4b\u7ed3\u679c\n        try:\n            if msg is None or (msg.point.x == 0 and msg.point.y == 0 and msg.point.z == 0): \n                self.publish_empty_twist()  # \u53d1\u5e03\u7a7a\u7684Twist\u6d88\u606f\n            else:\n                self.current_x = msg.point.x\n                position_error = self.current_x - self.bottom_center\n\n                cmd_vel = Twist()\n                if abs(position_error) &lt; 30:\n                    cmd_vel.angular.z = 0.0\n                else:\n                    cmd_vel.angular.z = self.pid_controller.update(position_error, self.angular_velocity)\n                cmd_vel.linear.x = self.linear_velocity\n                self.cmd_vel_publisher.publish(cmd_vel)  # \u53d1\u5e03Twist\u6d88\u606f\n        except Exception as e:\n            self.get_logger().warn(f'Error in yolo_callback: {e}')\n\n    def imu_callback(self, msg):\n        # imu_callback\u56de\u8c03\u51fd\u6570\uff0c\u5904\u7406IMU\u6570\u636e\n        try:\n            self.angular_velocity = msg.angular_velocity.z  # \u66f4\u65b0\u89d2\u901f\u5ea6\n        except Exception as e:\n            self.get_logger().warn(f'Error in imu_callback: {e}')\n\n    def publish_empty_twist(self):\n        # \u53d1\u5e03\u7a7a\u7684Twist\u6d88\u606f\n        cmd_vel = Twist()\n        self.cmd_vel_publisher.publish(cmd_vel)\n\ndef main(args=None):\n    rclpy.init(args=args)\n    linedetect = LineFollowingController()\n    try:\n        rclpy.spin(linedetect)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        linedetect.publish_empty_twist()\n        linedetect.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n\n</code></pre> <pre><code>import rclpy\nfrom rclpy.node import Node\nfrom geometry_msgs.msg import PointStamped, Twist\nfrom sensor_msgs.msg import Imu\nfrom threading import Lock\nimport threading\n\nclass PIDController:\n    def __init__(self, kp, kp2, kd, kd2):\n        # \u521d\u59cb\u5316PID\u63a7\u5236\u5668\u7684\u53c2\u6570\u548c\u53d8\u91cf\n        self.kp = kp  # \u6bd4\u4f8b\u7cfb\u6570\n        self.kp2 = kp2  # \u6bd4\u4f8b\u7cfb\u65702\n        self.kd = kd  # \u5fae\u5206\u7cfb\u6570\n        self.kd2 = kd2  # \u5fae\u5206\u7cfb\u65702\n        self.prev_position_error = 0  # \u4e0a\u4e00\u4e2a\u4f4d\u7f6e\u8bef\u5dee\n        self.lock = Lock()  # \u7ebf\u7a0b\u9501\uff0c\u786e\u4fdd\u6570\u636e\u8bbf\u95ee\u7684\u7ebf\u7a0b\u5b89\u5168\n\n    def update(self, position_error, angular_velocity):\n        # \u66f4\u65b0PID\u63a7\u5236\u5668\u7684\u8f93\u51fa\n        with self.lock:\n            proportional_term = position_error * self.kp + abs(position_error) * position_error * self.kp2\n            derivative_term = (position_error - self.prev_position_error) * self.kd\n            gyro_term = angular_velocity * self.kd2\n            output = proportional_term + derivative_term + gyro_term\n            self.prev_position_error = position_error\n        return output\n\nclass LineFollowingController(Node):\n    def __init__(self):\n        super().__init__('line_following_controller')\n        # \u521d\u59cb\u5316\u8282\u70b9\n        self.lock = Lock()  # \u7ebf\u7a0b\u9501\uff0c\u786e\u4fdd\u6570\u636e\u8bbf\u95ee\u7684\u7ebf\u7a0b\u5b89\u5168\n        self.pid_controller = None  # PID\u63a7\u5236\u5668\u5bf9\u8c61\n        self.target_x = 320  # \u76ee\u6807X\u5750\u6807\n        self.linear_velocity = 0.2  # \u7ebf\u901f\u5ea6\n        self.angular_velocity = 0  # \u89d2\u901f\u5ea6\n        self.cmd_vel_publisher = None  # Twist\u6d88\u606f\u53d1\u5e03\u5668\n\n    def start(self):\n        # \u542f\u52a8\u8282\u70b9\n        self.pid_controller = PIDController(0.5, 0.1, 0.1, 0.05)  # \u521d\u59cb\u5316PID\u63a7\u5236\u5668\n        self.create_subscription(PointStamped, '/yolo/detect_pos', self.yolo_callback, 10)  # \u521b\u5efayolo_callback\u7684\u8ba2\u9605\n        self.create_subscription(Imu, '/imu/data', self.imu_callback, 10)  # \u521b\u5efaimu_callback\u7684\u8ba2\u9605\n        self.cmd_vel_publisher = self.create_publisher(Twist, '/cmd_vel', 10)  # \u521b\u5efaTwist\u6d88\u606f\u53d1\u5e03\u5668\n\n    def yolo_callback(self, msg):\n        # yolo_callback\u56de\u8c03\u51fd\u6570\uff0c\u5904\u7406YOLO\u68c0\u6d4b\u7ed3\u679c\n        threading.Thread(target=self.process_yolo_data, args=(msg,)).start()  # \u5728\u65b0\u7ebf\u7a0b\u4e2d\u5904\u7406YOLO\u6570\u636e\n\n    def imu_callback(self, msg):\n        # imu_callback\u56de\u8c03\u51fd\u6570\uff0c\u5904\u7406IMU\u6570\u636e\n        threading.Thread(target=self.process_imu_data, args=(msg,)).start()  # \u5728\u65b0\u7ebf\u7a0b\u4e2d\u5904\u7406IMU\u6570\u636e\n\n    def process_yolo_data(self, msg):\n        # \u5904\u7406YOLO\u6570\u636e\u7684\u51fd\u6570\n        current_x = msg.point.x\n        position_error = self.target_x - current_x\n        pid_output = self.pid_controller.update(position_error, self.angular_velocity)\n        cmd_vel = Twist()\n        cmd_vel.linear.x = self.linear_velocity\n        cmd_vel.angular.z = pid_output\n        self.lock.acquire()  # \u52a0\u9501\uff0c\u786e\u4fdd\u5bf9\u5171\u4eab\u6570\u636e\u7684\u8bbf\u95ee\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\n        self.cmd_vel_publisher.publish(cmd_vel)  # \u53d1\u5e03Twist\u6d88\u606f\n        self.lock.release()  # \u91ca\u653e\u9501\n\n    def process_imu_data(self, msg):\n        # \u5904\u7406IMU\u6570\u636e\u7684\u51fd\u6570\n        self.lock.acquire()  # \u52a0\u9501\uff0c\u786e\u4fdd\u5bf9\u5171\u4eab\u6570\u636e\u7684\u8bbf\u95ee\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\n        self.angular_velocity = msg.angular_velocity.z  # \u66f4\u65b0\u89d2\u901f\u5ea6\n        self.lock.release()  # \u91ca\u653e\u9501\n\ndef main(args=None):\n    rclpy.init(args=args)\n    executor = rclpy.executors.MultiThreadedExecutor()  # \u521b\u5efa\u591a\u7ebf\u7a0b\u6267\u884c\u5668\n    line_following_controller = LineFollowingController()\n    line_following_controller.start()  # \u542f\u52a8\u8282\u70b9\n    executor.add_node(line_following_controller)  # \u5c06\u8282\u70b9\u6dfb\u52a0\u5230\u6267\u884c\u5668\n    try:\n        executor.spin()  # \u8fd0\u884c\u591a\u7ebf\u7a0b\u6267\u884c\u5668\n    finally:\n        executor.shutdown()  # \u5173\u95ed\u6267\u884c\u5668\n        line_following_controller.destroy_node()  # \u9500\u6bc1\u8282\u70b9\n        rclpy.shutdown()  # \u5173\u95edROS2\n\nif __name__ == '__main__':\n    main()\n\n</code></pre>"},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/robot/%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/","title":"\u5f00\u6e90\u9879\u76ee","text":"<p>https://github.com/linorobot/linorobot2</p> <p>https://github.com/ROBOTIS-GIT/turtlebot3</p> <p>https://github.com/fishros/fishbot</p> <p>https://gitee.com/guyuehome/originbot</p>"},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/robot/%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/#_1","title":"\u6f2b\u6e38\u8005\u9879\u76ee","text":"<p>https://github.com/nasa-jpl/open-source-rover</p>"},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/robot/%E6%8E%A7%E5%88%B6%E4%B8%B2%E5%8F%A3%E8%88%B5%E6%9C%BA/","title":"\u63a7\u5236\u4e32\u53e3\u8235\u673a","text":"<pre><code>#!/usr/bin/env python3\n#coding=utf-8\nimport time\nfrom Rosmaster_Lib import Rosmaster\nfrom ipywidgets import interact\nimport ipywidgets as widgets\n\n# \u521b\u5efaRosmaster\u5bf9\u8c61 bot Create the Rosmaster object bot\nbot = Rosmaster()\n\n# \u542f\u52a8\u63a5\u6536\u6570\u636e Start receiving data\nbot.create_receive_threading()\n\n# \u5f53\u524d\u8235\u673aID\u53f7 ID of current steering gear\nservo_id = 6\n\n# \u63a7\u5236\u4e32\u53e3\u8235\u673a\u5173\u8282\u8fd0\u52a8 Control the joint movement of serial steering gear\ndef arm_servo(s_angle):\n    bot.set_uart_servo_angle(servo_id, s_angle)\n\n# \u8bfb\u53d6\u5f53\u524d\u4e32\u53e3\u8235\u673a\u7684\u89d2\u5ea6\uff0c\u8bfb\u53d6\u7684\u89d2\u5ea6\u503c\u548c\u8bbe\u7f6e\u7684\u89d2\u5ea6\u503c\u53ef\u80fd\u5b58\u57281-2\u5ea6\u504f\u5dee\u3002\n# \u8bfb\u53d6\u9519\u8bef\u8fd4\u56de-1\nread_servo = bot.get_uart_servo_angle(servo_id)\nprint(\"read angle:\", servo_id, read_servo)\n\n# \u4e00\u6b21\u6027\u8bfb\u53d6\u516d\u4e2a\u8235\u673a\u89d2\u5ea6\uff0c\u8bfb\u53d6\u7684\u89d2\u5ea6\u503c\u548c\u8bbe\u7f6e\u7684\u89d2\u5ea6\u503c\u53ef\u80fd\u5b58\u57281-2\u5ea6\u504f\u5dee\u3002\n# \u8bfb\u53d6\u6b63\u786e\u8fd4\u56de\u516d\u4e2a\u8235\u673a\u7684\u89d2\u5ea6[xx, xx, xx, xx, xx, xx]\uff0c\u5982\u679c\u67d0\u4e2a\u8235\u673a\u9519\u8bef\u5219\u90a3\u4e00\u4f4d\u4e3a-1\nread_array = bot.get_uart_servo_angle_array()\nprint(\"read array:\", read_array)\n\n# \u7a0b\u5e8f\u7ed3\u675f\u540e\u8bf7\u5220\u9664\u5bf9\u8c61\uff0c\u907f\u514d\u5728\u5176\u4ed6\u7a0b\u5e8f\u4e2d\u4f7f\u7528Rosmaster\u5e93\u9020\u6210\u51b2\u7a81\ndel bot\n\n\n# bot.set_uart_servo_angle_array([0, 0, 30, 0, 90, 30])\n# bot.set_uart_servo_angle_array([0, 0, 30, 0, 90, 130])    #3cm\u6293\n\n# bot.set_uart_servo_angle_array([0, 0, 30, 0, 90, 30])\n</code></pre> <pre><code># \u521d\u59cb [0, 0, 130, 0, 90, 0]\n# \u5de1\u7ebf [0, 0, 30, 0, 90, 30]\n# \u6293\u53d6 [0, 0, 0, 50, 90, 30]  110 \u6293\u53d6\n\n# \u4e2d\u5fc3\u70b9\u5750\u6807\n270 430\n</code></pre>"},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/robot/%E6%8E%A7%E5%88%B6%E6%9C%BA%E5%99%A8%E4%BA%BA%E8%BF%90%E5%8A%A8/","title":"\u63a7\u5236\u673a\u5668\u4eba\u8fd0\u52a8","text":""},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/robot/%E6%8E%A7%E5%88%B6%E6%9C%BA%E5%99%A8%E4%BA%BA%E8%BF%90%E5%8A%A8/#_1","title":"\u63a7\u5236\u673a\u5668\u4eba\u8fd0\u52a8","text":"<pre><code>#!/usr/bin/env python3\n#coding=utf-8\nimport time\nfrom Rosmaster_Lib import Rosmaster\nfrom ipywidgets import interact\nimport ipywidgets as widgets\n\n# \u521b\u5efaRosmaster\u5bf9\u8c61 bot Create the Rosmaster object bot\nbot = Rosmaster()\n\n# \u5f00\u542f\u81ea\u52a8\u53d1\u9001\u6570\u636e\n# enable=True\uff0c\u5e95\u5c42\u6269\u5c55\u677f\u4f1a\u6bcf\u969440\u6beb\u79d2\u53d1\u9001\u4e00\u6b21\u6570\u636e\u3002enable=False\uff0c\u5219\u4e0d\u53d1\u9001\u3002\n# forever=True\u6c38\u4e45\u4fdd\u5b58\uff0c=False\u4e34\u65f6\u4f5c\u7528\u3002\n# Enable automatic data sending\nenable = True\nbot.set_auto_report_state(enable, forever=False)\n\n# \u6e05\u9664\u5355\u7247\u673a\u81ea\u52a8\u53d1\u9001\u8fc7\u6765\u7684\u7f13\u5b58\u6570\u636e Clear the cache data automatically sent by the MCU\nbot.clear_auto_report_data()\n\n# \u63a7\u5236\u7535\u673a\u8fd0\u52a8 Control motor movement\n# x:\u524d\u8fdb\u540e\u9000\uff0cy:\u5de6\u53f3\u5e73\u79fb\uff0cz:\u5de6\u53f3\u504f\u8f6c\ndef car_motion(V_x, V_y, V_z):\n    speed_x= V_x / 10.0\n    speed_y = V_y / 10.0\n    speed_z = V_z / 10.0\n    bot.set_car_motion(speed_x, speed_y, speed_z)\n    return speed_x, speed_y, speed_z\n\n\n# \u521b\u5efa\u4e09\u4e2a\u6ed1\u5757\u6765\u63a7\u5236\u5c0f\u8f66\u7684\u901f\u5ea6 Create three sliders to control the speed of the car\ninteract(car_motion, \\\n         V_x=widgets.IntSlider(min=-10,max=10,step=1,value=0), \\\n         V_y=widgets.IntSlider(min=-10,max=10,step=1,value=0), \\\n         V_z=widgets.IntSlider(min=-50,max=50,step=1,value=0));\n\n# \u505c\u6b62\u8fd0\u52a8 stop motion\nbot.set_car_motion(0, 0, 0)\n\n# \u83b7\u53d6\u5c0f\u8f66\u7ebf\u901f\u5ea6\u548c\u89d2\u901f\u5ea6\u6570\u636e\n# Obtain the linear velocity and angular velocity data of the car\ntry:\n    while True:\n        V_x, V_y, V_z = bot.get_motion_data()\n        print(\"speed:\", V_x, V_y, V_z)\n        bot.clear_auto_report_data()\n        time.sleep(.1)\nexcept KeyboardInterrupt:\n    pass\n\n# PID \u53c2\u6570\u63a7\u5236\uff0c\u4f1a\u5f71\u54cdset_car_motion\u51fd\u6570\u63a7\u5236\u5c0f\u8f66\u7684\u8fd0\u52a8\u901f\u5ea6\u53d8\u5316\u60c5\u51b5\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u53ef\u4e0d\u8c03\u6574\u3002\n# PID parameter control will affect the set_CAR_motion function to control the speed change of the car.  This parameter is optional by default\nkp = 0.8\nki = 0.06\nkd = 0.5\nbot.set_pid_param(kp, ki, kd, forever=False)\n\nkp, ki, kd = bot.get_motion_pid()\nprint(\"PID:\", kp, ki, kd)\n\n# \u6062\u590d\u51fa\u5382\u914d\u7f6e Restoring factory Settings\nbot.reset_flash_value()\n\n# \u7a0b\u5e8f\u7ed3\u675f\u540e\u8bf7\u5220\u9664\u5bf9\u8c61\uff0c\u907f\u514d\u5728\u5176\u4ed6\u7a0b\u5e8f\u4e2d\u4f7f\u7528Rosmaster\u5e93\u9020\u6210\u51b2\u7a81\ndel bot\n</code></pre> <pre><code># \u673a\u5668\u4eba\u6821\u51c6\ncalibrate_linear_X3:    1.65\ncalibrate_angular_X3:   0.93\n</code></pre>"},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/robot/%E6%9C%BA%E5%99%A8%E4%BA%BA%E6%8E%A7%E5%88%B6/","title":"\u673a\u5668\u4eba\u63a7\u5236","text":""},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/robot/%E6%9C%BA%E5%99%A8%E4%BA%BA%E6%8E%A7%E5%88%B6/#_1","title":"\u63a7\u5236\u673a\u5668\u4eba\u8fd0\u52a8","text":"<pre><code>#!/usr/bin/env python3\n#coding=utf-8\nimport time\nfrom Rosmaster_Lib import Rosmaster\n\n# \u521b\u5efaRosmaster\u5bf9\u8c61 bot Create the Rosmaster object bot\nbot = Rosmaster()\n\n# \u5f00\u542f\u81ea\u52a8\u53d1\u9001\u6570\u636e\n# enable=True\uff0c\u5e95\u5c42\u6269\u5c55\u677f\u4f1a\u6bcf\u969440\u6beb\u79d2\u53d1\u9001\u4e00\u6b21\u6570\u636e\u3002enable=False\uff0c\u5219\u4e0d\u53d1\u9001\u3002\n# forever=True\u6c38\u4e45\u4fdd\u5b58\uff0c=False\u4e34\u65f6\u4f5c\u7528\u3002\n# Enable automatic data sending\nenable = True\nbot.set_auto_report_state(enable, forever=False)\n\n# \u6e05\u9664\u5355\u7247\u673a\u81ea\u52a8\u53d1\u9001\u8fc7\u6765\u7684\u7f13\u5b58\u6570\u636e Clear the cache data automatically sent by the MCU\nbot.clear_auto_report_data()\n\n# \u63a7\u5236\u7535\u673a\u8fd0\u52a8 Control motor movement\n# x:\u524d\u8fdb\u540e\u9000\uff0cy:\u5de6\u53f3\u5e73\u79fb\uff0cz:\u5de6\u53f3\u504f\u8f6c\ndef car_motion(V_x, V_y, V_z):\n    speed_x= V_x / 10.0\n    speed_y = V_y / 10.0\n    speed_z = V_z / 10.0\n    bot.set_car_motion(speed_x, speed_y, speed_z)\n    return speed_x, speed_y, speed_z\n\n# \u505c\u6b62\u8fd0\u52a8 stop motion\nbot.set_car_motion(0, 0, 0)\n\n# \u83b7\u53d6\u5c0f\u8f66\u7ebf\u901f\u5ea6\u548c\u89d2\u901f\u5ea6\u6570\u636e\n# Obtain the linear velocity and angular velocity data of the car\ntry:\n    while True:\n        V_x, V_y, V_z = bot.get_motion_data()\n        print(\"speed:\", V_x, V_y, V_z)\n        bot.clear_auto_report_data()\n        time.sleep(.1)\nexcept KeyboardInterrupt:\n    pass\n\n# PID \u53c2\u6570\u63a7\u5236\uff0c\u4f1a\u5f71\u54cdset_car_motion\u51fd\u6570\u63a7\u5236\u5c0f\u8f66\u7684\u8fd0\u52a8\u901f\u5ea6\u53d8\u5316\u60c5\u51b5\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u53ef\u4e0d\u8c03\u6574\u3002\n# PID parameter control will affect the set_CAR_motion function to control the speed change of the car.  This parameter is optional by default\nkp = 0.8\nki = 0.06\nkd = 0.5\nbot.set_pid_param(kp, ki, kd, forever=False)\n\nkp, ki, kd = bot.get_motion_pid()\nprint(\"PID:\", kp, ki, kd)\n\n# \u6062\u590d\u51fa\u5382\u914d\u7f6e Restoring factory Settings\nbot.reset_flash_value()\n\n# \u7a0b\u5e8f\u7ed3\u675f\u540e\u8bf7\u5220\u9664\u5bf9\u8c61\uff0c\u907f\u514d\u5728\u5176\u4ed6\u7a0b\u5e8f\u4e2d\u4f7f\u7528Rosmaster\u5e93\u9020\u6210\u51b2\u7a81\ndel bot\n</code></pre> <pre><code># \u589e\u91cf\u5f0fPID\u63a7\u5236\u5668\uff08\u589e\u52a0\u4e8c\u6b21\u9879 &amp; \u9640\u87ba\u4eea\uff09\noutput = position * KP + abs(position)*position * KP2 + (position - position_last) * KD + gryo_z * KD2\n\nclass PIDController:\n    def __init__(self, KP, KP2, KD, KD2):\n        self.KP = KP\n        self.KP2 = KP2\n        self.KD = KD\n        self.KD2 = KD2\n        self.prev_position = 0\n\n    def update(self, position, gryo_z):\n        # \u8ba1\u7b97\u4f4d\u7f6e\u504f\u5dee\n        position_error = position - self.prev_position\n\n        # \u6bd4\u4f8b\u63a7\u5236\u90e8\u5206\n        proportional_term = position * self.KP + abs(position) * position * self.KP2\n\n        # \u5fae\u5206\u63a7\u5236\u90e8\u5206\n        derivative_term = position_error * self.KD\n\n        # \u9640\u87ba\u4eea\u63a7\u5236\u90e8\u5206\n        gyro_term = gryo_z * self.KD2\n\n        # \u8ba1\u7b97PID\u63a7\u5236\u5668\u8f93\u51fa\n        output = proportional_term + derivative_term + gyro_term\n\n        # \u66f4\u65b0\u4e0a\u4e00\u6b21\u4f4d\u7f6e\n        self.prev_position = position\n\n        return output\n\n# \u4f7f\u7528\u793a\u4f8b\npid_controller = PIDController(KP=0.5, KP2=0.1, KD=0.2, KD2=0.3)\nposition = 10  # \u5f53\u524d\u4f4d\u7f6e\ngryo_z = 0.1  # \u9640\u87ba\u4eea\u6d4b\u91cf\u503c\noutput = pid_controller.update(position, gryo_z)\nprint(\"PID Controller Output:\", output)\n\n</code></pre>"},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/robot/%E6%9C%BA%E6%A2%B0%E8%87%82/","title":"\u673a\u68b0\u81c2","text":""},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/robot/%E6%9C%BA%E6%A2%B0%E8%87%82/#_1","title":"\u63a7\u5236\u673a\u5668\u4eba\u8fd0\u52a8","text":"<pre><code>if color_name['name'] ==   'yellow':\n    color_lower = np.array([26,   43, 46])\n    color_upper = np.array([34,   255, 255])\n    start_move_arm(1)\nelif color_name['name'] == 'red':\n    color_lower = np.array([0,   43, 46])\n    color_upper = np.array([10,   255, 255])\n    start_move_arm(2)\nelif  color_name['name'] == 'green':\n    color_lower = np.array([35,   43, 46])\n    color_upper = np.array([77,   255, 255])\n    start_move_arm(3)\n</code></pre>"},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/robot/%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B/","title":"\u76ee\u6807\u68c0\u6d4b","text":""},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/robot/%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B/#_1","title":"\u76ee\u6807\u68c0\u6d4b","text":"<p>\u7f16\u5199\u4e00\u4e2a\u57fa\u4e8eYOLO\u7684\u76ee\u6807\u68c0\u6d4b\u7a0b\u5e8f\uff1a</p> <ol> <li> <p>\u8ba2\u9605 <code>/camera/color/image_raw</code> \u4e3b\u9898\uff0c\u8fd9\u4e2a\u6d88\u606f\u5305\u542b\u4e86\u6444\u50cf\u5934\u7684RGB\u5f69\u8272\u56fe\u50cf\u6570\u636e\u3002</p> </li> <li> <p>\u8ba2\u9605 <code>/camera/depth/image_raw</code> \u4e3b\u9898\uff0c\u8fd9\u4e2a\u6d88\u606f\u5305\u542b\u4e86\u6444\u50cf\u5934\u7684Depth\u6df1\u5ea6\u70b9\u4e91\u6570\u636e\u3002</p> </li> <li> <p>\u8ba1\u7b97\u68c0\u6d4b\u5bf9\u8c61\u4e2d\u5fc3\u70b9\u5750\u6807\u53ca\u8ddd\u79bb</p> </li> <li> <p>\u7f16\u5199\u4e00\u4e2a ROS 2 Python \u8282\u70b9\uff0c\u6839\u636e\u6444\u50cf\u5934\u6570\u636e\uff0c\u548cyolov8n\u6a21\u578b\u8fdb\u884c\u63a8\u7406\u3002</p> </li> <li> <p>\u5c06\u7ed3\u679c\u4e2d\u7c7b\u522b\u7b49\u4e8e\u2018person\u2019\u4e14\u7f6e\u4fe1\u5ea6\u6700\u9ad8\u7684\u4e2d\u5fc3\u70b9\u5750\u6807\u548c\u8ddd\u79bb\u3002\u4ee5geometry_msgs.msg\u7684PointStamped\u53d1\u5e03\u5230 /volo/detect_pos</p> </li> </ol> <pre><code>import cv2\nimport numpy as np\nfrom ultralytics import YOLO\n\n# Load a pretrained YOLOv8n-cls Classify model\nmodel = YOLO(r\"/root/yahboomcar_ros2_ws/yahboomcar_ws/src/yahboomcar_linefollow/yolov8n.onnx\")\n\n\ndef draw_detection(frame, detection):\n    \"\"\"Draw bounding box and label on the frame.\"\"\"\n    x, y, w, h = detection[\"bbox\"]\n    x1, y1, x2, y2 = int(x - w / 2), int(y - h / 2), int(x + w / 2), int(y + h / 2)\n\n    # Draw bounding box with red color\n    cv2.rectangle(frame, (x1, y1), (x2, y2), (0, 0, 255), 2)\n\n    # Add label with class name, confidence, and center coordinates\n    label = f\"Person {detection['confidence']:.2f} (X: {detection['center_x']}, Y: {detection['center_y']})\"\n    print(label)\n    cv2.putText(\n        frame, label, (x1, y1 - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 0, 255), 2\n    )\n\n    # Draw center point\n    cv2.circle(frame, (detection['center_x'], detection['center_y']), 3, (0, 0, 255), -1)\n\n\ndef detect(frame):\n    \"\"\"Perform object detection on the given frame.\"\"\"\n    results = model(frame)  # Run inference on the frame\n\n    best_detection = None  # Initialize best_detection variable\n\n    for r in results:\n        boxes = r.boxes  # Boxes object for bbox outputs\n\n        bounding_boxes = (\n            boxes.xywh.cpu().numpy()\n        )  # Convert bounding boxes to numpy array\n        classes = boxes.cls.cpu().numpy().astype(int)  # Convert classes to numpy array\n        confidences = boxes.conf.cpu().numpy()  # Convert confidences to numpy array\n\n        # Filter out detections with class_id == 0 (person)\n        person_indices = np.where(classes == 0)[0]\n        if len(person_indices) == 0:\n            continue\n\n        # Find index of maximum confidence among detections with class_id == 0\n        max_confidence_idx = person_indices[np.argmax(confidences[person_indices])]\n        max_confidence = confidences[max_confidence_idx]  # Get maximum confidence\n\n        x, y, w, h = bounding_boxes[max_confidence_idx]  # Extract bounding box coordinates\n        center_x = int(x + w / 2)  # Calculate center x-coordinate\n        center_y = int(y + h / 2)  # Calculate center y-coordinate\n\n        best_detection = {\n            \"bbox\": bounding_boxes[max_confidence_idx],\n            \"class_id\": classes[max_confidence_idx],\n            \"confidence\": max_confidence,\n            \"center_x\": center_x,\n            \"center_y\": center_y,\n        }\n\n    if best_detection is not None:\n        draw_detection(frame, best_detection)\n\n    return frame, best_detection\n\n\n\n# Open the video file\nvideo_capture = cv2.VideoCapture(0)\n\nif not video_capture.isOpened():\n    print(\"Error: Unable to open video file.\")\n    exit()\n\nwhile True:\n    # Read a frame from the video\n    ret, frame = video_capture.read()\n    if not ret:\n        print(\"End of video.\")\n        break\n\n    # Perform object detection on the frame\n    frame, detections = detect(frame)\n\n    # Display the frame with detections\n    cv2.imshow(\"Object Detection\", frame)\n\n    # Break the loop if 'q' is pressed\n    if cv2.waitKey(1) &amp; 0xFF == ord(\"q\"):\n        break\n\n# Release the video capture object and close all windows\nvideo_capture.release()\ncv2.destroyAllWindows()\n\n</code></pre> <pre><code>import cv2\nimport numpy as np\nimport rclpy\nfrom rclpy.node import Node\nfrom geometry_msgs.msg import PointStamped\nfrom sensor_msgs.msg import Image\nfrom cv_bridge import CvBridge\nfrom ultralytics import YOLO\n\nclass YOLODetector(Node):\n    def __init__(self):\n        super().__init__('yolo_detector')\n        self.publisher = self.create_publisher(PointStamped, '/yolo/detect_pos', 10)\n        self.cap = cv2.VideoCapture(0)  # \u521d\u59cb\u5316\u89c6\u9891\u6355\u83b7\u5bf9\u8c61\n        self.bridge = CvBridge()\n\n        # Load YOLO model\n        self.model = YOLO('/root/yahboomcar_ros2_ws/yahboomcar_ws/src/yahboomcar_linefollow/yolov8n.onnx')\n\n    def detect(self, frame):\n        results = self.model(frame)  # Run inference on the frame\n\n        best_detection = None  # Initialize best_detection variable\n\n        for r in results:\n            boxes = r.boxes  # Boxes object for bbox outputs\n\n            bounding_boxes = (\n                boxes.xywh.cpu().numpy()\n            )  # Convert bounding boxes to numpy array\n            classes = boxes.cls.cpu().numpy().astype(int)  # Convert classes to numpy array\n            confidences = boxes.conf.cpu().numpy()  # Convert confidences to numpy array\n\n            # Filter out detections with class_id == 0 (person)\n            person_indices = np.where(classes == 0)[0]\n            if len(person_indices) == 0:\n                continue\n\n            # Find index of maximum confidence among detections with class_id == 0\n            max_confidence_idx = person_indices[np.argmax(confidences[person_indices])]\n            max_confidence = confidences[max_confidence_idx]  # Get maximum confidence\n\n            x, y, w, h = bounding_boxes[max_confidence_idx]  # Extract bounding box coordinates\n            center_x = int(x + w / 2)  # Calculate center x-coordinate\n            center_y = int(y + h / 2)  # Calculate center y-coordinate\n\n            best_detection = {\n                \"bbox\": bounding_boxes[max_confidence_idx],\n                \"class_id\": classes[max_confidence_idx],\n                \"confidence\": max_confidence,\n                \"center_x\": center_x,\n                \"center_y\": center_y,\n            }\n\n        self.draw_detection(frame, best_detection)\n\n        return best_detection\n\n    def draw_detection(self, frame, detection):\n        \"\"\"Draw bounding box and label on the frame.\"\"\"\n        if detection is not None:\n            x, y, w, h = detection[\"bbox\"]\n            x1, y1, x2, y2 = int(x - w / 2), int(y - h / 2), int(x + w / 2), int(y + h / 2)\n\n            # Draw bounding box with red color\n            cv2.rectangle(frame, (x1, y1), (x2, y2), (0, 0, 255), 2)\n\n            # Calculate center coordinates\n            center_x = int((x1 + x2) / 2)\n            center_y = int((y1 + y2) / 2)\n\n            # Add label with class name, confidence, and center coordinates\n            label = f\"Person {detection['confidence']:.2f} (X: {center_x}, Y: {center_y})\"\n            print(label)\n            cv2.putText(\n                frame, label, (x1, y1 - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 0, 255), 2\n            )\n\n            # Draw center point\n            cv2.circle(frame, (center_x, center_y), 3, (0, 0, 255), -1)\n\n\n    def main_loop(self):\n        while True:\n            # Read a frame from the video\n            ret, frame = self.cap.read()\n            if not ret:\n                self.get_logger().info(\"End of video.\")\n                break\n\n            # Perform object detection on the frame\n            detections = self.detect(frame)\n\n            if detections is not None:\n\n                center_x = float(detections['center_x'])\n                center_y = float(detections['center_y'])\n\n                # Publish detection result\n                msg = PointStamped()\n                msg.header.stamp = self.get_clock().now().to_msg()\n                msg.header.frame_id = 'volo_detection'\n                msg.point.x = center_x\n                msg.point.y = center_y\n                msg.point.z = float(0)\n                self.publisher.publish(msg)\n\n            else:\n                msg = PointStamped()\n                self.publisher.publish(msg)\n                self.get_logger().warn(\"No detections found.\")\n\n            # Display the frame with detections\n            cv2.imshow(\"Object Detection\", frame)\n\n            # Break the loop if 'q' is pressed or if the window is closed\n            if cv2.waitKey(1) &amp; 0xFF == ord(\"q\") or cv2.getWindowProperty(\"Object Detection\", cv2.WND_PROP_VISIBLE) &lt; 1:\n                break\n\n        # Release the video capture object and close all windows\n        self.cap.release()\n        cv2.destroyAllWindows()\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n    yolo_detector = YOLODetector()\n    yolo_detector.main_loop()\n    yolo_detector.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n\n</code></pre>"},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/robot/1_%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE/0.ROS2%E5%88%9D%E5%A7%8B%E5%8C%96%E9%85%8D%E7%BD%AE/","title":"0.ROS2\u521d\u59cb\u5316\u914d\u7f6e","text":""},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/robot/1_%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE/0.ROS2%E5%88%9D%E5%A7%8B%E5%8C%96%E9%85%8D%E7%BD%AE/#ros2","title":"ROS2\u521d\u59cb\u5316\u914d\u7f6e","text":"<p>\u4e0b\u8f7d\u955c\u50cf</p> <pre><code>docker pull ros:humble-perception\n</code></pre>"},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/robot/1_%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE/0.ROS2%E5%88%9D%E5%A7%8B%E5%8C%96%E9%85%8D%E7%BD%AE/#docker","title":"\u542f\u52a8docker","text":"<pre><code>---\nservices:\n    ros2-humble:\n        stdin_open: true\n        tty: true\n        deploy:\n            resources:\n                limits:\n                    memory: 4g\n        container_name: ros2-humble\n        memswap_limit: 4g\n        network_mode: host\n        privileged: true\n        environment:\n            - DISPLAY\n            - QT_X11_NO_MITSHM=1\n        volumes:\n            - /tmp/.X11-unix:/tmp/.X11-unix\n            - /home/pi/temp:/root/temp\n            - /home/pi/ros2_ws:/root/ros2_ws\n            - /dev/bus/usb/001/006:/dev/bus/usb/001/006     #\u6309\u9700\u4fee\u6539\n            - /dev/bus/usb/001/008:/dev/bus/usb/001/008     #\u6309\u9700\u4fee\u6539\n        devices:\n            - /dev/myserial\n            - /dev/astradepth\n            - /dev/astrauvc\n            - /dev/input\n            - /dev/video0\n            - /dev/video1\n            - /dev/rplidar\n            # - /dev/myspeech\n        image: ros:humble\n        command: /bin/bash\n\n</code></pre>"},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/robot/1_%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE/0.ROS2%E5%88%9D%E5%A7%8B%E5%8C%96%E9%85%8D%E7%BD%AE/#_1","title":"\u8bbe\u7f6e\u6e90","text":"<p>\u60a8\u9700\u8981\u5c06 ROS 2 apt \u5b58\u50a8\u5e93\u6dfb\u52a0\u5230\u60a8\u7684\u7cfb\u7edf\u4e2d\u3002</p> <pre><code>apt install vim -y\n\n# \u66f4\u6362\u6e05\u534e\u6e90\n# # Ubuntu sources have moved to /etc/apt/sources.list.d/ubuntu.sources\nsudo vi /etc/apt/sources.list \u66ff\u6362 https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/\nsudo apt update\nsudo apt upgrade -y\n\n# \u9996\u5148\u786e\u4fddUbuntu Universe \u5b58\u50a8\u5e93\u5df2\u542f\u7528\nsudo apt install software-properties-common -y\nsudo add-apt-repository universe\n\n# \u73b0\u5728\u4f7f\u7528 apt \u6dfb\u52a0 ROS 2 GPG \u5bc6\u94a5\nsudo apt update &amp;&amp; sudo apt install curl -y\nsudo curl -sSL https://raw.githubusercontent.com/ros/rosdistro/master/ros.key -o /usr/share/keyrings/ros-archive-keyring.gpg\n\n# \u7136\u540e\u5c06\u5b58\u50a8\u5e93\u6dfb\u52a0\u5230\u60a8\u7684\u6e90\u5217\u8868\u4e2d\necho \"deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/ros-archive-keyring.gpg] http://packages.ros.org/ros2/ubuntu $(. /etc/os-release &amp;&amp; echo $UBUNTU_CODENAME) main\" | sudo tee /etc/apt/sources.list.d/ros2.list &gt; /dev/null\n\n# \u66f4\u65b0\u5347\u7ea7apt \nsudo apt update\nsudo apt upgrade -y\n\n</code></pre>"},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/robot/1_%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE/0.ROS2%E5%88%9D%E5%A7%8B%E5%8C%96%E9%85%8D%E7%BD%AE/#_2","title":"\u8bbe\u7f6e\u533a\u57df\u8bbe\u7f6e\uf0c1","text":"<p>\u786e\u4fdd\u60a8\u6709\u4e00\u4e2a\u652f\u6301<code>UTF-8</code>.\u5982\u679c\u60a8\u5904\u4e8e\u6700\u5c0f\u73af\u5883\uff08\u4f8b\u5982 docker \u5bb9\u5668\uff09\u4e2d\uff0c\u5219\u533a\u57df\u8bbe\u7f6e\u53ef\u80fd\u662f\u6700\u5c0f\u7684\uff0c\u4f8b\u5982<code>POSIX</code>.\u6211\u4eec\u4f7f\u7528\u4ee5\u4e0b\u8bbe\u7f6e\u8fdb\u884c\u6d4b\u8bd5\u3002\u4f46\u662f\uff0c\u5982\u679c\u60a8\u4f7f\u7528\u4e0d\u540c\u7684 UTF-8 \u652f\u6301\u7684\u533a\u57df\u8bbe\u7f6e\uff0c\u5e94\u8be5\u6ca1\u95ee\u9898\u3002</p> <pre><code>locale  # check for UTF-8\n\nsudo apt update &amp;&amp; sudo apt install locales\nsudo locale-gen en_US en_US.UTF-8\nsudo update-locale LC_ALL=en_US.UTF-8 LANG=en_US.UTF-8\nexport LANG=en_US.UTF-8\n\nlocale  # verify settings\n</code></pre>"},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/robot/1_%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE/0.ROS2%E5%88%9D%E5%A7%8B%E5%8C%96%E9%85%8D%E7%BD%AE/#_3","title":"\u5b89\u88c5\u8f6f\u4ef6","text":"<pre><code># \u5b89\u88c5 pip\uff0cusbutils\napt install python3-pip usbutils unzip wget libusb-1.0-0-dev -y\n\n# \u5b89\u88c5pyserial\u4e32\u53e3\u7a0b\u5e8f\npip3 install -i https://pypi.tuna.tsinghua.edu.cn/simple pyserial\n\n\n</code></pre>"},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/robot/1_%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE/0.ROS2%E5%88%9D%E5%A7%8B%E5%8C%96%E9%85%8D%E7%BD%AE/#_4","title":"\u8bbe\u5907\u7ed1\u5b9a","text":""},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/robot/1_%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE/0.ROS2%E5%88%9D%E5%A7%8B%E5%8C%96%E9%85%8D%E7%BD%AE/#620udev","title":"6.2.0\u3001\u5b89\u88c5udev","text":"<pre><code># \u5b89\u88c5udev\nsudo apt install -y udev\n</code></pre> <p>\u4fee\u6539/etc/init.d/udev\uff0c\u6ce8\u91ca\u4e0b\u8ff0\u4ee3\u7801\uff1a</p> <pre><code>sudo vi /etc/init.d/udev\n\n#if [ ! -w /sys ]; then\n#    log_warning_msg \"udev does not support containers, not started\"\n#    exit 0\n#fi\n</code></pre> <pre><code># \u542f\u52a8\u670d\u52a1\nservice udev start\n</code></pre>"},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/robot/1_%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE/0.ROS2%E5%88%9D%E5%A7%8B%E5%8C%96%E9%85%8D%E7%BD%AE/#621astra","title":"6.2.1\u3001Astra\u76f8\u673a\u7ed1\u5b9a","text":"<p>Astra\u76f8\u673a\u7684\u7ed1\u5b9a\u89c4\u5219\u6587\u4ef6\u4e3a\u301056-orbbec-usb.rules\u3011\uff0c\u7531Astra\u5382\u5546\u63d0\u4f9b\uff0c\u8fd9\u91cc\u4ee5AstraPro Plus\u8fdb\u884c\u6f14\u793a\u3002</p> <p>\u5c06\u301056-orbbec-usb.rules\u3011\u6587\u4ef6\u653e\u5728\u4e3b\u63a7\u7684/etc/udev/rules.d \u76ee\u5f55\u4e0b</p> <p>\u5373\u5982\u4e0b\u4f4d\u7f6e\uff1a</p> <pre><code>/etc/udev/rules.d/56-orbbec-usb.rules\n</code></pre> <p>\u518d\u6267\u884c\u4e0b\u9762\u547d\u4ee4\uff0c\u5237\u65b0USB\u89c4\u5219\u5373\u53ef\u7ed1\u5b9a\u751f\u6548Astra\u76f8\u673a</p> <pre><code>sudo udevadm control --reload-rules &amp;&amp; sudo udevadm trigger\n</code></pre> <p>\u67e5\u770b\u7ed1\u5b9a\u6210\u529f\u6ca1\u6709\uff1a</p> <pre><code>jetson@ubuntu:~$ ll /dev/astra* \nlrwxrwxrwx 1 root root 15 May  5 17:42 /dev/astradepth -&gt; bus/usb/001/007   #\u8868\u793a\u6df1\u5ea6\u7684\u7aef\u53e3\nlrwxrwxrwx 1 root root 15 May  5 17:42 /dev/astrauvc -&gt; bus/usb/001/009     #\u8868\u793aRGB\u7684\u7aef\u53e3\n</code></pre> <p>\u6253\u5370\u5982\u4e0a\uff0c\u8868\u793a\u7ed1\u5b9a\u6210\u529f\u3002</p>"},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/robot/1_%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE/0.ROS2%E5%88%9D%E5%A7%8B%E5%8C%96%E9%85%8D%E7%BD%AE/#622pcb","title":"6.2.2\u3001PCB\u548c\u96f7\u8fbe\u7ed1\u5b9a","text":"<p>\u8fdb\u5165rules.d\u76ee\u5f55\u4e0b</p> <pre><code>cd /etc/udev/rules.d/\n</code></pre> <p>\u65b0\u5efa\u4e00\u4e2a\u3010usb.rules\u3011\u6587\u4ef6\u5e76\u7f16\u8f91</p> <pre><code>sudo vim usb.rules\n</code></pre> <p>\u5199\u5165\u4ee5\u4e0b\u5185\u5bb9</p> <pre><code>KERNEL==\"ttyUSB*\", ATTRS{idVendor}==\"1a86\", ATTRS{idProduct}==\"7523\", MODE:=\"0777\", SYMLINK+=\"myserial\"\nKERNEL==\"ttyUSB*\", ATTRS{idVendor}==\"10c4\", ATTRS{idProduct}==\"ea60\", MODE:=\"0777\", SYMLINK+=\"rplidar\"\n</code></pre> <p>\u4fdd\u5b58\u9000\u51fa\uff0c\u4f7f\u89c4\u5219\u751f\u6548\uff0c\u4e3b\u63a7\u4e0a\u6267\u884c\uff1a</p> <pre><code>sudo udevadm control --reload-rules &amp;&amp; sudo udevadm trigger\n</code></pre> <p>\u67e5\u770b\u7ed1\u5b9a\u6210\u529f\u6ca1\u6709\uff1a</p> <pre><code>ll /dev | grep ttyUSB*\nlrwxrwxrwx   1 root   root           7 5\u6708  18 20:13 gps1 -&gt; ttyUSB1         #\u8fd9\u4e2a\u662f\u7cfb\u7edf\u81ea\u5e26\u7684\uff0c\u4e0d\u7528\u7ba1\nlrwxrwxrwx   1 root   root           7 5\u6708  18 20:13 myserial -&gt; ttyUSB0     #pcb\u7ed1\u5b9a\u4e86ttyUSB0\u7aef\u53e3\nlrwxrwxrwx   1 root   root           7 5\u6708  18 20:13 rplidar -&gt; ttyUSB1      #\u96f7\u8fbe\u7ed1\u5b9a\u4e86ttyUSB1\u7aef\u53e3\ncrwxrwxrwx   1 root   dialout 188,   0 5\u6708  18 20:13 ttyUSB0\ncrwxrwxrwx   1 root   dialout 188,   1 5\u6708  18 20:13 ttyUSB1\n</code></pre> <p>\u6253\u5370\u5982\u4e0a\uff0c\u8868\u793a\u7ed1\u5b9a\u6210\u529f\u3002</p>"},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/robot/1_%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE/0.ROS2%E5%88%9D%E5%A7%8B%E5%8C%96%E9%85%8D%E7%BD%AE/#64usb","title":"6.4\u3001\u7ed1\u5b9aUSB\u7aef\u53e3","text":"<p>\u4e0a\u9762\u7684\u60c5\u51b5\u90fd\u662f\u4e0d\u540c\u7684ID\u53f7\uff0c\u5982\u679c\u96f7\u8fbe\u548cPCB\u7684ID\u53f7\u76f8\u540c\uff0c\u6216\u8005\u6709\u4e24\u6b3e\u53ca\u4ee5\u4e0a\u7684\u76f8\u540cID\u7684PCB\uff08\u96f7\u8fbe\uff09\uff0c\u4e0a\u8ff0\u7684\u7ed1\u5b9a\u5c31\u4f1a\u51fa\u73b0\u6df7\u4e71\u3002\u5982\uff1a\u5728\u5df2\u7ecf\u7ed1\u5b9a\u4e86\u96f7\u8fbe\u548cPCB\u7684\u60c5\u51b5\u4e0b\uff0c\u8fd8\u9700\u8981\u7ed1\u5b9a\u8bed\u97f3\u63a7\u5236\u677f\uff0c\u5c31\u4f1a\u51fa\u73b0\u8fd9\u79cd\u60c5\u51b5</p> <p>\u90a3\u4e48\uff0c\u6211\u4eec\u5c31\u9700\u8981\u7ed1\u5b9aUSB\u7684\u7aef\u53e3\uff0c\u7ed1\u5b9a\u540e\u4e0d\u80fd\u968f\u610f\u66f4\u6362USB\u7aef\u53e3\uff0c\u6bcf\u4e2a\u8bbe\u5907\u53ea\u80fd\u94fe\u63a5\u56fa\u5b9a\u7684USB\u7aef\u53e3\u3002</p> <p>\u7ed1\u5b9a\u65b9\u6cd5\uff0c\u4ee5\u3010ttyUSB0\u3011\u4e3a\u4f8b\uff0c\u67e5\u770b\u6b64\u65f6\u8be5\u8bbe\u5907\u7684\u7aef\u53e3</p> <p>\u5148\u67e5\u770bttyUSB0\u5bf9\u5e94\u7684\u8bbe\u5907\uff1a</p> <pre><code>ll /dev | grep ttyUSB*\n</code></pre> <p> </p> <p>ttyUSB0\u5bf9\u5e94\u7684\u8bbe\u5907\u662f\uff1amyserial</p> <pre><code>udevadm info --attribute-walk --name=/dev/ttyUSB1 | grep devpath\n</code></pre> <p> </p> <p>\u6211\u4eec\u9700\u8981\u7684\u662f\u5728rules\u6587\u4ef6\u91cc\u4fee\u6539myserial\u7684\u89c4\u5219\uff1a</p> <pre><code># \u4fee\u6539\u524d\uff1a\n# KERNEL==\"ttyUSB*\", ATTRS{idVendor}==\"1a86\", ATTRS{idProduct}==\"7523\", MODE:=\"0777\", SYMLINK+=\"myserial\"    \n# \u4fee\u6539\u540e\uff1a\nKERNEL==\"ttyUSB*\", ATTRS{devpath}==\"2.4\",  ATTRS{idVendor}==\"1a86\", ATTRS{idProduct}==\"7523\", MODE:=\"0777\", SYMLINK+=\"myserial\" \n</code></pre> <p>\u4fdd\u5b58\u9000\u51fa\uff0c\u4f7f\u89c4\u5219\u751f\u6548\uff0c\u4e3b\u63a7\u4e0a\u6267\u884c\uff1a</p> <pre><code>sudo udevadm control --reload-rules &amp;&amp; sudo udevadm trigger\n</code></pre> <p>\u67e5\u770b\u7ed1\u5b9a\u6210\u529f\u6ca1\u6709\uff1a</p> <pre><code>ll /dev | grep ttyUSB*\nlrwxrwxrwx   1 root   root           7 5\u6708  18 20:13 gps1 -&gt; ttyUSB1         #\u8fd9\u4e2a\u662f\u7cfb\u7edf\u81ea\u5e26\u7684\uff0c\u4e0d\u7528\u7ba1\nlrwxrwxrwx   1 root   root           7 5\u6708  18 20:13 myserial -&gt; ttyUSB0     #pcb\u7ed1\u5b9a\u4e86ttyUSB0\u7aef\u53e3\nlrwxrwxrwx   1 root   root           7 5\u6708  18 20:13 rplidar -&gt; ttyUSB1      #\u96f7\u8fbe\u7ed1\u5b9a\u4e86ttyUSB1\u7aef\u53e3\nlrwxrwxrwx   1 root   root           7 5\u6708  18 20:13 myspeech -&gt; ttyUSB2     #\u8bed\u97f3\u63a7\u5236\u677f\u7ed1\u5b9a\u4e86ttyUSB2\u7aef\u53e3\ncrwxrwxrwx   1 root   dialout 188,   0 5\u6708  18 20:13 ttyUSB0\ncrwxrwxrwx   1 root   dialout 188,   1 5\u6708  18 20:13 ttyUSB1\ncrwxrwxrwx   1 root   dialout 188,   1 5\u6708  18 20:13 ttyUSB2\n</code></pre> <p>\u6253\u5370\u5982\u4e0a\uff0c\u8868\u793a\u96f7\u8fbe\u3001PCB\u548c\u8bed\u97f3\u63a7\u5236\u677f\u90fd\u7ed1\u5b9a\u6210\u529f\u4e86\u3002</p>"},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/robot/1_%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE/1.%E5%AE%89%E8%A3%85%E5%BA%95%E7%9B%98%E9%A9%B1%E5%8A%A8/","title":"1.\u5b89\u88c5\u5e95\u76d8\u9a71\u52a8","text":""},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/robot/1_%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE/1.%E5%AE%89%E8%A3%85%E5%BA%95%E7%9B%98%E9%A9%B1%E5%8A%A8/#_1","title":"\u5b89\u88c5\u9a71\u52a8\u5e93","text":"<pre><code># \u5b89\u88c5\u9a71\u52a8\u5e93\nunzip py_install_V3.3.9.zip\ncd py_install\nsudo python3 setup.py install\n\n# \u6d4b\u8bd5\u9a71\u52a8\u5e93\nfrom Rosmaster_Lib import Rosmaster\nbot = Rosmaster()\nbot.create_receive_threading()\nversion = bot.get_version()\nprint(version)\nvoltage = bot.get_battery_voltage()\nprint(voltage)\ndel bot\n\n# \u521b\u5efa\u7a7a\u95f4\nmkdir -p ros2_ws/src\n# \u590d\u5236\u6e90\u4ee3\u7801\nsudo cp -r ~/yahboomcar_ws/src/yahboomcar_bringup/ ~/ros2_ws/src/   #\u5e95\u76d8\n\nsource /opt/ros/humble/setup.bash\nsource ~/ros2_ws/install/setup.bash\n\ncd ~/ros2_ws\ncolcon build\n\n\n\n\n</code></pre>"},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/robot/1_%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE/2.ros2%E5%AE%89%E8%A3%85%E5%A5%A5%E6%AF%94%E4%B8%AD%E5%85%89Astra%20Pro%20RGBD%E6%B7%B1%E5%BA%A6%E5%83%8F%E6%9C%BA/","title":"2.ros2\u5b89\u88c5\u5965\u6bd4\u4e2d\u5149Astra Pro RGBD\u6df1\u5ea6\u50cf\u673a","text":"<p>ros2\u5b89\u88c5\u5965\u6bd4\u4e2d\u5149Astra Pro RGBD\u6df1\u5ea6\u50cf\u673a</p> <pre><code>#####################\n\u4fee\u6539\u542f\u52a8launch\u6587\u4ef6\n\n    &lt;arg name=\"uvc_product_id\" default=\"0x050f\"/&gt;   #0x0501\u6539\u4e3a\u5b9e\u9645\u503c\n</code></pre> <p>https://github.com/orbbec/ros2_astra_camera</p>"},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/robot/1_%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE/2.ros2%E5%AE%89%E8%A3%85%E5%A5%A5%E6%AF%94%E4%B8%AD%E5%85%89Astra%20Pro%20RGBD%E6%B7%B1%E5%BA%A6%E5%83%8F%E6%9C%BA/#install-additional-dependencies","title":"Install additional dependencies","text":"<p>\u25cf Install dependencies</p> <pre><code>sudo apt install libgflags-dev nlohmann-json3-dev \\\nros-humble-image-transport ros-humble-image-publisher ros-humble-image-geometry -y\n\n</code></pre> <p>\u25cf Install glog</p> <pre><code>cd ~/ros2_ws/software\nwget -c https://github.com/google/glog/archive/refs/tags/v0.6.0.tar.gz  -O glog-0.6.0.tar.gz\ntar -xzvf glog-0.6.0.tar.gz\ncd glog-0.6.0\nmkdir build &amp;&amp; cd build\ncmake .. &amp;&amp; make -j4\nsudo make install\nsudo ldconfig  # Refreshing the link library\n</code></pre> <p>\u25cf Install magic_enum</p> <pre><code>cd ~/ros2_ws/software\nwget -c https://github.com/Neargye/magic_enum/archive/refs/tags/v0.8.0.tar.gz -O  magic_enum-0.8.0.tar.gz\n\ntar -xzvf magic_enum-0.8.0.tar.gz\ncd magic_enum-0.8.0\nmkdir build &amp;&amp; cd build\ncmake .. &amp;&amp; make -j4\nsudo make install\nsudo ldconfig # Refreshing the link library\n</code></pre> <p>\u25cf Install libuvc</p> <pre><code>cd ~/ros2_ws/software\ngit clone https://github.com/libuvc/libuvc.git\ncd libuvc\nmkdir build &amp;&amp; cd build\ncmake .. &amp;&amp; make -j4\nsudo make install\nsudo ldconfig # Refreshing the link library\n</code></pre>"},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/robot/1_%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE/2.ros2%E5%AE%89%E8%A3%85%E5%A5%A5%E6%AF%94%E4%B8%AD%E5%85%89Astra%20Pro%20RGBD%E6%B7%B1%E5%BA%A6%E5%83%8F%E6%9C%BA/#getting-started","title":"Getting Started","text":""},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/robot/1_%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE/2.ros2%E5%AE%89%E8%A3%85%E5%A5%A5%E6%AF%94%E4%B8%AD%E5%85%89Astra%20Pro%20RGBD%E6%B7%B1%E5%BA%A6%E5%83%8F%E6%9C%BA/#use-cases","title":"Use cases","text":"<p>\u25cf Create a new ros2 workspace</p> <pre><code>mkdir -p ~/ros2_ws/src\n</code></pre> <p>\u25cf Extract and copy openNISDk_ROS2_xxx.tar.gz to ~/ros2_ws/src/ \u25cf Install libusb rules</p> <pre><code>cd ~/ros2_ws/src/ros2_astra_camera/astra_camera/scripts\nsudo bash install.sh\nsudo udevadm control --reload-rules &amp;&amp; sudo udevadm trigger\n</code></pre> <pre><code>vi /ros2_astra_camera/astra_camera/params/astra_mini_partams.yaml\n\n----\n# \u53c2\u6570\u8bbe\u7f6e\u6a21\u677f\ncamera_name : \"camera\" # # \u76f8\u673a\u540d\u5b57\uff08\u552f\u4e00\uff09\ncolor_width: 640 # RGB\u5bbd\ncolor_height: 480 # RGB\u9ad8\ncolor_fps: 30 # RGB\u5e27\u7387\nenable_color: true #  RGB\u5f00\u5173\n\n# UVC \u76f8\u673a\uff0c\u76ee\u524d\u53ea\u6709 dabai, dabi DCW \u9700\u8981 | UVC camera , only for dabai , dabai DCW serial\nuvc_camera.enable: true\n</code></pre> <p>\u25cf Compiling</p> <pre><code>cd ~/ros2_ws\nsource /opt/ros/humble/setup.bash \ncolcon build --event-handlers  console_direct+  --cmake-args  -DCMAKE_BUILD_TYPE=Release\n</code></pre> <p>Starting the camera</p> <p>\u25cf In terminal 1</p> <pre><code>source /opt/ros/humble/setup.bash \nsource ./install/setup.bash \nros2 launch astra_camera astra_mini.launch.py\n</code></pre> <p>\u25cf In terminal 2</p> <pre><code>source /opt/ros/humble/setup.bash \nsource ./install/setup.bash \nrviz2 -d src/ros2_astra_camera/astra_camera/rviz/pointcloud.rviz\n</code></pre> <p>\u25cf List topics / services/ parameters (open a new terminal)</p> <pre><code>source /opt/ros/humble/setup.bash \nros2 topic list\nros2 service list\nros2 param list\n</code></pre>"},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/robot/1_%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE/3.ros2%E5%AE%89%E8%A3%85%E6%BF%80%E5%85%89%E9%9B%B7%E8%BE%BE/","title":"3.ros2\u5b89\u88c5\u6fc0\u5149\u96f7\u8fbe","text":"<p>https://github.com/Slamtec/sllidar_ros2</p>"},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/robot/1_%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE/3.ros2%E5%AE%89%E8%A3%85%E6%BF%80%E5%85%89%E9%9B%B7%E8%BE%BE/#compile-install-sllidar_ros2-package","title":"Compile &amp; Install sllidar_ros2 package","text":"<ol> <li>Clone sllidar_ros2 package from github</li> </ol> <p>Ensure you're still in the ros2_ws/src directory before you clone:</p> <p><code>cd ~/ros2_ws/src    git clone https://github.com/Slamtec/sllidar_ros2.git</code></p> <ol> <li>Build sllidar_ros2 package</li> </ol> <p>From the root of your workspace (ros2_ws), you can now build sllidar_ros2 package using the command:</p> <p><code>cd ~/ros2_ws/    source /opt/ros/humble/setup.bash    colcon build --symlink-install</code></p> <p>if you find output like \"colcon:command not found\",you need separate install colcon build tools.</p> <ol> <li>Package environment setup</li> </ol> <p><code>source ./install/setup.bash</code></p> <p>Note: Add permanent workspace environment variables. It's convenientif the ROS2 environment variables are automatically added to your bash session every time a new shell is launched:</p> <p><code>$echo \"source ~/ros2_ws/install/setup.bash\" &gt;&gt; ~/.bashrc    $source ~/.bashrc</code></p> <ol> <li>Create udev rules for rplidar</li> </ol> <p>sllidar_ros2 running requires the read and write permissions of the serial device. You can manually modify it with the following command:</p> <p><code>sudo chmod 777 /dev/ttyUSB0</code></p> <p>But a better way is to create a udev rule:</p> <p><code>cd src/rpldiar_ros/    source scripts/create_udev_rules.sh      #\u811a\u672c\u8def\u5f84\u9519\u8bef\uff0c\u9700\u4fee\u6539</code></p>"},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/robot/1_%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE/3.ros2%E5%AE%89%E8%A3%85%E6%BF%80%E5%85%89%E9%9B%B7%E8%BE%BE/#run-sllidar_ros2","title":"Run sllidar_ros2","text":""},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/robot/1_%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE/3.ros2%E5%AE%89%E8%A3%85%E6%BF%80%E5%85%89%E9%9B%B7%E8%BE%BE/#run-sllidar-node-and-view-in-the-rviz","title":"Run sllidar node and view in the rviz","text":"<p>The command for RPLIDAR A1 is :</p> <pre><code>ros2 launch sllidar_ros2 view_sllidar_a1_launch.py\n</code></pre>"},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/robot/1_%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE/ROS2%20%E4%B8%AD%E5%AF%B9%E6%B7%B1%E5%BA%A6%E7%9B%B8%E6%9C%BA%E8%BF%9B%E8%A1%8C%E6%A0%87%E5%AE%9A/","title":"ROS2 \u4e2d\u5bf9\u6df1\u5ea6\u76f8\u673a\u8fdb\u884c\u6807\u5b9a","text":""},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/robot/1_%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE/ROS2%20%E4%B8%AD%E5%AF%B9%E6%B7%B1%E5%BA%A6%E7%9B%B8%E6%9C%BA%E8%BF%9B%E8%A1%8C%E6%A0%87%E5%AE%9A/#1","title":"1\u3001\u6807\u5b9a\u524d\u51c6\u5907","text":"<ul> <li>\u4e00\u4e2a\u5df2\u77e5\u5c3a\u5bf8\u7684\u5927\u68cb\u76d8\u3002\u672c\u6559\u7a0b\u4f7f\u75289x6\u68cb\u76d8\u683c\u548c20\u6beb\u7c73\u6b63\u65b9\u5f62\uff0c\u6807\u5b9a\u7684\u65f6\u5019\u8981\u5c55\u5e73\u3002\u6821\u51c6\u4f7f\u7528\u68cb\u76d8\u683c\u7684\u5185\u90e8\u9876\u70b9\uff0c\u56e0\u6b64\u201c10x7\u201d\u68cb\u76d8\u4f7f\u7528\u5185\u90e8\u9876\u70b9\u53c2\u6570\u201c9x6\u201d\uff0c\u5982\u4e0b\u4f8b\u6240\u793a\u3002\u4ec0\u4e48\u89c4\u683c\u7684\u6807\u5b9a\u677f\u90fd\u53ef\u4ee5\uff0c\u53ea\u4e0d\u8fc7\u6539\u4e00\u4e0b\u53c2\u6570\u5c31\u597d\u3002\u7a7a\u65f7\u4e00\u70b9\u7684\u533a\u57df\uff0c\u6ca1\u6709\u969c\u788d\u7269\u548c\u6807\u5b9a\u677f\u56fe\u6848</li> <li>\u901a\u8fc7 ROS \u53d1\u5e03\u56fe\u50cf\u7684\u5355\u76ee\u76f8\u673a</li> </ul>"},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/robot/1_%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE/ROS2%20%E4%B8%AD%E5%AF%B9%E6%B7%B1%E5%BA%A6%E7%9B%B8%E6%9C%BA%E8%BF%9B%E8%A1%8C%E6%A0%87%E5%AE%9A/#2","title":"2\u3001\u5f00\u59cb\u6807\u5b9a","text":"<p>\u5b89\u88c5\u6807\u5b9a\u7684\u529f\u80fd\u5305camera_calibration\uff0cdocker\u7ec8\u7aef\u8f93\u5165\uff0c</p> <pre><code>sudo apt install ros-foxy-camera-calibration*\n</code></pre> <p>\u5728\u6807\u5b9a\u4e4b\u524d\u542f\u52a8\u76f8\u673a\uff0c\u76f4\u5230\u5168\u90e8\u6807\u5b9a\u5b8c\u6bd5\u518d\u5173\u95ed\u76f8\u673a\uff0c\u542f\u52a8\u76f8\u673a\uff08\u4ee5\u542f\u52a8astraproplus\u76f8\u673a\u4e3a\u4f8b\uff09\uff0cDocker\u7ec8\u7aef\u4e2d\u8f93\u5165\uff0c</p> <pre><code>ros2 launch astra_camera astro_pro_plus.launch.xml\n</code></pre> <p>\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u67e5\u770b\u8bdd\u9898\uff0cDocker\u7ec8\u7aef\u4e2d\u8f93\u5165\uff0c</p> <pre><code>ros2 topic list\n</code></pre> <p></p> <p>\u6211\u4eec\u6807\u5b9aRGB\u5f69\u8272\u56fe\u50cf\u9700\u8981\u7528\u5230\u7684\u8bdd\u9898\u662f/camera/color/image_raw.</p> <p>\u8fd0\u884c\u6807\u5b9a\u7684\u7a0b\u5e8f\uff0cDocker\u7ec8\u7aef\u4e2d\u8f93\u5165\uff0c</p> <pre><code>ros2 run camera_calibration cameracalibrator --size 8x6 --square 0.025 --ros-args --remap /image:=/camera/color/image_raw\n</code></pre> <p>size\uff1a\u6807\u5b9a\u68cb\u76d8\u683c\u7684\u5185\u90e8\u89d2\u70b9\u4e2a\u6570\uff0c\u4f8b\u5982 8 X 6\uff0c\u89d2\u70b9\u4e00\u5171\u516d\u884c\u516b\u5217\u3002</p> <p>square\uff1a\u68cb\u76d8\u683c\u7684\u8fb9\u957f\uff0c\u5355\u4f4d\u662f\u7c73\u3002</p> <p>\u8bdd\u9898\u540d\u5b57\uff1a/camera/color/image_raw\uff0c\u5982\u679c\u662f\u542f\u52a8usb_cam\u7684\u8bdd\uff0c\u8fd9\u91cc\u4fee\u6539\u6210/image_raw</p> <p></p> <p>X\uff1a\u68cb\u76d8\u683c\u5728\u6444\u50cf\u5934\u89c6\u91ce\u4e2d\u7684\u5de6\u53f3\u79fb\u52a8</p> <p>Y\uff1a\u68cb\u76d8\u683c\u5728\u6444\u50cf\u5934\u89c6\u91ce\u4e2d\u7684\u4e0a\u4e0b\u79fb\u52a8</p> <p>Size \uff1a\u68cb\u76d8\u683c\u5728\u6444\u50cf\u5934\u89c6\u91ce\u4e2d\u7684\u524d\u540e\u79fb\u52a8</p> <p>Skew\uff1a\u68cb\u76d8\u683c\u5728\u6444\u50cf\u5934\u89c6\u91ce\u4e2d\u7684\u503e\u659c\u8f6c\u52a8</p> <p>\u5982\u4e0a\u56fe\u6240\u793a\uff0c\u9700\u8981\u901a\u8fc7\u4e0a\u4e0b\u524d\u540e\u5de6\u53f3\u5de6\u53f3\u7ffb\u8f6c\u6765\u91c7\u96c6\u56fe\u50cf\uff0c\u4f7f\u5f97\u53f3\u8fb9\u7684X\u3001Y\u3001Size\u3001Skew\u53d8\u6210\u7eff\u8272\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u7136\u540e\u70b9\u51fbCALIBRATE\uff0c\u5f00\u59cb\u6807\u5b9a\u3002</p> <p></p> <p>\u6807\u5b9a\u7ed3\u675f\u540e\uff0c\u70b9\u51fbSAVE\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff0c</p> <p></p> <p>\u6807\u5b9a\u7ed3\u679c\u4fdd\u5b58\u81f3\u3010/tmp/calibrationdata.tar.gz\u3011\uff0c\u4fdd\u5b58\u7684\u8def\u5f84\u4e3a\u6807\u5b9a\u7a0b\u5e8f\u542f\u52a8\u7684\u7ec8\u7aef\u76ee\u5f55\u4e0b\u3002\u6807\u5b9a\u7ed3\u675f\u540e\uff0c\u53ef\u4ee5\u79fb\u52a8\u51fa\u6765\u3010/tmp/calibrationdata.tar.gz\u3011\u6587\u4ef6\u770b\u770b\u5185\u5bb9</p> <pre><code>sudo mv /tmp/calibrationdata.tar.gz ~\n</code></pre> <p>docker\u7ec8\u7aef\u8f93\u5165\uff0c</p> <pre><code>cd ~\ntar -xvf calibrationdata.tar.gz\n</code></pre> <p>\u4f1a\u5728\u7ec8\u7aef\u76ee\u5f55\u4e0b\u5f97\u5230\u6807\u5b9a\u7684png\u6587\u4ef6\u3001ost.yaml\u548cost.txt\u6587\u4ef6</p> <p>\u7531\u4e8eastra\u9a71\u52a8\u542f\u52a8\u7684\u65f6\u5019\u662f\u52a0\u8f7d\u4ee3\u7801\u91cc\u8fb9\u6807\u5b9a\u597d\u7684\u5185\u7f6e\u7684\u53c2\u6570\uff0c\u6240\u4ee5\u4e0d\u9700\u8981\u52a0\u8f7d\u8fd9\u4e2a\u6807\u5b9a\u540e\u7684\u53c2\u6570\uff0c\u4f46\u662f\u5f53\u542f\u52a8usb\u6444\u50cf\u5934\u65f6\u662f\u9700\u8981\u52a0\u8f7d\u53c2\u6570\u7684\uff0c\u56e0\u6b64\uff0c\u6807\u5b9a\u540e\u9700\u8981\u628a\u53c2\u6570\u66ff\u6362\u539f\u6765\u7684\u5185\u7f6e\u53c2\u6570\uff0c\u628a\u6807\u5b9a\u597d\u7684ost.yaml\u6539\u540d\u4e3acamera_info.yaml\uff0c\u7136\u540e\u66ff\u6362\u539f\u6765\u7684camera_info.yaml\uff0cdocker\u7ec8\u7aef\u8f93\u5165\uff0c</p> <pre><code>#\u5148\u628a\u6587\u4ef6\u590d\u5236\u5230/opt/ros/foxy/share/usb_cam/config\nsudo cp ost.yaml /opt/ros/foxy/share/usb_cam/config\n#\u5207\u6362\u81f3/opt/ros/foxy/share/usb_cam/config\u76ee\u5f55\u4e0b\ncd /opt/ros/foxy/share/usb_cam/config\n#\u5907\u4efd\u539f\u6765\u7684camera_info.yaml\nsudo mv camera_info.yaml camera_info_BK.yaml\n#\u91cd\u547d\u540dost.yaml\u4e3acamera_info.yaml\nsudo mv ost.yaml camera_info.yaml\n</code></pre>"},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/robot/1_%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE/Ubuntu22.04%E7%B3%BB%E7%BB%9FROS2%E5%BC%80%E6%9C%BA%E8%87%AA%E5%90%AF%E5%8A%A8/","title":"Ubuntu22.04\u7cfb\u7edfROS2\u5f00\u673a\u81ea\u542f\u52a8","text":"<pre><code>\nsource /opt/ros/humble/setup.bash\nsource /root/ros2_ws/install/setup.bash\n</code></pre> <pre><code>[Unit]\nDescription=ros2 launch script\n\n[Service]\nType=simple\n\n# \u6307\u5b9a\u7528\u6237\u540d\uff0c\u4e5f\u5c31\u662fUbuntu\u7cfb\u7edf\u4e0b\u5f53\u524d\u7684\u7528\u6237\u540d\nUser=$your_name$    \n\n# \u8fd0\u884c\u811a\u672cxxx.sh\uff0c\u786e\u4fdd\u811a\u672c\u5177\u5907\u53ef\u6267\u884c\u6743\u9650,\u5177\u4f53\u6307\u4ee4\u5199\u5728xxx.sh\u4e2d\nExecStart=/root/ros_ws/rc.sh\n\nPrivateTmp=true\nKillMode=control-group\n\n[Install]\nWantedBy=multi-user.target\n</code></pre> <pre><code>sudo systemctl daemon-reload    # \u91cd\u65b0\u52a0\u8f7d\u670d\u52a1\nsystemctl start rc.service      # \u542f\u52a8\u670d\u52a1\nsystemctl status rc.service     # \u67e5\u770b\u670d\u52a1\u72b6\u6001\nsystemctl enable rc.service     # \u5f00\u673a\u542f\u52a8\n\n</code></pre> <p>\u6df1\u5ea6\u76f8\u673a</p> <pre><code>\n#\u5b89\u88c5udev\nsudo apt install udev -y\n\n</code></pre>"},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/robot/robotmaster_s1/%E9%85%8D%E7%BD%AE%E5%AE%89%E8%A3%85/","title":"\u914d\u7f6e\u5b89\u88c5","text":""},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/robot/robotmaster_s1/%E9%85%8D%E7%BD%AE%E5%AE%89%E8%A3%85/#_1","title":"\u914d\u7f6e\u5b89\u88c5","text":""},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/robot/robotmaster_s1/%E9%85%8D%E7%BD%AE%E5%AE%89%E8%A3%85/#conda","title":"\u73af\u5883conda\u5b89\u88c5","text":"<pre><code># anaconda\u4e0b\u8f7d\u5b89\u88c5\nwget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh &amp;&amp; chmod +x Miniconda3-latest-Linux-x86_64.sh &amp;&amp; bash Miniconda3-latest-Linux-x86_64.sh\n\n# \u521b\u5efa\u73af\u5883\nconda create --name robot python=3.7\n\n# \u6fc0\u6d3b\u73af\u5883\nconda activate myenv\n\n# \u5220\u9664\u73af\u5883\nconda remove --name myenv --all\n\n# \u5217\u51fa\u73af\u5883\nconda env list\n</code></pre> <pre><code># \u5b89\u88c5robomaster\u5305\npip install -i https://pypi.tuna.tsinghua.edu.cn/simple robomaster\n\n# \u4e0b\u8f7d\u793a\u4f8b\u6e90\u7801\ngit clone https://gitee.com/xitinglin/RoboMaster-SDK\n</code></pre> <pre><code>\n</code></pre>"},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/voron/%E6%A0%A1%E5%87%86%E5%8A%A0%E9%80%9F%E5%BA%A6/","title":"\u6821\u51c6\u52a0\u901f\u5ea6","text":""},{"location":"%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/voron/%E6%A0%A1%E5%87%86%E5%8A%A0%E9%80%9F%E5%BA%A6/#_1","title":"\u6821\u51c6\u52a0\u901f\u5ea6","text":"<p>\u76ee\u7684\uff1a</p> <p>\u5728\u6253\u5370\u901f\u5ea6\u548c\u8d28\u91cf\u4e4b\u95f4\u627e\u5230\u6b63\u786e\u7684\u6298\u8877\u65b9\u6848\uff0c\u7279\u522b\u662f\u4e0e\u91cd\u5f71\u7b49\u8868\u9762\u4f2a\u5f71\u6709\u5173\u3002</p> <p>\u4f55\u65f6\u64cd\u4f5c\uff1a</p> <p>\u521d\u59cb\u6821\u51c6\uff0c\u5f53\u8fd0\u52a8\u7cfb\u7edf\u53d1\u751f\u91cd\u5927\u53d8\u5316\u65f6\uff08\u4f8b\u5982\uff0c\u8f83\u91cd\u7684\u5e8a\uff0c\u8fdc\u7a0b\u6324\u51fa\u673a\u66f4\u6362\u6210\u8fdb\u7a0b\u6324\u51fa\u673a\u3002\uff09\u3002</p> <pre><code>[printer]\nmax_accel: 7000\nmax_accel_to_decel: 7000\n\n[resonance_tester]\naccel_chip: adxl345\nprobe_points:\n  150,150,20\n</code></pre> <p>\u914d\u7f6e\u5b8c\u6210\u540e\uff0c\u91cd\u542fKlipper\uff0c\u63a7\u5236\u53f0\u8f93\u5165</p> <pre><code>ACCELEROMETER_QUERY\n</code></pre> <p>\u8fd9\u4e2a\u547d\u4ee4\u662f\u67e5\u8be2\u52a0\u901f\u5ea6\u7684\u53c2\u6570\uff0c\u5982\u679c\u6b63\u786e\u5e94\u6536\u5230\u8fd4\u56de\u7684\u52a0\u901f\u5ea6\u6570\u636e\uff0c\u7c7b\u4f3c\u4e0b\u9762\u5185\u5bb9\uff1a</p> <pre><code>accelerometer values (x, y, z): -153.219100, 370.102971, 9400.615463\n</code></pre> <p>\u7136\u540e\u5f00\u59cb\u6d4b\u8bd5\u5171\u632f\uff0c\u76f4\u63a5\u7528\u81ea\u52a8\u6d4b\u8bd5\u914d\u7f6e\u547d\u4ee4</p> <pre><code>SHAPER_CALIBRATE\n</code></pre> <p>\u6d4b\u8bd5\u5b8c\u6210\uff0c\u4fdd\u5b58</p> <pre><code>SAVE_CONFIG\n</code></pre>"},{"location":"%E5%8A%A0%E5%AF%86%E8%B4%A7%E5%B8%81/%E6%95%B0%E5%AD%97%E8%B4%A7%E5%B8%81/","title":"\u6570\u5b57\u8d27\u5e01","text":"<p>\u4e00\u3001\u52a0\u5bc6\u8d27\u5e01 \u6570\u5b57\u8d27\u5e01        \u52a0\u5bc6\u8d27\u5e01</p> <p>\u592e\u884c\u53d1\u884c\u6cd5\u5e01  \u533a\u5757\u94fe\u52a0\u5bc6\u6570\u5b57\u8d27\u5e01 1\u3001\u653f\u5e9c\u80cc\u4e66      \u4e0d\u5177\u6709\u6cd5\u507f\u6027 2\u3001\u4e2d\u5fc3\u5316       \u53bb\u4e2d\u5fc3\u5316 3\u3001\u6cd5\u5e01\u951a\u5b9a      \u8d2d\u4e70\u8005\u4ef7\u503c\u8ba4\u5b9a/\u4f9b\u9700\u5173\u7cfb</p> <p>[\u6280\u672f]\u533a\u5757\u94fe\uff1a\u5b89\u5168\u3001\u901f\u5ea6\u3001\u53bb\u4e2d\u5fc3\u5316 BTC ETH CHIA SOLANA </p> <p>\u94b1\u5305\uff1a\u5c0f\u72d0\u72f8</p> <p>\u4e8c\u3001DEFI \u53bb\u4e2d\u5fc3\u5316\u91d1\u878d   2020 04-07 [\u6280\u672f]\u533a\u5757\u94fe\u3001*\u667a\u80fd\u5408\u7ea6</p> <p>\u501f\u8d37  \u8d28\u62bc\u52a0\u5bc6\u8d27\u5e01\uff0c\u951a\u5b9aDAI(\u53ef\u7f16\u7a0b\u7a33\u5b9a\u5e01)\u3002\u62b5\u62bc\u6216\u501f\u8d37\uff1b Compound/ \u6d41\u52a8\u6027\u6316\u77ff   \u65e0\u5e38\u635f\u5931 \u884d\u751f\u54c1 \u4fdd\u9669 ...</p> <p>\u4e09\u3001NFT \u975e\u540c\u8d28\u5316\u4ee3\u5e01 1 BTC -&gt; 1 BTC 1 30\u5e74\u8305\u53f0 \uff01= \u4eca\u5e74\u8305\u53f0 \u7279\u70b9\uff1a\u72ec\u7279\u6027 \u4e0d\u53ef\u5206\u5272</p> <p>\u56db\u3001GAMEFI (\u94fe\u6e38) GameFi = Defi + NFT + Game \u5c06\u6e38\u620f\u6570\u5b57\u8d44\u4ea7\u7684\u5f52\u5c5e\u6743\u56de\u5f52\u7ed9\u73a9\u5bb6</p> <p>Axie    \u963f\u87f9 FarmersWorld    \u519c\u6c11\u4e16\u754c StarAtlas   \u661f\u56fe</p> <p>\u4e94\u3001\u5143\u5b87\u5b99</p> <p>\u5e38\u7528\u94fe\u63a5\uff1a https://coinmarketcap.com/zh/</p>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/DSM/DS3617xsDS3622xs%207.0.1%20%E5%BC%80%E5%90%AFNVME%E7%BC%93%E5%AD%98/","title":"DS3617xsDS3622xs 7.0.1 \u5f00\u542fNVME\u7f13\u5b58","text":""},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/DSM/DS3617xsDS3622xs%207.0.1%20%E5%BC%80%E5%90%AFNVME%E7%BC%93%E5%AD%98/#ds3617xsds3622xs-701-nvme","title":"DS3617xs/DS3622xs 7.0.1 \u5f00\u542fNVME\u7f13\u5b58","text":"<p>\u9996\u5148 \u628aNVME\u786c\u76d8\u63d2\u4e0a\u4f7f\u7528 ls /dev/nvm* \u547d\u4ee4\u67e5\u770b\u662f\u5426\u8ba4\u5230nvme\u56fa\u6001\u786c\u76d8</p> <pre><code>ls /dev/nvm*\n</code></pre> <p>\u8f93\u5165\u547d\u4ee4udevadm info /dev/+NVME\u786c\u76d8\u540d\u79f0  \u56de\u8f66\uff0c\u67e5\u4e00\u4e0b\u81ea\u5df1NVME\u7684ID\u4f4d\u7f6e</p> <pre><code>udevadm info /dev/nvme0n1\n</code></pre> <p>0000:02:05.0</p> <p>0000:02:06.0</p> <p>\u8f93\u5165\u547d\u4ee4\uff0c\u4fee\u6539\u6587\u4ef6\uff1a</p> <pre><code>vi /etc.defaults/extensionPorts\n</code></pre> <p>\u4f7f\u6587\u4ef6\u91cc\u9762\u7684ID\u4e0e\u5b9e\u9645nvme\u786c\u76d8\u7684\u76f8\u5339\u914d\uff0c\u6bd4\u5982\u6211\u8fd9\u4e2a\u8981\u6539\u6210\uff08\u4ee5\u4f60\u5b9e\u9645\u7684ID\u4e3a\u51c6\uff09\uff1a</p> <pre><code>[PCI]\npci1=\"0000:02:05.0\"\npci2=\"0000:02:06.0\"\n</code></pre> <p>\u4fdd\u5b58\u9000\u51fa\uff0c\u91cd\u542f\u7fa4\u6656\u751f\u6548\u3002</p>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/DSM/Synology%E7%BE%A4%E6%99%96%E4%B8%8A%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8nvme%E5%9B%BA%E6%80%81%E7%A1%AC%E7%9B%98%E5%81%9A%E5%AD%98%E5%82%A8%E7%A9%BA%E9%97%B4/","title":"Synology\u7fa4\u6656\u4e0a\u5982\u4f55\u4f7f\u7528nvme\u56fa\u6001\u786c\u76d8\u505a\u5b58\u50a8\u7a7a\u95f4","text":"<p>\u4e00\u5757nvme \u786c\u76d8\u7684\u60c5\u51b5 \u9996\u5148ssh\u8fde\u63a5\u5230\u7fa4\u6656dsm\uff0c\u8f93\u5165sudo -i \u5207\u6362\u5230\u7ba1\u7406\u5458\u6a21\u5f0f</p> <p>// \u5217\u51fa\u6240\u6709nvme\u786c\u76d8</p> <p>ls /dev/nvme*n1 </p> <p>*\u4ee5\u4e0b\u5f00\u59cb\u662f\u91cd\u70b9**</p> <p>//\u7b2c\u4e00\u6b65\uff1a\u5206\u533a\uff0c\u9002\u54081\u4e2anvme\u7684\u60c5\u51b5\uff0c\u6ce8\u610f0\u4ee3\u8868\u7b2c\u4e00\u5757nvme synopartition --part /dev/nvme0n1 12</p> <p>//\u7b2c\u4e8c\u6b65\uff1a\u67e5\u770b\u5f53\u524d\u5b58\u50a8\u6c60\u7684\u5e8f\u53f7,\u8bb0\u4e0b\u6765\uff0c\u8fd9\u4e00\u6b65\u4e0d\u662f\u5fc5\u987b\u7684\uff0c\u56e0\u4e3a\u5e8f\u53f7\u53ef\u4ee5\u586b\u5199\u5f88\u5927\u7684 cat /proc/mdstat</p> <p>//\u7b2c\u4e09\u6b65\uff1a\u521b\u5efaNVME \u5b58\u50a8\u6c60\uff0c\u5176\u4e2dmd6\u4e2d\u76846\u4ee3\u8868\u8981\u521b\u5efa\u7684\u5b58\u50a8\u6c60\u7684\u5e8f\u53f7\u3002 mdadm --create /dev/md6 --level=1 --raid-devices=1 --force /dev/nvme0n1p3</p> <p>//\u7b2c\u56db\u6b65\uff1a\u683c\u5f0f\u5316\u5b58\u50a8\u7a7a\u95f4 mkfs.ext4 -F /dev/md6</p> <p>//\u7b2c\u4e94\u6b65\uff1a\u91cd\u542f\u7fa4\u6656NAS reboot ***\u4ee3\u7801\u90e8\u5206\u7ed3\u675f\u4e86*******</p> <p>\u540e\u7eed\u64cd\u4f5c\uff1a\u5728dsm\u540e\u53f0\u4e2d \u627e\u5230</p> <p>\u5b58\u50a8\u7a7a\u95f4\u2014\u2014\u53ef\u7528\u6c601\u2014\u2014\u5728\u7ebf\u91cd\u7ec4</p> <p>2\u5757Nvme\u786c\u76d8\u7684\u60c5\u51b5\uff0c\u5982\u4f55\u7ec4Raid\uff0c\u6bd4\u5982Raid0</p> <p>//\u7b2c\u4e00\u6b65\uff1a\u5206\u522b \u7ed9 \u4e24\u5757nvme\u7684 ssd \u5206\u533a synopartition --part /dev/nvme0n1 12 synopartition --part /dev/nvme1n1 12</p> <p>//\u7b2c\u4e8c\u6b65\uff1a\u521b\u5efa raid 0\u7684\u5b58\u50a8\u6c60\uff0c\u5176\u4e2dmd6\u4e2d\u76846\u4ee3\u8868\u8981\u521b\u5efa\u7684\u5b58\u50a8\u6c60\u7684\u5e8f\u53f7\u3002 mdadm --create /dev/md6 --level=0 --raid-devices=2 --force /dev/nvme0n1p3 /dev/nvme1n1p3</p> <p>//\u7b2c\u4e09\u6b65\uff1a\u683c\u5f0f\u5316\u5b58\u50a8\u6c60 mkfs.ext4 -F /dev/md6</p> <p>\u7b2c\u56db\u6b65\uff1a\u91cd\u542f\u7fa4\u6656NAS\uff0c\u5e76\u5728\u7ebf\u91cd\u7ec4 \u5b58\u50a8\u7a7a\u95f4\u2014\u2014\u53ef\u7528\u6c601\u2014\u2014\u5728\u7ebf\u91cd\u7ec4</p>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/DSM/readme/","title":"Readme","text":"<p>\u7fa4\u6656DS3622xs+\u6d17\u767d\u7801</p> <p>\u60a8\u8d2d\u4e70\u7684\u8ba2\u5355\u53f7\uff1a3428296383777242413\u8bf7\u6ce8\u610f\u67e5\u6536\uff1a SN\uff1a219HSQRNRFYGD MAC1\uff1a9009D0048C92 \u4e3a\u9632\u6b62\u88ab\u5b98\u65b9\u9a8c\u8bc1\uff0c7.x\u7684\u7528\u6237\u8bf7\u4f7f\u7528\u5168\u7403\u533a\u8d26\u53f7\u767b\u5f55\uff0c6.x\u7528\u6237\u8bf7\u5ffd\u7565 \u5168\u7403\u533a\u8d26\u53f7\u6ce8\u518c\u6559\u7a0b:https://www.ainas.cc:88/?p=572 \u7fa4\u6656\u5b89\u88c5\u53ca\u6d17\u767d\u6559\u7a0b:https://www.ainas.cc:88/?page_id=8 \u5f15\u5bfc\u6587\u4ef6\u53ca\u5e38\u7528\u5de5\u5177\u4e0b\u8f7d:https://www.ainas.cc:88/?page_id=2 \u67e5\u770b\u9ed1\u7fa4\u6656\u6d17\u767d\u662f\u5426\u6210\u529f:https://www.ainas.cc:88/?p=304 \u4e00\u5e74\u5185SN\u51fa\u73b0\u95ee\u9898\u53ef\u514d\u8d39\u66f4\u63622\u6b21\uff0c24\u5c0f\u65f6\u786e\u8ba4\u53ce\u8d27\u5e76\u4e14\u597d\u576a\u7684\u53ef\u514d\u8d39\u66f4\u63623\u6b21\u3002</p> <p>\u5b89\u88c5\u6307\u5357</p> <p>https://www.bilibili.com/video/BV1YV4y1X7ak/?spm_id_from=333.337.search-card.all.click&amp;vd_source=2b0c041bc65a68cc5157104c2c43b256</p> <p>\u7fa4\u6656\u6838\u663e\u786c\u89e3\u8f6c\u7801</p> <p>https://www.bilibili.com/video/BV1eT411D7zb/?spm_id_from=333.337.search-card.all.click&amp;vd_source=2b0c041bc65a68cc5157104c2c43b256</p> <pre><code># ls -l /dev/dri\n\n# cat /sys/kernel/debug/dri/0/i915_frequency_info | grep HW\nHW control enabled: yes\n</code></pre> <p>https://github.com/wjz304/arpl-i18n \u4e2d\u6587arpl\u5730\u5740</p>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/DSM/readme/#arplsataportmapdsm","title":"arpl\u81ea\u5b9a\u4e49SataPortMap\u5f15\u5bfc\u7fa4\u6656DSM","text":"<p>\u5728\u8fdb\u884c\u5230Add/edit an cmdline item\u65f6\u8fdb\u884c\u4ee5\u4e0b\u989d\u5916\u64cd\u4f5c\uff0c\u6dfb\u52a0SataPortMap\u3001DiskIdxMap</p> <p>\u6ce8\u610f\uff1a\u5982\u679c\u4f7f\u7528SAS Expander\u6269\u5c55\u66f4\u591a\u786c\u76d8\u63a5\u53e3\u8981\u8bbe\u7f6e\u5982\u4e0b\u56fe\uff08\u65b9\u6cd5\u7531Redpill_CustomBuild\u7fa4\uff1a\u4e0d\u89c1Liao \u63d0\u4f9b\uff09 \u677f\u8f7d8\u53e3\u540e\u9762sas\u76f4\u901a\u5361\u4e32SAS Expander\u6269\u5c55\u5361\u6269\u5c55\u66f4\u591a\u7684\u786c\u76d8\u5219\u9700\u8981\u628a\u540e\u9762\u7684\u6bcf\u4e2asata\u82af\u7247\u90fd\u8bbe\u7f6e\u4e3a6\u3002</p> <p><code>SataPortMap 06666</code> <code>DiskIDxMap  00080E141A</code> <code>SasIdxMap  0</code></p>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/DSM/readme/#active-backup-for-busness","title":"Active Backup for Busness \u6fc0\u6d3b\u547d\u4ee4","text":"<pre><code>http://10.10.10.18:5000/webapi/auth.cgi?api=SYNO.API.Auth&amp;method=Login&amp;version=1&amp;account=\u7528\u6237\u540d&amp;passwd=\u5bc6\u7801\n\nhttp://10.10.10.18:5000/webapi/entry.cgi?api=SYNO.ActiveBackup.Activation&amp;method=set&amp;version=1&amp;activated=true&amp;serial_number=\"\u5e8f\u5217\u53f7\"\n\nhttp://10.10.10.18:5000/webapi/entry.cgi?api=SYNO.ActiveBackup.Activation&amp;method=get&amp;version=1\n\n</code></pre> <p>\u7b2c\u4e00\u6b65\uff0c\u5b89\u88c5 Active Backup for Business \u5957\u4ef6 </p> <p>\u7b2c\u4e8c\u6b65\uff0c\u6253\u5f00ABB\u5957\u4ef6\uff0c\u53d1\u73b0\u9700\u8981\u6fc0\u6d3b </p> <p>\u6253\u5f00\uff0c\u63a7\u5236\u9762\u677f - \u4fe1\u606f\u4e2d\u5fc3 - \u4ea7\u54c1\u5e8f\u5217\u53f7\uff0c\u590d\u5236\u5907\u7528</p> <p>\u7b2c\u4e09\u6b65\uff0c\u5728\u7f51\u9875\u8f93\u5165\u4ee5\u4e0b\u7f51\u5740</p> <p>http://\u7fa4\u6656\u5730\u5740:5000/webapi/auth.cgi?api=SYNO.API.Auth&amp;version=3&amp;method=login&amp;account=\u7ba1\u7406\u5458\u7528\u6237\u540d&amp;passwd=\u5bc6\u7801&amp;format= cookie</p> <p>\u7136\u540e\u7f51\u9875\u63d0\u793a\u4e2d\u6709\"success\":ture\u5b57\u6837\u5c31\u662fOK\u4e86 \uff0c\u5982\u4e0b\uff1a</p> <p>{\"data\":{\"did\":\"mIUcp9U-ufiZZrA1UFxgqZtESjSReW0dzK8pD-WPxjEjQ_Aes7qErf4CKGh_xxxx\",\"sid\":\"QER6F14sdbhys7pX_E5_mWskZtkKak-91FobgL7F9acPCkXjQsUyxxxx\"},\"success\":true}</p> <p>\u7136\u540e\uff0c\u5728\u7f51\u9875\u4e2d\u8f93\u5165\u4ee5\u4e0b\u7f51\u5740\uff1a</p> <p>http://\u7fa4\u6656\u5730\u5740:5000/webapi/entry.cgi?api=SYNO.ActiveBackup.Activation&amp;method=set&amp;version=1&amp;activated=true&amp;serial_number=\"\u5e8f\u5217\u53f7\"</p> <p>\u5c06\u7f51\u5740\u4e2d\u7684\u5730\u5740\u548c\u5e8f\u5217\u53f7\u66ff\u6362\u3002 </p>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/DSM/%E5%88%A9%E7%94%A8ARPL%E6%81%A2%E5%A4%8D%E7%8E%B0%E6%9C%89%E7%A1%AC%E7%9B%98%E7%9A%84DSM7%E7%B3%BB%E7%BB%9F/","title":"\u5229\u7528ARPL\u6062\u590d\u73b0\u6709\u786c\u76d8\u7684DSM7\u7cfb\u7edf","text":"<p>2023\u5e742\u67086\u65e5 35\u6761\u8bc4\u8bba 9.32k\u6b21\u9605\u8bfb 7\u4eba\u70b9\u8d5e \u535a\u4e3b</p> <p>\u5f88\u591a\u7fa4\u6656NAS\u73a9\u5bb6\u5e94\u8be5\u4f1a\u9047\u5230\u8fc7\u4ee5\u4e0b\u573a\u666f\uff1a</p> <p>\u2605\u4e4b\u524d\u7528\u7269\u7406\u673a\u5b89\u88c5\u7fa4\u6656\u7cfb\u7edf\uff0c\u73b0\u5728\u6539\u6210\u4e86\u865a\u62df\u673a\u5b89\u88c5\uff1b</p> <p>\u2605\u4e4b\u524d\u7528\u865a\u62df\u673a\u5b89\u88c5\u7fa4\u6656\u7cfb\u7edf\uff0c\u73b0\u5728\u6539\u6210\u4e86\u7269\u7406\u673a\u5b89\u88c5\uff1b</p> <p>\u2605\u4e4b\u524d\u7528\u865a\u62df\u673a\u7684\u64cd\u4f5c\u7cfb\u7edf\uff0c\u73b0\u5728\u8981\u6362\u6210\u4e86\u522b\u7684\u64cd\u4f5c\u7cfb\u7edf\uff08\u6bd4\u5982\uff1aPVE\u6362\u6210ESXI\u3001ESXI\u6362\u5230PVE\u3001PVE\u6362\u6210UNRAID\uff0c\u8bf8\u5982\u6b64\u7c7b\uff09</p> <p>\u2605U\u76d8\u5f15\u5bfc\u76d8\u574f\u4e86\uff0c\u9700\u8981\u91cd\u65b0\u505a\u4e00\u4e2a\uff1b</p> <p>\u2605\u4e4b\u524d\u7528U\u76d8\u505a\u5f15\u5bfc\u76d8\uff0c\u73b0\u5728\u60f3\u6362\u6210SSD\u5f15\u5bfc\uff1b</p> <p>\u2605\u4e4b\u524d\u7528SSD\u505a\u5f15\u5bfc\u76d8\uff0c\u73b0\u5728\u60f3\u6362\u6210U\u76d8\u5f15\u5bfc\uff1b</p> <p>\u7b49\u7b49......</p> <p>\u5982\u679c\u4f60\u7684\u786c\u76d8\u662fDSM7\u7cfb\u7edf\uff0c\u90a3\u4e48\u53ef\u4ee5\u5229\u7528ARPL\u6765\u5feb\u901f\u7684\u6062\u590d\u786c\u76d8\u7684DSM7\u7cfb\u7edf\u3002</p> <p>\u64cd\u4f5c\u6b65\u9aa4\uff1a</p> <p>1\u3001\u628a\u5e26\u6709DSM7\u7cfb\u7edf\u7684\u786c\u76d8\u88c5\u5230\u505aNAS\u7684\u7535\u8111\u4e3b\u673a\u4e0a\uff0c\u5728\u53e6\u5916\u7684\u7535\u8111\u4e0b\u8f7dARPL\u6700\u65b0\u7248\u672c\u7684IMG\uff0c\u505a\u6210\u5f15\u5bfc\u76d8\u542f\u52a8\uff08\u5982\u679c\u4f60\u8fd8\u4e0d\u77e5\u9053\u600e\u6837\u505a\uff0c\u90a3\u4e48\u5efa\u8bae\u5148\u53bb\u5b66\u4e60\u4e00\u4e0b\u300a\u53f2\u4e0a\u6700\u7b80\u5355\u7684\u9ed1\u7fa4\u6656DSM7.X\u5f15\u5bfc\u7f16\u8bd1\u65b9\u6cd5\uff0c\u5c0f\u5b66\u751f\u90fd\u80fd\u64cd\u4f5c\uff01\u300b\u8fd9\u7bc7\u6559\u7a0b\uff09\uff0c\u542f\u52a8\u5b8c\u6210\u540e\u5c4f\u5e55\u4e0a\u4f1a\u663e\u793a\u4e00\u4e2aIP\u5730\u5740\uff0c\u8bb0\u4e0b\u6765\uff1b</p> <p></p> <p>2\u3001\u5728\u7535\u8111\u6d4f\u89c8\u5668\u6253\u5f00\u8fd9\u4e2a\u5730\u5740\uff1b</p> <p>3\u3001\u6309\u5411\u4e0b\u7684\u65b9\u5411\u952e\uff0c\u79fb\u52a8\u5230\u201cAdvanced menu\u201d\u5904\uff0c\u56de\u8f66\uff1b</p> <p>4\u3001\u6309\u5411\u4e0b\u7684\u65b9\u5411\u952e\uff0c\u79fb\u52a8\u5230\u201cTry to recovery a DSM installed system\u201d\u5904\uff0c\u56de\u8f66\uff1b</p> <p>5\u3001\u6211\u8fd9\u4e2a\u786c\u76d8\u88c5\u7684\u662fDS923+\u7684\u7cfb\u7edf\uff0c\u7248\u672c\u662f7.11-42962\uff0c\u7cfb\u7edf\u5df2\u7ecf\u8bc6\u522b\u51fa\u6765\u4e86\uff0c\u6309\u56de\u8f66\uff1b</p> <p>6\u3001\u6b64\u65f6\u770b\u5230\u7f51\u9875\u5de6\u4e0a\u89d2\u628a\u4ece\u786c\u76d8\u8bfb\u53d6\u5230\u7684\u4fe1\u606f\u81ea\u52a8\u9009\u62e9\u597d\u4e86\uff1b</p> <p>7\u3001\u6309\u5411\u4e0b\u7684\u65b9\u5411\u952e\uff0c\u79fb\u52a8\u5230\u201cExit\u201d\u5904\uff0c\u56de\u8f66\uff1b</p> <p>8\u3001\u6309\u5411\u4e0b\u7684\u65b9\u5411\u952e\uff0c\u79fb\u52a8\u5230\u201cBuild the loader\u201d\u5904\uff0c\u56de\u8f66\uff1b</p> <p>9\u3001\u8fd9\u4e2a\u5904\u7406\u8fc7\u7a0b\u5f88\u5feb\uff1b</p> <p>10\u3001\u5904\u7406\u5b8c\u6210\u540e\uff0c\u7cfb\u7edf\u81ea\u52a8\u8df3\u56de\u83dc\u5355\uff0c\u79fb\u52a8\u65b9\u5411\u952e\u5230\u201cAdvanced menu\u201d\u5904\uff0c\u56de\u8f66\uff1b</p> <p>11\u3001\u79fb\u52a8\u65b9\u5411\u952e\u5230\u201cSwitch direct boot\uff1afalse\u201d\u5904\uff0c\u56de\u8f66\uff1b</p> <p>12\u3001\u4f7f\u201cSwitch direct boot\uff1afalse\u201d\u53d8\u6210\u201cSwitch direct boot\uff1atrue\u201d\uff0c\u5c31\u597d\u4e86\uff1b</p> <p>13\u3001\u6309\u5411\u4e0b\u7684\u65b9\u5411\u952e\uff0c\u79fb\u52a8\u5230\u201cExit\u201d\u5904\uff0c\u56de\u8f66\uff1b</p> <p>14\u3001\u6309\u5411\u4e0b\u7684\u65b9\u5411\u952e\uff0c\u79fb\u52a8\u5230\u201cBoot the loader\u201d\u5904\uff0c\u56de\u8f66\uff1b</p> <p>15\u3001\u5f53NAS\u7269\u7406\u4e3b\u673a\u5c4f\u5e55\uff08\u6216\u8005\u662fNAS\u865a\u62df\u673a\u7684\u5c4f\u5e55\uff09\u663e\u793a\u201cReboot to boot directly in DSM\u201d\u7684\u65f6\u5019\uff0c\u8868\u793a\u7cfb\u7edf\u5373\u5c06\u91cd\u542f\uff0c\u8bf7\u8010\u5fc3\u7b49\u5f85\u542f\u52a8\u5b8c\u6210\uff1b</p> <p>16\u3001\u5f53\u91cd\u542f\u5b8c\u6210\u540e\uff0c\u4f1a\u663e\u793a\u5982\u4e0b\u754c\u9762\u5c31\u4e0d\u52a8\u4e86\uff0c\u4e0d\u8981\u4ee5\u4e3a\u662f\u673a\u5668\u6b7b\u673a\u6216\u8005\u5361\u4f4f\u4e86\uff1b</p> <p>17\u3001\u8010\u5fc3\u7b49\u5f85\u51e0\u5206\u949f\uff0c\u5177\u4f53\u7b49\u5f85\u7684\u65f6\u95f4\u7531\u786c\u4ef6\u6027\u80fd\u51b3\u5b9a\uff0c\u6b63\u5e38\u60c5\u51b53-5\u5206\u949f\u4ee5\u5185\uff0c\u5728\u540c\u4e00\u4e2a\u5c40\u57df\u7f51\u5185\u7684\u53e6\u5916\u4e00\u53f0\u7535\u8111\u7528\u7fa4\u6656\u52a9\u624b\uff08Synology Assistant\uff09\u6216\u8005\u5728\u6d4f\u89c8\u5668\u6253\u5f00\u3010\u8fd9\u4e2a\u5730\u5740\u3011\u6765\u641c\u7d22\u7fa4\u6656\u7684IP\u5730\u5740\uff0c\u6216\u8005\u76f4\u63a5\u8fdb\u8def\u7531\u5668\u627eIP\u4e5f\u53ef\u4ee5\uff1b</p> <p>18\u3001\u5728\u7535\u8111\u6d4f\u89c8\u5668\u6253\u5f00\u7fa4\u6656\u7684IP\u5730\u5740\uff0c\u5c31\u53ef\u4ee5\u767b\u5f55\u7cfb\u7edf\u54af\u3002</p>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/DSM/%E7%BE%A4%E6%99%96NAS%E4%BD%BF%E7%94%A8SMB3%20MUTI%20CHANNEL%E5%8A%A0%E5%BF%AB%E4%BC%A0%E8%BE%93%E9%80%9F%E5%BA%A6/","title":"\u7fa4\u6656NAS\u4f7f\u7528SMB3 MUTI CHANNEL\u52a0\u5feb\u4f20\u8f93\u901f\u5ea6","text":""},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/DSM/%E7%BE%A4%E6%99%96NAS%E4%BD%BF%E7%94%A8SMB3%20MUTI%20CHANNEL%E5%8A%A0%E5%BF%AB%E4%BC%A0%E8%BE%93%E9%80%9F%E5%BA%A6/#nassmb3-muti-channel","title":"\u7fa4\u6656NAS\u4f7f\u7528SMB3 MUTI CHANNEL\u52a0\u5feb\u4f20\u8f93\u901f\u5ea6","text":"<p>\u9700\u8981\u6240\u7528\u5230\u7684\u8bbe\u5907\uff1a</p> <ol> <li>\u53cc\u7f51\u53e3\u7fa4\u6656</li> <li>\u5e26\u6709\u4e24\u4e2a\u7f51\u5361\u7684PC\uff08\u666e\u901a\u8ba1\u7b97\u673a\u53ef\u4ee5\u52a0\u4e00\u5757PCI-E\u7f51\u5361\uff09</li> <li>\u5e26\u6709\u81f3\u5c114\u4e2a\u53e3\u7684\u4ea4\u6362\u673a</li> <li>\u56db\u6839\u5343\u5146\u7f51\u7ebf\uff08CAT6\uff09</li> </ol>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/DSM/%E7%BE%A4%E6%99%96NAS%E4%BD%BF%E7%94%A8SMB3%20MUTI%20CHANNEL%E5%8A%A0%E5%BF%AB%E4%BC%A0%E8%BE%93%E9%80%9F%E5%BA%A6/#step1","title":"STEP1","text":"<p>\u7fa4\u6656DSM\u4e2d\u6ca1\u6709\u76f4\u63a5\u4fee\u6539SMB3 muti channel\u7684\u9009\u9879\uff0c\u9700\u8981\u4fee\u6539smb.conf\u6587\u4ef6\u3002\u901a\u8fc7ssh\u4ee5root\u767b\u9646\u7fa4\u6656\u3002samba\u914d\u7f6e\u6587\u4ef6\u8def\u5f84/etc/samba/smb.conf\u3002\u7528\u4ee5\u4e0b\u547d\u4ee4\u627e\u5230\uff1a</p> <pre><code>sudo vi /etc/samba/smb.conf\n</code></pre> <p>\u6dfb\u52a0\u4ee5\u4e0b\u547d\u4ee4\uff0c\u4fdd\u5b58\u540e\u91cd\u542f\u3002</p> <pre><code>    server multi channel support = yes\n    aio read size = 1\n    aio write size = 1\n</code></pre>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/DSM/%E7%BE%A4%E6%99%96NAS%E4%BD%BF%E7%94%A8SMB3%20MUTI%20CHANNEL%E5%8A%A0%E5%BF%AB%E4%BC%A0%E8%BE%93%E9%80%9F%E5%BA%A6/#step2","title":"STEP2","text":"<p>\u7fa4\u6656\u63a7\u5236\u53f0WEB\u754c\u9762\uff0c\u63a7\u5236\u9762\u677f\u2013\u6587\u4ef6\u5171\u4eab\u2013\u6587\u4ef6\u670d\u52a1\u2013\u9ad8\u7ea7\u8bbe\u7f6e\uff1a \u6700\u5927SMB\u534f\u8bae\uff1aSMB3 \u6700\u5c0fSMB\u534f\u8bae\uff1aSMB2\u548cLarge MTU \u8bbe\u7f6e\u5b8c\u6bd5\uff0c\u70b9\u5e94\u7528\u3002\u7136\u540e\u8bbe\u7f6e\u5c31\u5b8c\u6210\u3002 </p>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/DSM/%E7%BE%A4%E6%99%96NAS%E4%BD%BF%E7%94%A8SMB3%20MUTI%20CHANNEL%E5%8A%A0%E5%BF%AB%E4%BC%A0%E8%BE%93%E9%80%9F%E5%BA%A6/#step3","title":"STEP3 \u9a8c\u8bc1","text":"<p>\u4ee5\u7ba1\u7406\u5458\u8eab\u4efd\u542f\u52a8CMD\uff0c\u7136\u540e\u5728\u91cc\u9762\u8f93\u5165,\u770b\u5230\u53cc\u901a\u9053\u8bf4\u660e\u6210\u529f</p> <pre><code>PowerShell\nGet-SmbMultichannelConnection\n\n</code></pre> <p>\u770b\u5230\u4ee5\u4e0a\u663e\u793a\u8bf4\u660e\u5df2\u7ecf\u8bbe\u7f6e\u6210\u529f\u3002\u5c1d\u8bd5\u590d\u5236NAS\u6587\u4ef6\u3002</p> <p>windows11\u7f51\u5361-\u300b\u9ad8\u7ea7</p> <pre><code>RSS\u961f\u5217\u7684\u6700\u5927\u6570\u76ee    16\n\u6d41\u91cf\u63a7\u5236            \u7981\u7528\n\u4f20\u8f93\u7f13\u51b2\u533a           4096\n\u63a5\u6536\u7f13\u51b2\u533a           4096\n\n</code></pre>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/PVE/ARPL%E7%BC%96%E8%AF%91SA6400%E5%BC%95%E5%AF%BC%E6%95%99%E7%A8%8B/","title":"\u5173\u4e8e\u9ed1\u7fa4\u6656\u4f7f\u752811\u4ee3CPU\u5f00\u542f\u6838\u663e\u786c\u89e3\u90a3\u4e9b\u4e8b\uff08\u4f7f\u7528ARPL\u5f00\u542f\u7f16\u8bd1SA6400\u5f15\u5bfc\u7684\u6559\u7a0b\uff09","text":"<p>2023\u5e742\u670823\u65e5 48\u6761\u8bc4\u8bba 13.59k\u6b21\u9605\u8bfb 7\u4eba\u70b9\u8d5e \u535a\u4e3b</p> <p>\u200b    \u5927\u591a\u73a9\u9ed1\u7fa4\u7684\u4eba\u90fd\u77e5\u9053\uff0c\u76ee\u524d\u7531\u4e8e\u7fa4\u6656\u5185\u6838\u7248\u672c\u4f4e\u7684\u539f\u56e0\uff0c\u65e0\u6cd5\u4f7f\u752811\u4ee3\u621611\u4ee3\u4ee5\u4e0aCPU\u5f00\u542f\u6838\u663e\u786c\u89e3\uff0c\u76f4\u5230\u4e0a\u5468\u5728B\u7ad9\u6709UP\u4e3b\u53d1\u5e03\u4e8611\u4ee3CPU\u5f00\u542f\u7fa4\u6656\u786c\u89e3\u7684\u89c6\u9891\uff0c\u4e8e\u662f\u6709\u5f88\u591a\u5c0f\u4f19\u4f34\u5c31\u8054\u7cfb\u535a\u4e3b\uff1a\u80fd\u4e0d\u80fd\u505a\u4e2a\u5f15\u5bfc\u3001\u80fd\u4e0d\u80fd\u5199\u4e2a\u6559\u7a0b\u4e4b\u7c7b\uff0c\u90a3\u535a\u4e3b\u4eca\u5929\u5c31\u6765\u804a\u804a\u4e00\u4e0b\u9ed1\u7fa4\u6656\u4f7f\u752811\u4ee3CPU\u5f00\u542f\u6838\u663e\u786c\u89e3\u90a3\u4e9b\u4e8b\u4ee5\u53ca\u987a\u4fbf\u5199\u4e2a\u6559\u7a0b\u5427\u3002</p> <p>\u200b    \u9ed1\u7fa4\u6656\u4f7f\u752811\u4ee3CPU\u5f00\u542f\u6838\u663e\u786c\u89e3\u7684\u539f\u7406\uff1a\u7531\u4e8e\u4e4b\u524d\u6211\u4eec\u4f7f\u7528\u5230\u7684DS3615/DS3617/DS918/DS920/DVA3221/DS1622/DS920\u7b49\u9ed1\u7fa4\u7cfb\u7edf\uff0c\u8fd9\u4e9b\u7cfb\u7edf\u5185\u6838\u7248\u672c\u6700\u9ad8\u624d\u662f4.4\uff0c\u800cIntel11\u4ee3\u7684CPU\u8981\u6c42Linux\u5185\u6838\u7248\u672c\u5fc5\u987b\u57285.10\u4ee5\u4e0a\u624d\u53ef\u4ee5\u9a71\u52a8\u6838\u663e\u5f00\u542f\u786c\u89e3\uff0c\u4e8e\u662f\u5927\u4f6c\u4eec\u53c8\u201c\u521b\u9020\u201d\u4e86\u4e00\u4e2a\u65b0\u7684\u9ed1\u7fa4\u7cfb\u7edfSA6400\uff0c\u5185\u6838\u7248\u672c\u662f5.10\uff0c\u521a\u597d\u53ef\u4ee5\u9a71\u52a811\u4ee3\u7684GPU\u5f00\u542f\u786c\u89e3\u3002\u4f46\u662f\u76ee\u524dSA6400\u8fd8\u5728\u5b8c\u5584\u7684\u9636\u6bb5\uff0c\u8fd8\u6709\u8bb8\u591a\u4e0d\u8db3\u4e4b\u5904\uff08\u6bd4\u5982\uff1a\u9700\u8981\u4f7f\u7528PVE\u865a\u62df\u673a\u6a21\u62dfU\u76d8\u542f\u52a8\u3001\u4e0d\u652f\u6301SATA\u542f\u52a8\u3001\u7f51\u5361\u9a71\u52a8\u652f\u6301\u4e0d\u591a\u7b49\u7b49\uff09\uff0c\u6240\u4ee5\u4e0d\u80fd\u5927\u8303\u56f4\u7684\u5b89\u88c5\u548c\u4f7f\u7528\uff0c\u76ee\u524d\u4ec5\u4f9b\u52a8\u624b\u5f3a\u529b\u8f83\u7684\u4eba\u5148\u73a9\u73a9\u3002</p> <p>\u200b    \u6210\u54c1\u7684SA6400\u5f15\u5bfc\u6587\u4ef6\u6211\u5c31\u4e0d\u653e\u51fa\u6765\u4e0b\u8f7d\u4e86\uff0c\u5982\u679c\u611f\u5174\u8da3\u7684\u8bdd\u53ef\u4ee5\u7ee7\u7eed\u770b\u4e0b\u9762\u7f16\u8bd1SA6400\u5f15\u5bfc\u7684\u6559\u7a0b\uff1a</p> <p>1\u3001\u53bb\u3010ARPL\u7684\u4ed3\u5e93\u3011\u4e0b\u8f7dARPL\u6700\u65b0\u7248\u672c\uff08\u622a\u6b622023\u5e742\u670823\u65e5\uff0cARPL\u7684\u6700\u65b0\u7248\u672c\u4e3av1.1-bate2\uff09\uff0c\u5982\u679c\u4e0d\u4f1a\uff0c\u5efa\u8bae\u5148\u5b66\u4e60\u300a\u9ed1\u7fa4\u6656DSM7.X\u5f15\u5bfc\u7528arpl\u7f16\u8bd1\u6559\u7a0b\u300b\uff1b</p> <p>2\u3001\u4f7f\u7528U\u76d8\u5237\u5165ARPL\u5f15\u5bfc\u6587\u4ef6\uff0c\u5728PVE\u5efa\u7acb\u865a\u62df\u673a\u4f7f\u7528\u6a21\u62dfU\u76d8\u542f\u52a8\uff0c\u4f7f\u7528\u6a21\u62dfU\u76d8\u542f\u52a8\u9700\u8981\u8bbe\u7f6e\uff1a\u673a\u578b\u8bbe\u7f6e\u4e3a q35\u3001\u542f\u52a8\u65b9\u5f0f\u4f7f\u7528UEFI\u65b9\u5f0f\uff0c\u7f16\u8f91<code>/etc/pve/qemu-server/SA6400\u865a\u62df\u673a\u7684id.conf</code> \uff0c\u5728\u6587\u4ef6\u6dfb\u52a0\u4e0b\u9762\u5185\u5bb9\uff08\u6ce8\u610f\uff1a\u9700\u8981\u81ea\u884c\u66ff\u6362arpl.img\u6587\u4ef6\u7684\u8def\u5f84\uff09:</p> <pre><code>args: -device 'nec-usb-xhci,id=usb-bus0,multifunction=on' -drive 'file=/var/lib/vz/template/iso/arpl.img,media=disk,format=raw,if=none,id=drive-disk-bootloader' -device 'usb-storage,bus=usb-bus0.0,port=1,drive=drive-disk-bootloader,id=usb-disk-bootloader,bootindex=999,removable=on'\n</code></pre> <p>3\u3001\u542f\u52a8\u540e\u8bb0\u5f55\u4e00\u4e0bIP\u5730\u5740\u4ee5\u53caroot\u7684\u5bc6\u7801\uff0c\u5982\u4e0b\u56fe\u4e24\u5904\uff1a</p> <p></p> <p>4\u3001\u5728\u7535\u8111\u4e0a\u6253\u5f00SSH\u5de5\u5177\uff0c\u6211\u4f7f\u7528\u7684\u662fMobaXterm\uff0c\u586b\u5199\u4e0a\u4e00\u6b65\u9aa4\u83b7\u53d6\u5230\u7684IP\u5730\u5740\uff0c\u7528\u6237\u540d\u4e3aroot\uff0c\u7aef\u53e322\uff0c\u767b\u5f55\uff1b</p> <p>5\u3001\u8f93\u5165\u5bc6\u7801Redp1lL-1s-4weSomE\u767b\u5f55\u5230\u5982\u4e0b\u754c\u9762\uff1b</p> <p>6\u3001\u7531\u4e8eSA6400\u8fd8\u5728\u6d4b\u8bd5\u9636\u6bb5\uff0c\u9ed8\u8ba4ARPL\u4e0d\u663e\u793a\u8be5\u578b\u53f7\uff0c\u6240\u4ee5\u9700\u8981\u9b54\u6539\u4e00\u4e0b\uff0c\u590d\u5236\u4ee5\u4e0b\u4ee3\u7801\u5230SSH\u7684\u7a97\u53e3\u4e0b\u7c98\u8d34\uff0c\u6572\u56de\u8f66\u8fd0\u884c\uff08\u5c06\u6765SA6400\u7cfb\u7edf\u5f00\u53d1\u6210\u719f\u4ee5\u540e\uff0cARPL\u80fd\u76f4\u63a5\u6709\u663e\u793aSA6400\u7684\u8bdd\uff0c\u6b64\u6b65\u9aa4\u5c31\u4e0d\u9700\u8981\u505a\u4e86\uff09\uff1b</p> <pre><code>curl -skL https://raw.githubusercontent.com/wjz304/Redpill_CustomBuild/main/arpl-sa6400.sh | bash\n</code></pre> <p></p> <p>7\u3001\u663e\u793a\u6709\u201cOpening... SA6400 is exist!\u201d\u5b57\u6837\u7684\u65f6\u5019\u5c31\u8868\u793aOk\u4e86\uff0c\u5982\u679c\u957f\u65f6\u95f4\u5361\u4f4f\u6ca1\u6709\u8f93\u51fa\u4fe1\u606f\u7684\u8bdd\u8bf7\u91cd\u65b0\u6253\u5f00SSH\u5de5\u5177\u91cd\u65b0\u505a\u4e00\u6b21\uff1b</p> <p>9\u3001\u5728\u7535\u8111\u6d4f\u89c8\u5668\u6253\u5f00\u7b2c3\u6b65\u83b7\u53d6\u5230\u7684IP\u5730\u5740\uff0c\u540e\u9762\u52a0:7681\uff0c\u56de\u8f66\uff0c\u8fdb\u5165ARPL\u7f16\u8bd1\u83dc\u5355\uff0c\u5728\u7b2c\u4e00\u884c\u201cChoose a model\u201d\u5904\u56de\u8f66\uff1b</p> <p>10\u3001\u5728\u201cShow bate models\u201d\u5904\u56de\u8f66\uff1b</p> <p>11\u3001\u6b64\u65f6\u7f16\u8bd1\u7cfb\u7edf\u5c31\u80fd\u770b\u5230\u6709SA6400\u8fd9\u4e2a\u578b\u53f7\u51fa\u6765\u4e86\uff1b</p> <p>12\u3001\u53c2\u8003\u300a\u9ed1\u7fa4\u6656DSM7.X\u5f15\u5bfc\u7528arpl\u7f16\u8bd1\u6559\u7a0b\u300b\u540e\u7eed\u7684\u6559\u7a0b\uff0c\u7ee7\u7eed\u64cd\u4f5c\u3002</p>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/PVE/PVE%20%E5%AE%89%E8%A3%85%E6%AD%A5%E9%AA%A4/","title":"\u5728 PVE 7 \u4e2d\u542f\u7528\u786c\u4ef6\u76f4\u901a\u529f\u80fd","text":""},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/PVE/PVE%20%E5%AE%89%E8%A3%85%E6%AD%A5%E9%AA%A4/#rdm","title":"\u4e00\uff1aRDM\u78c1\u76d8\u76f4\u901a","text":"<p>RDM\u78c1\u76d8\u76f4\u901a\uff0c\u4e0d\u9700\u8981\u5f00\u542fiommu\u3002\u53ea\u80fd\u5728PVE\u547d\u4ee4\u884c\u4e2d\u6dfb\u52a0\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4e0b\u9762\u547d\u4ee4\uff0c\u5217\u51fa\u5f53\u524d\u7684\u786c\u76d8\u5217\u8868</p> <pre><code>ls -la /dev/disk/by-id/|grep -v dm|grep -v lvm|grep -v part\n</code></pre> <p>nvme\u5f00\u5934\u7684\u662fnvme\u786c\u76d8\uff0cata\u5f00\u5934\u662f\u8d70sata\u6216\u8005ata\u901a\u9053\u7684\u8bbe\u5907\u3002\uff0cscsi\u662fscsi\u8bbe\u5907-\u9635\u5217\u5361raid\u6216\u8005\u662f\u76f4\u901a\u5361\u4e0a\u7684\u786c\u76d8\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7<code>qm set &lt;vmid&gt; --scsiX /dev/disk/by-id/xxxxxxx</code> \u8fdb\u884cRDM\u76f4\u901a</p> <p>\u4f8b\u5982\u4f60\u6709\u4e00\u4e2a\u865a\u62df\u673a\uff0c\u865a\u62df\u673a\u7684vmid\u662f101\uff0c--scsiX\uff0c\u8fd9\u91cc\u7684X\u662f\u6574\u6570\uff0c\u6700\u591a\u4e3a\u5982\u679c\u4f60\u4e0d\u6e05\u695avmid\u8fd9\u4e2a\u662f\u4ec0\u4e48\u542b\u4e49\uff0c\u4f60\u53ef\u4ee5\u53c2\u8003\u4e0b\u9762\u6587\u7ae0</p> <p>\u8ba4\u8bc6\u865a\u62df\u673aVMID\u7684\u4f5c\u7528</p> <p>\u5f53\u7136\uff0c\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528ide\u6216\u8005sata\u5f62\u5f0f\u76f4\u901a\u786c\u76d8\uff0c\u5982\u4e0b</p> <pre><code>qm set 101 --sata1 /dev/disk/by-id/ata-WUH721818ALE6L4_3FG4RRST \nqm set 101 --sata2 /dev/disk/by-id/ata-WDC_WUH721818ALE6L4_3RHDMVMA \n</code></pre> <p>\u542f\u7528IOMMU\u529f\u80fd</p> <p>\u7528\u7f51\u9875\u7aef\u7684 PVE shell \u6216 ssh \u8fde\u63a5\u81f3 PVE\uff0c\u8f93\u5165\u4ee5\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>nano /etc/default/grub\n</code></pre> <p>\u5728\u6587\u6863\u4e2d\u627e\u5230 \u201cGRUB_CMDLINE_LINUX_DEFAULT=\u201dquiet\u201d\u201d\u4e00\u884c\uff0c</p> <p>\u5bf9\u4e8e Intel CPU \u7528\u6237\uff0c\u5c06\u6539\u884c\u4fee\u6539\u4e3a\uff1a</p> <pre><code>GRUB_CMDLINE_LINUX_DEFAULT=\"quiet intel_iommu=on iommu=pt\"\n</code></pre> <p>\u4fee\u6539\u5b8c\u6210\u540e\uff0c\u6309 Ctrl+O \u4fdd\u5b58\uff0c\u6309 Ctrl+X \u9000\u51fa\u6587\u672c\u7f16\u8f91\u5668\u3002</p> <p>\u7136\u540e\u8f93\u5165\u4e0b\u4e00\u884c\u547d\u4ee4\u66f4\u65b0 Grub\uff1a</p> <pre><code>update-grub\n</code></pre> <p>\u52a0\u8f7d\u76f8\u5e94\u7684\u5185\u6838\u6a21\u5757</p> <p>\u5728\u547d\u4ee4\u884c\u4e2d\u8f93\u5165\u4ee5\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>echo vfio &gt;&gt; /etc/modules\necho vfio_iommu_type1 &gt;&gt; /etc/modules\necho vfio_pci &gt;&gt; /etc/modules\necho vfio_virqfd &gt;&gt; /etc/modules\n</code></pre> <p>\u7136\u540e\u8f93\u5165</p> <pre><code>update-initramfs -k all -u\n</code></pre> <p>\u6765\u66f4\u65b0\u5185\u6838\u53c2\u6570\u3002\u7136\u540e\u91cd\u542f PVE\u3002</p> <p>\u9a8c\u8bc1IOMMU\u662f\u5426\u5f00\u542f\u6210\u529f</p> <p>\u91cd\u542f\u4e4b\u540e\uff0c\u5728\u547d\u4ee4\u884c\u8f93\u5165\u4ee5\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>dmesg | grep iommu\n</code></pre> <p>\u82e5\u6709\u5982\u7c7b\u4f3c\u4e8e\u4e0b\u56fe\u56de\u663e\uff0c\u5219\u8bf4\u660e\u5f00\u542f\u6210\u529f\uff1a</p> <p></p> <p>\u518d\u8f93\u5165\uff1a</p> <pre><code>find /sys/kernel/iommu_groups/ -type l\n</code></pre> <p>\u5982\u679c\u6709\u7c7b\u4f3c\u4e8e\u4e0b\u56fe\u56de\u663e\uff0c\u5c31\u4ee3\u8868\u6210\u529f\uff1a</p> <p></p>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/PVE/PVE%E5%AE%89%E8%A3%85openwrt/","title":"PVE\u5b89\u88c5openwrt","text":""},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/PVE/PVE%E5%AE%89%E8%A3%85openwrt/#pveopenwrt","title":"PVE\u5b89\u88c5openwrt","text":"<p>\u4e0a\u4f20img\u955c\u50cf\u6587\u4ef6\uff0c\u4fdd\u6301\u4e0a\u4f20\u5730\u5740</p> <pre><code>/var/lib/vz/template/iso/istoreos-21.02.3-2023040712-x86-64-squashfs-combined-efi.img\n</code></pre> <p>3. \u5bfc\u5165\u955c\u50cf</p> <p>\u9009\u62e9\u5bbf\u4e3b\u673a\uff0c\u8fdb\u5165\u547d\u4ee4\u884c</p> <pre><code>qm importdisk 100 /var/lib/vz/template/iso/istoreos-21.02.3-2023040712-x86-64-squashfs-combined-efi.img local-lvm\n</code></pre> <p>\u6ce8\u610f VM ID 100 (100\u662f \u865a\u62df\u673a ID) \u548c\u8def\u5f84 \u4ee5\u53ca\u955c\u50cf\u540d\u79f0 , \u6700\u540e\u53c8 local-lvm</p>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/PVE/PVE%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96-%E6%A0%B8%E6%98%BE%E8%BD%AC%E7%A0%81/","title":"PVE\u5b89\u88c5\u7fa4\u6656 \u6838\u663e\u8f6c\u7801","text":""},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/PVE/PVE%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96-%E6%A0%B8%E6%98%BE%E8%BD%AC%E7%A0%81/#pve-","title":"PVE\u5b89\u88c5\u7fa4\u6656-\u6838\u663e\u8f6c\u7801","text":""},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/PVE/PVE%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96-%E6%A0%B8%E6%98%BE%E8%BD%AC%E7%A0%81/#arpl","title":"\u4e0a\u4f20arpl\u955c\u50cf\uff0c\u590d\u5236\u5e76\u8bb0\u5f55\u6587\u4ef6\u8def\u5f84\u3002","text":"<pre><code>/var/lib/vz/template/iso/arpl.img\n</code></pre>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/PVE/PVE%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96-%E6%A0%B8%E6%98%BE%E8%BD%AC%E7%A0%81/#_1","title":"\u521b\u5efa\u865a\u62df\u673a","text":"<pre><code>\u5e38\u89c4\n  \u540d\u79f0\uff1aSA6400\n\u64cd\u4f5c\u7cfb\u7edf\n  \u5149\u9a71\uff1a\u4e0d\u4f7f\u7528\u4efb\u4f55\u4ecb\u8d28\n\u7cfb\u7edf\n  \u663e\u5361\uff1a\u65e0      \u673a\u578b\uff1aq35      BIOS\uff1aWVMF(UEFI)\n\u78c1\u76d8\n  \u603b\u7ebf/\u8bbe\u5907\uff1aSATA\n  \u78c1\u76d8\u5927\u5c0f(GiB): 100 #\u5efa\u8bae\u5927\u5c0f\nCPU\n  \u6838\u5fc3\uff1a4      \u7c7b\u522b\uff1ahost\n\u5185\u5b58\n  \u5185\u5b58(MiB): 8192\n\u7f51\u7edc\uff1a \u65e0\u7f51\u7edc\u8bbe\u5907\n</code></pre>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/PVE/PVE%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96-%E6%A0%B8%E6%98%BE%E8%BD%AC%E7%A0%81/#_2","title":"\u7f16\u8f91\u865a\u62df\u673a","text":"<p>\u786c\u4ef6/BIOS/\u6539\u4e3aUEFI</p> <p>\u6dfb\u52a0\u786c\u76d8\u76f4\u901a\u8bbe\u5907\uff0c\u9ed8\u8ba4\u914d\u7f6e\u5982\u4e0b\uff1aSATA controller: JMicron Technology Corp. JMB58x AHCI SATA controller~</p> <pre><code>\u8bbe\u5907\uff1a0000:01:00.0\n\u6240\u6709\u529f\u80fd\uff1a \u662f      \u4e3bGPU\uff1a\u5426\nROM-Bar: \u662f      PCI-Express: \u662f\n</code></pre> <p>\u6dfb\u52a0\u6838\u663e\u76f4\u901a\u8bbe\u5907\uff0c\u9ed8\u8ba4\u914d\u7f6e\u5982\u4e0b\uff1a</p> <pre><code>\u8bbe\u5907\uff1a0000:00:02.0\n\u6240\u6709\u529f\u80fd\uff1a true   \u4e3bGPU\uff1atrue\nROM-Bar: false  PCI-Express: true\n</code></pre> <p>\u6dfb\u52a0\u7f51\u5361\u76f4\u901a\u8bbe\u5907\uff0c\u9ed8\u8ba4\u914d\u7f6e\u5982\u4e0b\uff1a</p> <pre><code>\u8bbe\u5907\uff1a0000:02:00.0     \u53c2\u6570\u9ed8\u8ba4\n</code></pre> <p>\u6dfb\u52a0NVME\u76f4\u901a\u8bbe\u5907\uff0c\u9ed8\u8ba4\u914d\u7f6e\u5982\u4e0b\uff1a</p> <pre><code>\u8bbe\u5907\uff1a0000:05:00.0     \u53c2\u6570\u9ed8\u8ba4\n\u8bbe\u5907\uff1a0000:06:00.0     \u53c2\u6570\u9ed8\u8ba4\n</code></pre> <p>\u6dfb\u52a0\u4e32\u884c\u7aef\u53e3:</p> <pre><code>\u4e32\u884c\u7aef\u53e3: 0\n</code></pre> <p>\u5220\u9664\u65e0\u7528\u8bbe\u5907\uff0c\u5982\u5149\u9a71/\u865a\u62df\u7f51\u5361</p> <p>\u914d\u7f6e\u9009\u9879</p> <pre><code>\u5f00\u542f\u81ea\u542f\u52a8\uff1a\u662f\n\u5f15\u5bfc\u987a\u5e8f\uff1asata0\n</code></pre> <p>\u6dfb\u52a0RDM\u76f4\u901a</p> <pre><code>qm set 100 -sata1 /dev/disk/by-id/XXX\nqm set 100 -sata2 /dev/disk/by-id/XXX\n</code></pre>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/PVE/PVE%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96-%E6%A0%B8%E6%98%BE%E8%BD%AC%E7%A0%81/#_3","title":"\u8f93\u5165\u547d\u4ee4","text":"<p>\u9009\u62e9\u5bbf\u4e3b\u673a/Shell\uff0c\u8f93\u5165\u4ee5\u4e0b\u547d\u4ee4\uff08\u6ce8\u610f\u865a\u62df\u673aID\uff09</p> <pre><code>nano /etc/pve/qemu-server/101.conf\n</code></pre> <pre><code># \u5728\u9996\u884c\u6dfb\u52a0\u4ee5\u4e0b\u4ee3\u7801\nargs: -device 'nec-usb-xhci,id=usb-bus0,multifunction=on' -drive 'file=/var/lib/vz/template/iso/arpl.img,media=disk,format=raw,if=none,id=drive-disk-bootloader' -device 'usb-storage,bus=usb-bus0.0,port=1,drive=drive-disk-bootloader,id=usb-disk-bootloader,bootindex=999,removable=on'\n</code></pre>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/PVE/PVE%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96-%E6%A0%B8%E6%98%BE%E8%BD%AC%E7%A0%81/#_4","title":"\u5b89\u88c5\u7fa4\u6656","text":"<p>\u542f\u52a8\u865a\u62df\u673a\uff0c\u6253\u5f00\u63a7\u5236\u53f0/xterm.js.</p> <p>\u542f\u52a8\u5b8c\u6210\uff0c\u8f93\u5165root\u514d\u5bc6\u767b\u5f55\u3002\u8f93\u5165ip a\u67e5\u770bip\u5730\u5740\u3002</p> <p>\u6253\u5f00\u6d4f\u89c8\u5668\uff0c\u8f93\u5165 IP:7681\u8fdb\u5165\u8bbe\u7f6e\u83dc\u5355\u3002</p> <p>\u9009\u62e9\uff1a\u6784\u5efa\u5f15\u5bfc\uff0c \u542f\u52a8\u5f15\u5bfc\u3002</p> <p>\u91cd\u542f\u5b8c\u6210\u540e\uff0c\u76f4\u63a5\u8bbf\u95eeIP\u3002</p> <p>\u4e0a\u4f20pat\u6587\u4ef6\uff0c\u7b49\u5f85\u91cd\u542f\u3002</p>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/PVE/PVE%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96-%E6%A0%B8%E6%98%BE%E8%BD%AC%E7%A0%81/#_5","title":"\u914d\u7f6e\u7fa4\u6656","text":"<p>\u521b\u5efa\u5b58\u50a8\u6c60</p> <p>\u63a7\u5236\u9762\u677f/\u5171\u4eab\u6587\u4ef6\u5939 /\u521b\u5efa/\u540d\u79f0\uff1ashare</p> <pre><code>\u6587\u4ef6\u7ba1\u7406/\u5c5e\u6027/\u6743\u9650/\u65b0\u589e\uff1a  \u7528\u6237\u6216\u7ec4\uff1aEveryone   \u8bfb\u53d6\u548c\u5199\u5165\u6743\u9650\uff1b\u5e94\u7528\u5230\u8fd9\u4e2a\u6587\u4ef6\u5939/\u5b50\u6587\u4ef6\u5939\u53ca\u6587\u4ef6\u3002\n</code></pre> <p>\u63a7\u5236\u9762\u677f/\u6587\u4ef6\u670d\u52a1\uff1a\u542f\u7528NFS\u670d\u52a1\uff0c\u534f\u8baeNFSv4.1</p> <p>\u5b89\u88c5docker\u5957\u4ef6</p> <p>\u5f00\u542f\u5e76\u767b\u5f55ssh\uff0c\u9a8c\u8bc1\u786c\u89e3</p> <pre><code>ls -l /dev/dri\n</code></pre> <pre><code>card0\nrenderD128\n</code></pre>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/PVE/PVE%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96-%E6%A0%B8%E6%98%BE%E8%BD%AC%E7%A0%81/#_6","title":"\u9644\u5f55","text":""},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/PVE/PVE%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96-%E6%A0%B8%E6%98%BE%E8%BD%AC%E7%A0%81/#1","title":"1. \u955c\u50cf\u4e0b\u8f7d\u5730\u5740","text":"<p>\u94fe\u63a5: https://pan.baidu.com/s/1Qz6nrsJWFXzO75LQso7ItA?pwd=3333 \u63d0\u53d6\u7801: 3333</p> <p>\u56fd\u5916\u5206\u6d41\uff1ahttps://ttttt.link/f/64182de86e818</p>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/PVE/PVE%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96-%E6%A0%B8%E6%98%BE%E8%BD%AC%E7%A0%81/#2","title":"2. \u7cfb\u7edf\u4e0b\u8f7d\u5730\u5740","text":"<p>https://cndl.synology.cn/download/DSM/release/7.1.1/42962-4/DSM_SA6400_42962.pat</p>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/PVE/PVE%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87-pve%E8%BD%AF%E4%BB%B6%E6%8D%A2%E6%BA%90/","title":"PVE\u865a\u62df\u673a\u7bc7-pve\u8f6f\u4ef6\u6362\u6e90","text":"<p>\u66f4\u65b0\u8f6f\u4ef6\u6e90\u65b9\u6cd5</p> <pre><code># \u6ce8\u91ca\u4f01\u4e1a\u6e90\necho \"#deb https://enterprise.proxmox.com/debian/pve bullseye pve-enterprise\" &gt; /etc/apt/sources.list.d/pve-enterprise.list\n\n# PVE \u8f6f\u4ef6\u6e90\u66f4\u6362\nwget https://mirrors.ustc.edu.cn/proxmox/debian/proxmox-release-bullseye.gpg -O /etc/apt/trusted.gpg.d/proxmox-release-bullseye.gpg\n\necho \"deb https://mirrors.ustc.edu.cn/proxmox/debian/pve bullseye pve-no-subscription\" &gt; /etc/apt/sources.list.d/pve-no-subscription.list\n\necho \"deb https://mirrors.ustc.edu.cn/proxmox/debian/ceph-pacific bullseye main\" &gt; /etc/apt/sources.list.d/ceph.list\n\nsed -i.bak \"s#http://download.proxmox.com/debian#https://mirrors.ustc.edu.cn/proxmox/debian#g\" /usr/share/perl5/PVE/CLI/pveceph.pm\n\n# Debian \u7cfb\u7edf\u6e90\u66f4\u6362\nsed -i.bak \"s#ftp.debian.org/debian#mirrors.aliyun.com/debian#g\" /etc/apt/sources.list\nsed -i \"s#security.debian.org#mirrors.aliyun.com/debian-security#g\" /etc/apt/sources.list\necho \"deb http://download.proxmox.com/debian/pve bullseye pve-no-subscription\" &gt;&gt;  /etc/apt/sources.list\n\n# \u66f4\u65b0\u6d4b\u8bd5\u4e00\u4e0b\n\napt update\n\n</code></pre>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/debian/Debian%E5%AE%89%E8%A3%85%E6%8C%87%E5%8D%97/","title":"Debian\u5b89\u88c5\u6307\u5357","text":""},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/debian/Debian%E5%AE%89%E8%A3%85%E6%8C%87%E5%8D%97/#_1","title":"\u66f4\u6539\u8bed\u8a00\u73af\u5883","text":"<p>\u8f93\u51fa\u4e71\u7801\uff0c\u9700\u4fee\u6539\u914d\u7f6e\u6587\u4ef6</p> <pre><code>vi .bashrc\n\n# \u6700\u4e0b\u9762\u589e\u52a0\nexport LANG=C\n</code></pre> <p>\u4fdd\u5b58\u9000\u51fa\u5373\u53ef\u3002\u5982\u9700\u7acb\u5373\u751f\u6548\uff0c\u8f93\u5165\u4ee5\u4e0b\u547d\u4ee4</p> <pre><code>source .bashrc\n</code></pre>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/debian/Debian%E5%AE%89%E8%A3%85%E6%8C%87%E5%8D%97/#_2","title":"\u914d\u7f6e\u7f51\u7edc","text":"<p>\u4e00\u3001\u5bf9\u4e8e\u6709\u7ebf\u7f51\u7edc\uff0c\u5982\u679c\u9ed8\u8ba4\u6ca1\u6709\u5b89\u88c5\u56fe\u5f62\u754c\u9762\uff0c\u8fdb\u5165\u4e86 multi-user.target\u4e2d\u65f6\uff0c\u662f\u6ca1\u6709\u4f7f\u7528NetworkManager\u7ba1\u7406\u7f51\u7edc\u7684\uff0c\u6b64\u65f6\u9700\u8981\u624b\u52a8\u914d\u7f6e\u624d\u80fd\u4e0a\u7f51 \u9996\u5148\u5f97\u5230\u7f51\u5361\u540d\u79f0\uff1aip addr or ls /sys/class/net/\uff0c\u4ee5\u4e0b\u5047\u8bbe\u7f51\u5361\u540d\u4e3aeth0\uff0c\u5b9e\u9645\u4e2d\u5e94\u66ff\u6362\u4e3a\u81ea\u5df1\u5b9e\u9645\u7684\u540d\u79f0\u3002</p> <p>\u8bbe\u7f6e\u6587\u4ef6\u4e3a\uff1a/etc/network/interfaces \u4f7f\u7528DHCP\u65b9\u5f0f\uff0c\u5728\u6587\u4ef6\u5e95\u90e8\u6dfb\u52a0\uff1a</p> <pre><code>auto eth0\nallow-hotplug eth0\niface eth0 inet dhcp\n</code></pre> <p>\u624b\u52a8\u8bbe\u7f6eIP\u4e0a\u7f51\uff0c\u5728\u6587\u4ef6\u5e95\u90e8\u6dfb\u52a0\uff1a</p> <pre><code>auto eth0\niface eth0 inet static\n    address 192.168.0.7\n    netmask 255.255.255.0\n    gateway 192.168.0.254\n</code></pre> <p>\u91cd\u542f\u7f51\u7edc\u670d\u52a1sudo systemctl restart networking.service \u8be6\u7ec6\u7684\u8bbe\u7f6e\u65b9\u6cd5\u53ef\u4ee5\u4f7f\u7528man interfaces\u5f97\u5230 \u4e5f\u53ef\u4ee5\u53c2\u8003\u8fd9\u91cc\uff1ahttps://wiki.debian.org/NetworkConfiguration</p>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/debian/Debian%E5%AE%89%E8%A3%85%E6%8C%87%E5%8D%97/#debian11","title":"Debian11\u66f4\u6362\u963f\u91cc\u6e90","text":"<p>\u5907\u4efd\u6e90\u6587\u4ef6</p> <p>cp /etc/apt/sources.list /etc/apt/sources.list_backup \u7f16\u8f91\u6e90\u6587\u4ef6</p> <pre><code>vi /etc/apt/sources.list \n\n#\u6dfb\u52a0\u5982\u4e0b\ndeb http://mirrors.aliyun.com/debian/ bullseye main non-free contrib\ndeb-src http://mirrors.aliyun.com/debian/ bullseye main non-free contrib\ndeb http://mirrors.aliyun.com/debian-security/ bullseye-security main\ndeb-src http://mirrors.aliyun.com/debian-security/ bullseye-security main\ndeb http://mirrors.aliyun.com/debian/ bullseye-updates main non-free contrib\ndeb-src http://mirrors.aliyun.com/debian/ bullseye-updates main non-free contrib\ndeb http://mirrors.aliyun.com/debian/ bullseye-backports main non-free contrib\ndeb-src http://mirrors.aliyun.com/debian/ bullseye-backports main non-free contrib\n</code></pre>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/debian/Debian%E5%AE%89%E8%A3%85%E6%8C%87%E5%8D%97/#_3","title":"\u7136\u540e","text":"<pre><code>apt-get update\n</code></pre>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/debian/Debian%E5%AE%89%E8%A3%85%E6%8C%87%E5%8D%97/#_4","title":"\u5347\u7ea7\u5185\u6838","text":"<p>\u4e0b\u8f7d\u5185\u6838</p> <pre><code>mkdir kernel\ncd kernel\nwget http://ftp.debian.org/debian/pool/main/l/linux-signed-amd64/linux-image-6.1.0-7-amd64_6.1.20-2_amd64.deb\n</code></pre> <p>\u5347\u7ea7\u5185\u6838</p> <pre><code>dpkg -i *.deb\n</code></pre> <pre><code>apt install curl -y\n\nmkdir -p /lib/firmware/i915 &amp;&amp; cd /lib/firmware/i915\ncurl -LO https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/i915/ehl_guc_70.1.1.bin\ncurl -LO https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/i915/ehl_huc_9.0.0.bin\ncurl -LO https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/i915/icl_dmc_ver1_09.bin\n\n#\u5907\u7528\u4e0b\u8f7d\u5730\u5740\uff1ahttps://anduin.linuxfromscratch.org/sources/linux-firmware/i915/\n</code></pre> <p>\u5f00\u542f\u6838\u663e\u4f4e\u529f\u8017\u7f16\u7801</p> <pre><code>nano /etc/modprobe.d/i915.conf\n-----------------------------\noptions i915 enable_guc=3\n</code></pre> <p>\u4e25\u91cd\u5f00\u542f\u6210\u529f</p> <pre><code>journalctl -b -o short-monotonic -k | egrep -i \"i915|dmr|dmc|guc|huc\"\n\n</code></pre> <p>\u6302\u8f7dnfs</p> <pre><code>10.10.10.28:/volume1/share/media /mnt/nas_nfs nfs x-systemd.automount,x-systemd.after=network-online.target 0 0\n</code></pre> <p>\u4e00\u952e\u5b89\u88c5docker</p> <pre><code>curl -sSL https://get.daocloud.io/docker | sh\n\n#\u63a5\u7740\u8bbe\u5b9adocker\u670d\u52a1\nsystemctl start docker\nsystemctl enable docker\n</code></pre>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/ubuntu/0%20ubuntu%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4/","title":"0 ubuntu\u57fa\u672c\u547d\u4ee4","text":"<pre><code># \u4fee\u6539\u4e3b\u673a\u540d\nsudo hostnamectl set-hostname plot01\n\n# \u4fee\u6539\u65f6\u533a\ntimedatectl set-timezone Asia/Shanghai\n\n# \u4fee\u6539\u56fa\u5b9aIP\u5730\u5740\ncp /etc/netplan/00-installer-config.yaml /etc/netplan/00-installer-config.yaml.bak\necho \"# This is the network config written by 'subiquity'\nnetwork:\n  ethernets:\n    ens33:\n      dhcp4: no\n      addresses: [10.10.10.29/24]\n      nameservers:\n          addresses: [114.114.114.114,8.8.8.8]\n      routes:\n        - to: default\n          via: 10.10.10.2\n  version: 2\" &gt; /etc/netplan/00-installer-config.yaml\nnetplan apply\n\n# ubuntu \u5b89\u88c5VMware tools\nsudo apt install open-vm-tools-desktop\n\n# ubuntu 22.04 \u66f4\u6362\u6e90\n/etc/apt/sources.list /etc/apt/sources.list.bak #22.04 \n/etc/apt/sources.list.d/ubuntu.sources          #24.04\n\u7528\u4e0b\u9762\u5185\u5bb9\u66ff\u6362\nhttp://mirrors.aliyun.com/ubuntu/\n\nsudo apt update\nsudo apt upgrade -y\n\n</code></pre> <pre><code>\n# \u5df2\u7ecf\u521d\u59cb\u5316\u5206\u533a\u540e\u7684Ubuntu\u7cfb\u7edf\uff0c\u5feb\u901f\u6269\u5bb9\nsudo lvextend -l +100%FREE /dev/mapper/ubuntu--vg-ubuntu--lv\nsudo resize2fs /dev/mapper/ubuntu--vg-ubuntu--lv\n\n# \u786c\u76d8\u514b\u9686\ndd if=/dev/sda of=/dev/sdb bs=4096 progress=yes\n\n# \u67e5\u770b\u786c\u76d8uuid\nlsblk -o name,uuid,size | awk -v drive=\"sda\" '$1 == drive {print $2}'\n# \u67e5\u770b\u786c\u76d8\u5e8f\u5217\u53f7\nsmartctl -a \"/dev/sda\" | grep \"Serial Number\" | awk '{print $3}'\n\n\necho \"$(blkid /dev/nvme0n1 | awk '{print $2}') /mnt/plottemp defaults 0 0\" &gt;&gt; /etc/fstab\n\n</code></pre>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/ubuntu/ubuntu%E5%AE%89%E8%A3%85vnc/","title":"Ubuntu\u5b89\u88c5vnc","text":"<pre><code>sudo apt-get update\nsudo apt-get install lightdm -y # \u663e\u793a\u7ba1\u7406\u5668\u66f4\u6539\u4e3a lightdm\nsudo reboot\n\n</code></pre> <pre><code>sudo apt-get install x11vnc\n\n\nsudo nano /lib/systemd/system/x11vnc.service\n</code></pre> <p>and copy paste in the following</p> <pre><code>[Unit]\nDescription=x11vnc service\nAfter=display-manager.service network.target syslog.target\n\n[Service]\nType=simple\nExecStart=/usr/bin/x11vnc -forever -display :0 -auth guess -passwd 522487\nExecStop=/usr/bin/killall x11vnc\nRestart=on-failure\n\n[Install]\nWantedBy=multi-user.target\n</code></pre> <pre><code>systemctl daemon-reload\nsystemctl enable x11vnc.service\nsystemctl start x11vnc.service\n\nsystemctl status x11vnc.service\n</code></pre> <p>\u8bbe\u7f6e-&gt;privacy-&gt;ScreenLock\uff0c\u5173\u95ed\u4e09\u9879\u9009\u62e9\uff1b</p> <p></p> <pre><code>roboot\n</code></pre> <p>So this isn\u2019t so secure so you might need to install something called xscreensaver.</p>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/ubuntu/ubuntu%E9%85%8D%E7%BD%AErsync%E6%9C%8D%E5%8A%A1/","title":"Ubuntu\u914d\u7f6ersync\u670d\u52a1","text":""},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/ubuntu/ubuntu%E9%85%8D%E7%BD%AErsync%E6%9C%8D%E5%8A%A1/#ubuntu2204rsync","title":"Ubuntu22.04\u914d\u7f6ersync\u670d\u52a1","text":"<pre><code># \u5b89\u88c5\nsudo apt-get install rsync\n\nsudo sed -i 's/RSYNC_ENABLE=false/RSYNC_ENABLE=true/' /etc/default/rsync\n\necho \"max connections = 2\nlog file = /var/log/rsync.log\ntimeout = 300\nCharset = UTF-8\n\n[plot] # \u6a21\u5757\u540d\ncomment = Public Share\n# path\u4e3a\u9700\u8981\u540c\u6b65\u7684\u6587\u4ef6\u5939\u8def\u5f84\npath = /mnt/plottemp\nread only = no\nlist = yes\nuid = root\ngid = root\n# \u5fc5\u987b\u548c rsyncd.secrets\u4e2d\u7684\u7528\u6237\u540d\u5bf9\u5e94\nauth users = chia\nsecrets file = /etc/rsyncd.secrets\n\"  &gt; /etc/rsyncd.conf\n\n# \u8bbe\u7f6e\u7528\u6237\u548c\u5bc6\u7801\necho \"chia:r5yncd\"  &gt; /etc/rsyncd.secrets\n\nsudo chmod 600 /etc/rsyncd.secrets\nsudo /etc/init.d/rsync restart\n</code></pre>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/windows/Win11%E4%BD%BF%E7%94%A8mklink%E8%BD%AC%E7%A7%BBCUsers%E6%96%87%E4%BB%B6%E5%A4%B9%E8%87%B3%E9%9D%9E%E7%B3%BB%E7%BB%9F%E7%9B%98/","title":"Win11\u4f7f\u7528mklink\u8f6c\u79fbC:\\Users\u6587\u4ef6\u5939\u81f3\u975e\u7cfb\u7edf\u76d8","text":""},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/windows/Win11%E4%BD%BF%E7%94%A8mklink%E8%BD%AC%E7%A7%BBCUsers%E6%96%87%E4%BB%B6%E5%A4%B9%E8%87%B3%E9%9D%9E%E7%B3%BB%E7%BB%9F%E7%9B%98/#administrator","title":"\u4e00\u3001\u6fc0\u6d3bAdministrator\u8d26\u6237","text":"<p>\u70b9\u51fbWindows\u5fbd\u6807\uff0c\u8f93\u5165\u201c\u8ba1\u7b97\u673a\u7ba1\u7406\u201d\uff0c\u56de\u8f66\u8c03\u51fa\u8ba1\u7b97\u673a\u7ba1\u7406\u754c\u9762\u3002</p> <p>\u53f3\u952eAdministrator\u8d26\u6237\uff0c\u9009\u62e9\u201c\u5c5e\u6027\u201d\uff0c\u5c06\u201c\u8d26\u6237\u5df2\u7981\u7528\u201d\u524d\u9762\u7684\u52fe\u53d6\u6d88\uff08\u4e0b\u56fe\u662f\u5df2\u7981\u7528\u7684\u72b6\u6001\uff0c\u8981\u5b9e\u73b0\u7684\u662f\u542f\u7528\u8be5\u8d26\u6237\uff09\uff0c\u5373\u6fc0\u6d3b\u8be5\u8d26\u6237\u3002</p>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/windows/Win11%E4%BD%BF%E7%94%A8mklink%E8%BD%AC%E7%A7%BBCUsers%E6%96%87%E4%BB%B6%E5%A4%B9%E8%87%B3%E9%9D%9E%E7%B3%BB%E7%BB%9F%E7%9B%98/#administratorusers","title":"\u4e8c\u3001\u4f7f\u7528Administrator\u8d26\u6237\u8f6c\u79fbUsers\u6587\u4ef6\u5939","text":"<p>Windows\u952e+X\uff0c\u518d\u6309U\uff0c\u5feb\u6377\u952e\u8c03\u51fa\u5173\u673a\u6216\u6ce8\u9500\u9009\u9879\u5361\uff0c\u9009\u62e9\u6ce8\u9500\u5f53\u524d\u8d26\u6237\uff08\u6ce8\u610f\uff0c\u4e0d\u662f\"\u5207\u6362\u7528\u6237\"\uff0c\u4e0d\u6ce8\u9500\u4f1a\u5bfc\u81f4\u4e00\u4e9b\u914d\u7f6e\u6587\u4ef6\u4ecd\u7136\u5728\u88ab\u4f7f\u7528\uff0c\u800c\u5bfc\u81f4\u63a5\u4e0b\u6765\u7684\u590d\u5236\u548c\u5220\u9664\u64cd\u4f5c\u6ca1\u6cd5\u987a\u5229\u5b8c\u6210\uff0c\u539f\u7406\u53c2\u8003\u6587\u7ae0[6]\uff09\u3002\u800c\u540e\u5728\u767b\u9646\u754c\u9762\u5de6\u4e0b\u89d2\u4f1a\u51fa\u73b0Administrator\u8d26\u6237\uff0c\u9009\u4e2d\u76f4\u63a5\u767b\u5f55\u3002</p> <p>2.1 \u590d\u5236C:\\Users\u6587\u4ef6\u5939\u5230\u76ee\u6807\u4f4d\u7f6e</p> <p>\u7ba1\u7406\u5458\u8eab\u4efd\u6253\u5f00\u547d\u4ee4\u884c\u7a97\u53e3\uff0c\u76ee\u6807\u4f4d\u7f6e\u4ee5\"D:\\Users\"\u4e3a\u4f8b\uff0c\u8f93\u5165\u4ee5\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>robocopy \"C:\\Users\" \"D:\\Users\" /E /COPYALL /XJ /XD \"C:\\Users\\Administrator\"\n</code></pre> <p>\u5176\u4e2drobocopy\u8bed\u6cd5\u7684\u57fa\u672c\u683c\u5f0f\u4e3a\uff1arobocopy   [[ ...]] []\uff0c\u5bf9\u5e94\u4e0a\u8ff0\u547d\u4ee4\u89e3\u91ca\u5982\u4e0b\uff1a <ul> <li>\u57fa\u672c\u53c2\u6570\uff1a\"C:\\Users\"\u4e3a\u6e90\u76ee\u5f55\u7684\u8def\u5f84\uff1b\"D:\\Users\"\u4e3a\u76ee\u6807\u76ee\u5f55\u7684\u8def\u5f84\uff1b</li> <li>\u590d\u5236\u9009\u9879\uff1a/E\u8868\u793a\u590d\u5236\u5b50\u76ee\u5f55\uff08\u5305\u62ec\u7a7a\u76ee\u5f55\uff09\uff1b/COPYALL\u590d\u5236\u6240\u6709\u6587\u4ef6\u4fe1\u606f\uff08\u7b49\u6548\u4e8e /COPY:DATSOU\uff0c\u8be6\u89c1/COPY\uff09\uff1b</li> <li>\u6587\u4ef6\u9009\u62e9\u9009\u9879\uff1a/XJ \u6392\u9664\u4ea4\u63a5\u70b9\uff08\u901a\u5e38\u9ed8\u8ba4\u4f1a\u5305\u542b\uff0c\u5173\u4e8e\u4ea4\u63a5\u70b9Junction\u7684\u89e3\u91ca\u8be6\u89c1[7]\uff09\uff1b/XD \"C:\\Users\\Administrator\" \u6392\u9664\u4e0e\u6307\u5b9a\u7684\u540d\u79f0\u548c\u8def\u5f84\u5339\u914d\u7684\u76ee\u5f55\uff08\u5728win11\u4e2d\u4f3c\u4e4eAdministrator\u4e0d\u5728Users\u6587\u4ef6\u5939\u4e0b\u751f\u6210\u6587\u4ef6\uff0c\u4f46\u6b64\u5904\u6dfb\u52a0\u5e76\u65e0\u5927\u788d\uff09</li> </ul> <p>\u6709\u5173robocopy\u547d\u4ee4\u7684\u5177\u4f53\u7ec6\u8282\u89c1\u5b98\u65b9\u7f51\u7ad9[8]\u3002</p> <p>2.2 \u5220\u9664C:\\Users\u6587\u4ef6\u5939</p> <p>\u7ee7\u7eed\u5728\u4e0a\u8ff0\u7ba1\u7406\u5458CMD\u7a97\u53e3\u8f93\u5165\u4ee5\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>rmdir \"C:\\Users\" /S /Q\n</code></pre> <p>\u5176\u4e2drmdir\u8bed\u6cd5\u7684\u57fa\u672c\u683c\u5f0f\u4e3a\uff1armdir [:] [/s [/q]]\uff0c\u5bf9\u5e94\u4e0a\u8ff0\u547d\u4ee4\u89e3\u91ca\u5982\u4e0b\uff1a <ul> <li>\u57fa\u672c\u53c2\u6570\uff1a\"C:\\Users\"\u6307\u5b9a\u8981\u5220\u9664\u7684\u76ee\u5f55\u7684\u4f4d\u7f6e\u548c\u540d\u79f0\uff1b/S\u5220\u9664 (\u6307\u5b9a\u76ee\u5f55\u53ca\u5176\u6240\u6709\u5b50\u76ee\u5f55\u7684\u76ee\u5f55\u6811\uff0c\u5305\u62ec\u6240\u6709\u6587\u4ef6)\uff1b/Q\u6307\u5b9a\u5b89\u9759\u6a21\u5f0f\uff0c\u5220\u9664\u76ee\u5f55\u6811\u65f6\u4e0d\u63d0\u793a\u786e\u8ba4\uff08\u4ec5\u5f53\u6307\u5b9a /s\u65f6\uff0c/q\u53c2\u6570\u624d\u6709\u6548\uff09\u3002</li> </ul> <p>\u6709\u5173rmdir\u547d\u4ee4\u7684\u5177\u4f53\u7ec6\u8282\u89c1\u5b98\u65b9\u7f51\u7ad9[9]\u3002</p> <p>\u6b64\u6b65\u9aa4\u8bb0\u5f97\u67e5\u770bC\u76d8\u7684Users\u6587\u4ef6\u5939\u662f\u5426\u5f7b\u5e95\u5220\u9664\uff0c\u6709\u65f6\u53ef\u80fd\u4f1a\u56e0\u4e3a\u6253\u5f00\u8d44\u6e90\u7ba1\u7406\u5668\u5230\u8be5\u76ee\u5f55\u5b50\u6587\u4ef6\u5939\u4e0b\u5bfc\u81f4\u5176\u5b9e\u672a\u5b8c\u5168\u5220\u9664\u3002\uff08\u5982\u679c\u8fd8\u662f\u672a\u80fd\u5f7b\u5e95\u5220\u9664\uff0c\u53ef\u4ee5\u8fdb\u5165\u5b89\u5168\u6a21\u5f0f\u6216\u8005PE\u7b49\u7cfb\u7edf\u5de5\u5177\u8f85\u52a9\u5220\u9664\uff0c\u4f46\u524d\u63d0\u662f\u5df2\u7ecf\u4f7f\u7528robocopy\u590d\u5236\u597dusers\u6587\u4ef6\u5939\uff0c\u9632\u6b62\u64cd\u4f5c\u5931\u8d25\uff09</p> <p>2.3 \u521b\u5efa\u76ee\u5f55\u4ea4\u63a5\u70b9</p> <p>\u7ee7\u7eed\u5728\u4e0a\u8ff0\u7ba1\u7406\u5458CMD\u7a97\u53e3\u8f93\u5165\u4ee5\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>mklink /J \"C:\\Users\" \"D:\\Users\"\n</code></pre> <p>\u5176\u4e2drmdir\u8bed\u6cd5\u7684\u57fa\u672c\u683c\u5f0f\u4e3a\uff1amklink [[/d] | [/h] | [/j]]  \uff0c\u5bf9\u5e94\u4e0a\u8ff0\u547d\u4ee4\u89e3\u91ca\u5982\u4e0b\uff1a <ul> <li>\u57fa\u672c\u53c2\u6570\uff1a/J\u521b\u5efa\u76ee\u5f55\u94fe\u63a5\uff08\u901a\u8fc7\u4ea4\u63a5\u70b9\u7684\u64cd\u4f5c\u90fd\u4f1a\u88ab\u7cfb\u7edf\u6620\u5c04\u5230\u5b9e\u9645\u7684\u76ee\u5f55\u4e0a\u3002\u6709\u5173\u94fe\u63a5\u79cd\u7c7b\u7684\u8bf4\u660e\u53ef\u53c2\u89c1[7]\uff09\uff1b\"C:\\Users\"\u8981\u521b\u5efa\u94fe\u63a5\u7684\u540d\u79f0\uff1b\"D:\\Users\"\u65b0\u94fe\u63a5\u5f15\u7528\u7684\u8def\u5f84\u3002</li> </ul> <p>\u6709\u5173mklink\u547d\u4ee4\u7684\u5177\u4f53\u7ec6\u8282\u89c1\u5b98\u65b9\u7f51\u7ad9[10]\u3002</p>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/windows/Win11%E4%BD%BF%E7%94%A8mklink%E8%BD%AC%E7%A7%BBCUsers%E6%96%87%E4%BB%B6%E5%A4%B9%E8%87%B3%E9%9D%9E%E7%B3%BB%E7%BB%9F%E7%9B%98/#administrator_1","title":"\u4e09\u3001\u5207\u56de\u539f\u8d26\u6237\u5e76\u7981\u7528Administrator\u8d26\u6237","text":""},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/windows/Windows%E5%88%9D%E5%A7%8B%E5%8C%96%E5%AE%89%E8%A3%85/","title":"Windows\u521d\u59cb\u5316\u5b89\u88c5","text":""},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/windows/Windows%E5%88%9D%E5%A7%8B%E5%8C%96%E5%AE%89%E8%A3%85/#vhdwindows","title":"\u521b\u5efaVHD\u5e76\u5b89\u88c5Windows\u7cfb\u7edf","text":""},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/windows/Windows%E5%88%9D%E5%A7%8B%E5%8C%96%E5%AE%89%E8%A3%85/#vhd","title":"\u521b\u5efaVHD","text":"<pre><code>\u542f\u52a8wePE\n\u6253\u5f00DiskGenius\n\u5220\u9664\u786c\u76d8\u6240\u6709\u5206\u533a\uff0c\u4fdd\u5b58\u66f4\u6539\uff1b\n\u53f3\u952e\u521b\u5efaESP\u3001MSR\u5206\u533a\uff0c\u9ed8\u8ba4\u8bbe\u7f6e\uff08\u5927\u5c0f\u662f\u5426\u7531300\u6539\u4e3a1024\uff09\uff1b\n\u5269\u4e0b\u7684\u7a7a\u95f4\u65b0\u5efaNTFS\u4e3b\u78c1\u76d8\u5206\u533a\uff0c\u6247\u533a\u9009\u62e9 4096\uff0c\u4fdd\u5b58\u66f4\u6539\uff1b\n\n\u5c06\u955c\u50cf\u6587\u4ef6\u3001\u9a71\u52a8\u590d\u5236\u5230C\u76d8\n\u5c06windows\u955c\u50cf\u52a0\u8f7d\u5230\u5149\u9a71\n\n\u8fd0\u884cWinNTSetup,\n  \u9009\u62e9Windows\u5b89\u88c5\u6e90: D:\\sources\\install.wim\n  \u9009\u62e9\u5f15\u5bfc\u9a71\u52a8\u5668\uff1a Z:\n  \u521b\u5efa VHD&gt;&gt;&gt; , \u4f4d\u7f6e C:\\vhdx\\win11.vhdx\uff0c\u5927\u5c0f120 VHDX GB\uff0c\u5206\u914d\u5355\u5143\u5927\u5c0f4096\uff0c\u52a8\u6001\u6269\u5c55\n  \u9009\u62e9\u5b89\u88c5\u9a71\u52a8\u5668\uff1a \u9009\u62e9\u521a\u521b\u5efa\u6302\u8f7d\u7684\u5206\u533a\uff0c\u4f8b\u5982W\uff1a\n  \u9009\u9879\uff1a \u9009\u62e9windows 11 \u4e13\u4e1a\u7248\n  \u5f00\u59cb\u5b89\u88c5\uff0c\u786e\u5b9a\uff0c\u91cd\u542f\uff1b\n\n</code></pre>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/windows/Windows%E5%88%9D%E5%A7%8B%E5%8C%96%E5%AE%89%E8%A3%85/#windows","title":"windows\u5b89\u88c5\u6fc0\u6d3b\u547d\u4ee4","text":"<pre><code>slmgr /ipk NRG8B-VKK3Q-CXVCJ-9G2XF-6Q84J\nslmgr /skms kms.loli.best\nslmgr /ato\n</code></pre>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/windows/Windows%E5%88%9D%E5%A7%8B%E5%8C%96%E5%AE%89%E8%A3%85/#shiftf10","title":"\u8df3\u8fc7\u5fae\u8f6f\u8d26\u6237\u767b\u5f55\uff0cshift+F10\u8f93\u5165\u4e00\u4e0b\u547d\u4ee4\u91cd\u542f","text":"<pre><code>oobe\\bypassnro.cmd\n</code></pre>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/windows/Windows%E5%88%9D%E5%A7%8B%E5%8C%96%E5%AE%89%E8%A3%85/#_1","title":"\u7528\u6237\u4e3b\u76ee\u5f55\u8f6c\u79fb","text":"<pre><code>@echo off\nrobocopy \"C:\\\\Users\" \"D:\\\\Users\" /E /COPYALL /XJ /XD WindowsApps\nrmdir \"C:\\\\Users\" /S /Q\nmklink /J \"C:\\\\Users\" \"D:\\\\Users\"\n</code></pre> <p>\u4e0a\u9762\u7684\u5185\u5bb9\u4fdd\u5b58\u4e3a mv.bat \u4fdd\u5b58\u5230D\u76d8\u3002 \u5f00\u59cb\u8fd0\u884c\u6216\u5fbd\u6807+R shutdown -O -r -t 0 \u91cd\u542f\u5230\u6062\u590d\u754c\u9762</p> <p>\u8fdb\u5165\u7591\u96be\u95ee\u9898\u83dc\u5355-\u547d\u4ee4\u63d0\u793a\u7b26</p> <pre><code>CD D:\nmv.bat\n</code></pre> <p>\u6267\u884cMV.bat \u5373\u53ef.</p>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/windows/Windows%E5%88%9D%E5%A7%8B%E5%8C%96%E5%AE%89%E8%A3%85/#_2","title":"\u5efa\u7acb\u5dee\u5206\u7cfb\u7edf","text":"<pre><code>\u8fd0\u884cBOOTICE\n\u9009\u62e9\u955c\u50cf\u6587\u4ef6 C:\\vhdx\\win11.vhdx\n\u5b50\u6587\u4ef6\u4f4d\u7f6e\u8f93\u5165 C:\\vhdx\\win11_daily.vhdx\n\u70b9\u51fb\u521b\u5efa\uff1b\n\n\u540c\u7406\u521b\u5efa win11_game.vhdx\uff0cwin11_crypto.vhdx\uff0cwin11_solidworks.vhdx...\n</code></pre>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/windows/Windows%E5%88%9D%E5%A7%8B%E5%8C%96%E5%AE%89%E8%A3%85/#_3","title":"\u5907\u4efd\u5dee\u5206\u7cfb\u7edf","text":"<pre><code>\u521b\u5efa C:\\vhdx\\vhdx_backup \u6587\u4ef6\u5939\n\u5c06\u6240\u6709 vhdx\u6587\u4ef6\u590d\u5236\u5230 vhdx_backup \u6587\u4ef6\u5939\n</code></pre>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/windows/Windows%E5%88%9D%E5%A7%8B%E5%8C%96%E5%AE%89%E8%A3%85/#_4","title":"\u4fee\u6539\u5f15\u5bfc","text":"<pre><code>\u521b\u5efa C:\\vhdx\\ESP\\ESP_original \u6587\u4ef6\u5939\n\u6253\u5f00DiskGenius\uff0c\u627e\u5230ESP\u5206\u533a\uff0c\u70b9\u51fb\u6d4f\u89c8\u6587\u4ef6\uff0c\u9009\u4e2dBoot\u548cEFI\u6587\u4ef6\u5939\uff0c\u53f3\u952e \u590d\u5236\u5230\u6307\u5b9a\u6587\u4ef6\u5939 C:\\vhdx\\ESP\\ESP_original\n\u5f3a\u5236\u5220\u9664\u539fBoot\u548cEFI\u6587\u4ef6\u5939\n\u590d\u5236 C:\\vhdx\\ESP\\ESP_original\u4e0b\u7684Boot\u548cEFI\u6587\u4ef6\u5939\u5230\u4e0a\u4e00\u7ea7\u76ee\u5f55C:\\vhdx\\ESP\n</code></pre>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/windows/Windows%E5%88%9D%E5%A7%8B%E5%8C%96%E5%AE%89%E8%A3%85/#_5","title":"\u7f16\u8f91\u542f\u52a8\u9879","text":"<pre><code>\u8fd0\u884c BOOTICE / BCD\u7f16\u8f91\n\u9009\u4e2d\u5176\u4ed6BCD\u6587\u4ef6\uff0c\u9009\u62e9 C:\\vhdx\\ESP\\EFI\\Microsoft\\Boot\\BCD \u6587\u4ef6\uff0c\u70b9\u51fb\u667a\u80fd\u7f16\u8f91\u6a21\u5f0f\uff1b\n\u5220\u9664\u5df2\u6709\u5f15\u5bfc\u9879\uff1b\n\n\u6dfb\u52a0\u5f15\u5bfc\n-------\n\u8bbe\u5907\u7c7b\u578b\uff1a VHD\uff08X\uff09\n\u542f\u52a8\u78c1\u76d8\uff1a C\u76d8\n\u542f\u52a8\u5206\u533a\uff1a C\u76d8\n\u8bbe\u5907\u6587\u4ef6: \\vhdx\\win11_daily.vhdx\n\u83dc\u5355\u6807\u9898\uff1a Windows11 for Daily\nNX: OptIn\n\u68c0\u6d4b\u786c\u4ef6\u62bd\u8c61\u5c42 \u9009\u4e2d          \u542f\u52a8\u5230WinPE \u7981\u7528\n\u542f\u7528Win8 Metro\u542f\u52a8\u754c\u9762 \u9009\u4e2d  \u6d4b\u8bd5\u6a21\u5f0f \u7981\u7528\n\u8d85\u65f6\u65f6\u95f4 5\n\u70b9\u51fb\u4fdd\u5b58\u5f53\u524d\u7cfb\u7edf\u8bbe\u7f6e\uff0c\u4fdd\u5b58\u5168\u5c40\u8bbe\u7f6e\uff1b\n\n\u540c\u7406\u6dfb\u52a0 win11_game.vhdx\uff0cwin11_crypto.vhdx\uff0cwin11_solidworks.vhdx...\n\n</code></pre>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/windows/win11%E5%85%8D%E5%AF%86%E7%99%BB%E5%BD%95/","title":"Win11\u514d\u5bc6\u767b\u5f55","text":""},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/windows/win11%E5%85%8D%E5%AF%86%E7%99%BB%E5%BD%95/#win11","title":"win11\u514d\u5bc6\u767b\u5f55","text":"<p>\u4efb\u52a1\u680f\u653e\u5927\u955c\u641c\u7d22:\u201c\u6ce8\u518c\u8868\u7f16\u8f91\u5668\u201d\uff0c\u7ba1\u7406\u5458\u65b9\u5f0f\u6253\u5f00</p> <p>\u4f9d\u6b21\u627e\u5230:</p> <pre><code>\u8ba1\u7b97\u673a\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\PasswordLess\\Device\n</code></pre> <p>\u539f\u59cb\u503c\u662f2\uff0c\u53cc\u51fb\u6539\u62100\u5373\u53ef\uff01</p> <p>2\u3001\u7136\u540e\u5728\u201c\u8fd0\u884c\u201d\u91cc\u8f93\u5165\uff1a</p> <p>netplwiz</p> <p>\u53bb\u6389\u5bf9\u52fe</p>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/windows/windows%E5%AE%89%E8%A3%85%E6%BF%80%E6%B4%BB%E5%91%BD%E4%BB%A4/","title":"Windows\u5b89\u88c5\u6fc0\u6d3b\u547d\u4ee4","text":""},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/windows/windows%E5%AE%89%E8%A3%85%E6%BF%80%E6%B4%BB%E5%91%BD%E4%BB%A4/#windows","title":"windows\u5b89\u88c5\u6fc0\u6d3b\u547d\u4ee4","text":"<pre><code>slmgr /ipk NRG8B-VKK3Q-CXVCJ-9G2XF-6Q84J\nslmgr /skms kms.loli.best\nslmgr /ato\n</code></pre>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/windows/windows%E5%AE%89%E8%A3%85%E6%BF%80%E6%B4%BB%E5%91%BD%E4%BB%A4/#shiftf10","title":"\u8df3\u8fc7\u5fae\u8f6f\u8d26\u6237\u767b\u5f55\uff0cshift+F10\u8f93\u5165\u4e00\u4e0b\u547d\u4ee4\u91cd\u542f","text":"<pre><code>oobe\\bypassnro.cmd\n</code></pre>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/windows/wsl%20ubuntu%20%E5%AE%89%E8%A3%85%E7%9A%84%E6%AD%A3%E7%A1%AE%E6%96%B9%E5%BC%8F/","title":"wsl ubuntu \u5b89\u88c5\u7684\u6b63\u786e\u65b9\u5f0f","text":"<p>\u63a7\u5236\u9762\u677f -&gt; \u7a0b\u5e8f -&gt; \u5378\u8f7d\u7a0b\u5e8f\uff0c\u6dfb\u52a0\u4e0b\u8ff02\u9879\uff1a</p> <p></p>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/windows/wsl%20ubuntu%20%E5%AE%89%E8%A3%85%E7%9A%84%E6%AD%A3%E7%A1%AE%E6%96%B9%E5%BC%8F/#powershell","title":"\u6253\u5f00powershell","text":"<pre><code>\nwsl --set-default-version 2     # \u8bbe\u7f6ewsl\u7684\u7248\u672c\u4e3a2\nwsl --update                    # \u66f4\u65b0wsl\u7a0b\u5e8f\nwsl --shutdown                  # \u5f3a\u5236\u5173\u95ed\u5b50\u7cfb\u7edf\n\nwsl --list --online             # \u67e5\u770bwsl\u652f\u6301\u7684\u5217\u8868\nwsl --list --verbose    # \u5217\u51fa\u5df2\u5b89\u88c5\u7684 Linux \u53d1\u884c\u7248\nwsl --install -d Ubuntu-24.04   # \u5b89\u88c5\u6307\u5b9a\u7248\u672c\u7684\u7cfb\u7edf\nwsl --unregister Ubuntu-24.04   # \u5220\u9664WSL\u7684Ubuntu\u53d1\u884c\u7248\n\nwsl --shutdown\nwsl --export Ubuntu-18.04 D:\\WSL2\\Ubuntu-18.04.2.0.tar\n</code></pre> <pre><code>!\u5b89\u88c5GUI\u547d\u4ee4:\nsudo apt update &amp;&amp; sudo apt -y upgrade\nsudo apt-get purge xrdp\nsudo apt install -y xrdp\nsudo apt install -y xfce4\nsudo apt install -y xfce4-goodies\n\nsudo cp /etc/xrdp/xrdp.ini /etc/xrdp/xrdp.ini.bak\nsudo sed -i 's/3389/3389/g' /etc/xrdp/xrdp.ini\nsudo sed -i 's/max_bpp=32/#max_bpp=32\\nmax_bpp=128/g' /etc/xrdp/xrdp.ini\nsudo sed -i 's/xserverbpp=24/#xserverbpp=24\\nxserverbpp=128/g' /etc/xrdp/xrdp.ini\necho xfce4-session &gt; ~/.xsession\n\nsudo nano /etc/xrdp/startwm.sh\n!\u4ee5\u4e0b\u8fd9\u4e24\u884c\u6ce8\u91ca\u6389:\n#test -x /etc/X11/Xsession &amp;&amp; exec /etc/X11/Xsession\n#exec /bin/sh /etc/X11/Xsession\n\n!\u6dfb\u52a0\u8fd9\u4e00\u884c:\n# xfce\nstartxfce4\n\nsudo /etc/init.d/xrdp start\n\n!WINDOWS\u8fdc\u7a0b\u8fde\u63a5\nlocalhost:3389\n</code></pre> <p>\u5b89\u88c5vcxsrv windows x server\uff0cgoogle\u641c\u7d22vcxsrv</p> <pre><code>Display number -1 \u6539\u4e3a 0\nNative opengl  \u53d6\u6d88\u5bf9\u52fe\nDisable access control  \u6253\u4e0a\u5bf9\u52fe\n</code></pre> <p>\u5728ubuntu\u7ec8\u7aef\u8fd0\u884c\u547d\u4ee4</p> <pre><code>export GAZEBO_IP=127.0.0.1\nexport DISPLAY=$(cat /etc/resolv.conf | grep nameserver | awk '{print $2}'):0 \nexport LIBGL_ALWAYS_INDIRECT=0\n</code></pre> <p>\u8fd0\u884c gz sim\u51fa\u73b0gui\uff0c\u518d\u6b21\u8fd0\u884crviz2\u65f6\uff0c\u9700\u518d\u6b21\u8fd0\u884c<code>export LIBGL_ALWAYS_INDIRECT=0</code>\u547d\u4ee4</p>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/windows/%E7%94%A8%E6%88%B7%E4%B8%BB%E7%9B%AE%E5%BD%95%E8%BD%AC%E7%A7%BB/","title":"\u7528\u6237\u4e3b\u76ee\u5f55\u8f6c\u79fb","text":""},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/windows/%E7%94%A8%E6%88%B7%E4%B8%BB%E7%9B%AE%E5%BD%95%E8%BD%AC%E7%A7%BB/#_1","title":"\u7528\u6237\u4e3b\u76ee\u5f55\u8f6c\u79fb","text":"<pre><code>@echo off\nrobocopy \"C:\\\\Users\" \"D:\\\\Users\" /E /COPYALL /XJ /XD WindowsApps\nrmdir \"C:\\\\Users\" /S /Q\nmklink /J \"C:\\\\Users\" \"D:\\\\Users\"\n</code></pre> <p>\u4e0a\u9762\u7684\u5185\u5bb9\u4fdd\u5b58\u4e3a mv.bat \u4fdd\u5b58\u5230D\u76d8\u3002 \u5f00\u59cb\u8fd0\u884c\u6216\u5fbd\u6807+R shutdown -O -r -t 0 \u91cd\u542f\u5230\u6062\u590d\u754c\u9762</p> <p>\u8fdb\u5165\u7591\u96be\u95ee\u9898\u83dc\u5355-\u547d\u4ee4\u63d0\u793a\u7b26</p> <pre><code>CD D:\nmv.bat\n</code></pre> <p>\u6267\u884cMV.bat \u5373\u53ef.</p>"},{"location":"%E6%99%BA%E8%83%BDAI/ROS2/ROS%E5%AE%89%E8%A3%85/","title":"ROS\u5b89\u88c5","text":"<pre><code>curl -fsSL https://get.docker.com -o get-docker.sh\nsudo sh ./get-docker.sh --dry-run\n</code></pre>"},{"location":"%E6%99%BA%E8%83%BDAI/ROS2/%E5%9C%A8Docker%E4%B8%AD%E8%BF%90%E8%A1%8CROS2%E8%8A%82%E7%82%B9/","title":"\u5728 Docker \u4e2d\u8fd0\u884c ROS 2 \u8282\u70b9","text":""},{"location":"%E6%99%BA%E8%83%BDAI/ROS2/%E5%9C%A8Docker%E4%B8%AD%E8%BF%90%E8%A1%8CROS2%E8%8A%82%E7%82%B9/#docker","title":"\u5728\u5355\u4e2a docker \u5bb9\u5668\u4e2d\u8fd0\u884c\u4e24\u4e2a\u8282\u70b9\uf0c1","text":"<p>\u62c9\u53d6\u5e26\u6709\u6807\u7b7e\u201chumble-desktop\u201d\u7684 ROS docker \u955c\u50cf\u3002</p> <pre><code>docker pull osrf/ros:humble-desktop\n</code></pre> <p>\u4ee5\u4ea4\u4e92\u6a21\u5f0f\u5728\u5bb9\u5668\u4e2d\u8fd0\u884c\u955c\u50cf\u3002</p> <pre><code>$ docker run -it osrf/ros:humble-desktop\nroot@&lt;container-id&gt;:/#\n</code></pre> <p><code>ros2</code>\u73b0\u5728\u4f60\u6700\u597d\u7684\u670b\u53cb\u662f\u547d\u4ee4\u884c\u5e2e\u52a9\u3002</p> <pre><code>root@&lt;container-id&gt;:/# ros2 --help\n</code></pre> <p>\u4f8b\u5982\u5217\u51fa\u6240\u6709\u5df2\u5b89\u88c5\u7684\u8f6f\u4ef6\u5305\u3002</p> <pre><code>root@&lt;container-id&gt;:/# ros2 pkg list\n(you will see a list of packages)\n</code></pre> <p>\u4f8b\u5982\u5217\u51fa\u6240\u6709\u53ef\u6267\u884c\u6587\u4ef6\uff1a</p> <pre><code>root@&lt;container-id&gt;:/# ros2 pkg executables\n(you will see a list of &lt;package&gt; &lt;executable&gt;)\n</code></pre> <p>\u4ece\u6b64\u5bb9\u5668\u4e2d\u7684\u5305\u8fd0\u884c 2 \u4e2a C++ \u8282\u70b9\uff081 \u4e2a\u4e3b\u9898\u8ba2\u9605\u8005<code>listener</code>\uff0c1 \u4e2a\u4e3b\u9898\u53d1\u5e03\u8005\uff09\u7684\u6700\u5c0f\u793a\u4f8b\uff1a<code>talker``demo_nodes_cpp</code></p> <pre><code>ros2 run demo_nodes_cpp listener &amp;\nros2 run demo_nodes_cpp talker\n</code></pre>"},{"location":"%E6%99%BA%E8%83%BDAI/ROS2/%E5%9C%A8Docker%E4%B8%AD%E8%BF%90%E8%A1%8CROS2%E8%8A%82%E7%82%B9/#docker_1","title":"\u5728\u4e24\u4e2a\u5355\u72ec\u7684 docker \u5bb9\u5668\u4e2d\u8fd0\u884c\u4e24\u4e2a\u8282\u70b9\uf0c1","text":"<p>\u6253\u5f00\u7ec8\u7aef\u3002\u4ee5\u4ea4\u4e92\u6a21\u5f0f\u5728\u5bb9\u5668\u4e2d\u8fd0\u884c\u56fe\u50cf\uff0c\u5e76\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u542f\u52a8\u4e3b\u9898\u53d1\u5e03\u8005\uff08\u53ef<code>talker</code>\u4ece\u5305\u4e2d\u6267\u884c<code>demo_nodes_cpp</code>\uff09\uff1a<code>ros2 run</code></p> <pre><code>docker run -it --rm osrf/ros:humble-desktop ros2 run demo_nodes_cpp talker\n</code></pre> <p>\u6253\u5f00\u7b2c\u4e8c\u4e2a\u7ec8\u7aef\u3002\u4ee5\u4ea4\u4e92\u6a21\u5f0f\u5728\u5bb9\u5668\u4e2d\u8fd0\u884c\u56fe\u50cf\uff0c\u5e76\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u542f\u52a8\u4e3b\u9898\u8ba2\u9605\u8005\uff08\u53ef<code>listener</code>\u4ece\u5305\u4e2d\u6267\u884c<code>demo_nodes_cpp</code>\uff09\uff1a<code>ros2 run</code></p> <pre><code>docker run -it --rm osrf/ros:humble-desktop ros2 run demo_nodes_cpp listener\n</code></pre> <p>\u4f5c\u4e3a\u547d\u4ee4\u884c\u8c03\u7528\u7684\u66ff\u4ee3\u65b9\u6cd5\uff0c\u60a8\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a<code>docker-compose.yml</code>\u5305\u542b\u4ee5\u4e0b\uff08\u6700\u5c11\uff09\u5185\u5bb9\u7684\u6587\u4ef6\uff08\u6b64\u5904\u4e3a\u7248\u672c 2\uff09\uff1a</p> <pre><code>version: '2'\n\nservices:\n  talker:\n    image: osrf/ros:humble-desktop\n    command: ros2 run demo_nodes_cpp talker\n  listener:\n    image: osrf/ros:humble-desktop\n    command: ros2 run demo_nodes_cpp listener\n    depends_on:\n      - talker\n</code></pre> <p>\u8981\u5728\u540c\u4e00\u76ee\u5f55\u4e2d\u8fd0\u884c\u5bb9\u5668\u8c03\u7528\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528 \u5173\u95ed\u5bb9\u5668\u3002<code>docker compose up``Ctrl+C</code></p>"},{"location":"%E6%99%BA%E8%83%BDAI/ROS2/moveit/01_Getting%20Started/","title":"\u5165\u95e8\uf0c1","text":"<p>\u5728\u8fd9\u91cc\uff0c\u6211\u4eec\u5c06\u8bbe\u7f6e\u60a8\u7684\u73af\u5883\uff0c\u4ee5\u4fbf\u6700\u597d\u5730\u8fd0\u884c\u6559\u7a0b\u3002\u8fd9\u5c06\u521b\u5efa\u4e00\u4e2a Colcon \u5de5\u4f5c\u533a\uff0c\u4e0b\u8f7d\u6240\u6709\u6700\u65b0\u7684 MoveIt \u6e90\u4ee3\u7801\uff0c\u5e76\u4ece\u6e90\u4ee3\u7801\u6784\u5efa\u6240\u6709\u5185\u5bb9\uff0c\u4ee5\u786e\u4fdd\u60a8\u62e5\u6709\u6700\u65b0\u7684\u4fee\u590d\u548c\u6539\u8fdb\u3002</p> <p>\u6784\u5efa MoveIt \u7684\u6240\u6709\u6e90\u4ee3\u7801\u53ef\u80fd\u9700\u8981 20-30 \u5206\u949f\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u8ba1\u7b97\u673a\u7684 CPU \u901f\u5ea6\u548c\u53ef\u7528 RAM\u3002\u5982\u679c\u60a8\u4f7f\u7528\u7684\u662f\u6027\u80fd\u8f83\u5dee\u7684\u7cfb\u7edf\uff0c\u6216\u8005\u901a\u5e38\u53ea\u662f\u60f3\u66f4\u5feb\u5730\u5165\u95e8\uff0c\u8bf7\u67e5\u770b\u6211\u4eec\u7684Docker \u6307\u5357\u3002</p>"},{"location":"%E6%99%BA%E8%83%BDAI/ROS2/moveit/01_Getting%20Started/#ros-2-colcon","title":"\u4e00\u952e\u5b89\u88c5 ROS 2 \u548c Colcon\uf0c1","text":"<pre><code>wget http://fishros.com/install -O fishros &amp;&amp; . fishros\n</code></pre>"},{"location":"%E6%99%BA%E8%83%BDAI/ROS2/moveit/01_Getting%20Started/#colcon","title":"\u521b\u5efa Colcon \u5de5\u4f5c\u533a\u5e76\u4e0b\u8f7d\u6559\u7a0b\uf0c1","text":"<p>\u5bf9\u4e8e\u6559\u7a0b\uff0c\u60a8\u9700\u8981\u6709\u4e00\u4e2acolcon\u5de5\u4f5c\u533a\u8bbe\u7f6e\u3002</p> <pre><code>mkdir -p /home/bobo/ws_moveit2/src\n</code></pre>"},{"location":"%E6%99%BA%E8%83%BDAI/ROS2/moveit/01_Getting%20Started/#moveit","title":"\u4e0b\u8f7dMoveIt\u6e90\u4ee3\u7801\u548c\u6559\u7a0b\uf0c1","text":"<p>\u8fdb\u5165 Colcon \u5de5\u4f5c\u533a\u5e76\u63d0\u53d6 MoveIt \u6559\u7a0b\u6e90\uff1a</p> <pre><code>cd /home/bobo/ws_moveit/src\ngit clone --branch humble https://github.com/ros-planning/moveit2_tutorials\n</code></pre> <p>\u63a5\u4e0b\u6765\u6211\u4eec\u5c06\u4e0b\u8f7d MoveIt \u5176\u4f59\u90e8\u5206\u7684\u6e90\u4ee3\u7801\uff1a</p> <pre><code>vcs import &lt; moveit2_tutorials/moveit2_tutorials.repos\n</code></pre>"},{"location":"%E6%99%BA%E8%83%BDAI/ROS2/moveit/01_Getting%20Started/#colcon_1","title":"\u6784\u5efa\u60a8\u7684 Colcon \u5de5\u4f5c\u7a7a\u95f4\uf0c1","text":"<p>\u4ee5\u4e0b\u5c06\u4ece Debian \u5b89\u88c5\u5de5\u4f5c\u533a\u4e2d\u5c1a\u672a\u5b58\u5728\u7684\u4efb\u4f55\u8f6f\u4ef6\u5305\u4f9d\u8d56\u9879\u3002\u8fd9\u662f\u5b89\u88c5 MoveIt \u53ca\u5176\u6240\u6709\u4f9d\u8d56\u9879\u7684\u6b65\u9aa4\uff1a</p> <pre><code>sudo apt update &amp;&amp; rosdep install -r --from-paths . --ignore-src --rosdistro $ROS_DISTRO -y\n</code></pre> <p>\u4e0b\u4e00\u4e2a\u547d\u4ee4\u5c06\u914d\u7f6e\u60a8\u7684 Colcon \u5de5\u4f5c\u533a\uff1a</p> <pre><code>cd /home/bobo/ws_moveit\ncolcon build --mixin release\n</code></pre> <p>\u6b64\u6784\u5efa\u547d\u4ee4\u53ef\u80fd\u9700\u8981\u5f88\u957f\u65f6\u95f4\uff0820 \u5206\u949f\u4ee5\u4e0a\uff09\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u60a8\u7684\u8ba1\u7b97\u673a\u901f\u5ea6\u548c\u53ef\u7528 RAM \u91cf\uff08\u6211\u4eec\u5efa\u8bae 32 GB\uff09\u3002\u5982\u679c\u60a8\u7684\u8ba1\u7b97\u673a\u5185\u5b58\u4e0d\u8db3\u6216\u8005\u901a\u5e38\u60a8\u7684\u6784\u5efa\u96be\u4ee5\u5728\u8ba1\u7b97\u673a\u4e0a\u5b8c\u6210\uff0c\u60a8\u53ef\u4ee5\u5c06\u8be5\u53c2\u6570\u9644\u52a0\u5230\u4e0a\u9762\u7684 colcon \u547d\u4ee4\u4e2d\u3002<code>--parallel-workers 1</code></p> <p>\u5982\u679c\u4e00\u5207\u987a\u5229\uff0c\u60a8\u5e94\u8be5\u770b\u5230\u201c\u5b8c\u6210\u201d\u6d88\u606f\u3002\u5982\u679c\u60a8\u9047\u5230\u95ee\u9898\uff0c\u8bf7\u5c1d\u8bd5\u91cd\u65b0\u68c0\u67e5\u60a8\u7684ROS Installation\u3002</p>"},{"location":"%E6%99%BA%E8%83%BDAI/ROS2/moveit/01_Getting%20Started/#colcon_2","title":"\u8bbe\u7f6e\u60a8\u7684 Colcon \u5de5\u4f5c\u533a\uf0c1","text":"<p>\u83b7\u53d6 Colcon \u5de5\u4f5c\u533a\uff1a</p> <pre><code>source /home/bobo/ws_moveit/install/setup.bash\n</code></pre> <p>\u53ef\u9009\uff1a\u5c06\u524d\u9762\u7684\u547d\u4ee4\u6dfb\u52a0\u5230\u60a8\u7684<code>.bashrc</code>\uff1a</p> <pre><code>echo 'source /home/bobo/ws_moveit/install/setup.bash' &gt;&gt; ~/.bashrc\n</code></pre>"},{"location":"%E6%99%BA%E8%83%BDAI/ROS2/moveit/01_Getting%20Started/#cyclone-dds","title":"\u5207\u6362\u5230 Cyclone DDS\uf0c1","text":"<p>\u622a\u81f3 2022 \u5e74 9 \u6708 26 \u65e5\uff0c\u9ed8\u8ba4\u7684 ROS 2 \u4e2d\u95f4\u4ef6 (RMW) \u5b9e\u73b0\u5b58\u5728\u95ee\u9898\u3002\u4f5c\u4e3a\u89e3\u51b3\u65b9\u6cd5\uff0c\u8bf7\u5207\u6362\u5230 Cyclone DDS\u3002 \uff08\u6ce8\u610f\uff1a\u8fd9\u4f7f\u5f97\u4f7f\u7528\u6b64 RMW \u542f\u52a8\u7684\u6240\u6709\u8282\u70b9\u4e0e\u4e0d\u4f7f\u7528 Cyclone DDS \u7684\u4efb\u4f55\u5176\u4ed6\u8282\u70b9\u4e0d\u517c\u5bb9\u3002\uff09</p> <pre><code>sudo apt install ros-humble-rmw-cyclonedds-cpp\n# You may want to add this to ~/.bashrc to source it automatically\nexport RMW_IMPLEMENTATION=rmw_cyclonedds_cpp\n</code></pre>"},{"location":"%E6%99%BA%E8%83%BDAI/ROS2/moveit/02_MoveIt%20Quickstart%20in%20RViz/","title":"RViz \u4e2d\u7684 MoveIt \u5feb\u901f\u5165\u95e8\uf0c1","text":"<p>\u672c\u6559\u7a0b\u5c06\u6559\u60a8\u5982\u4f55\u4f7f\u7528 RViz \u548c MoveIt Display \u63d2\u4ef6\u5728 MoveIt \u4e2d\u521b\u5efa\u8fd0\u52a8\u8ba1\u5212\u3002 Rviz \u662f ROS \u4e2d\u7684\u4e3b\u8981\u53ef\u89c6\u5316\u5de5\u5177\uff0c\u4e5f\u662f\u8c03\u8bd5\u673a\u5668\u4eba\u7684\u975e\u5e38\u6709\u7528\u7684\u5de5\u5177\u3002 MoveIt Display \u63d2\u4ef6\u5141\u8bb8\u60a8\u8bbe\u7f6e\u865a\u62df\u73af\u5883\uff08\u89c4\u5212\u573a\u666f\uff09\u3001\u4ea4\u4e92\u5f0f\u5730\u521b\u5efa\u673a\u5668\u4eba\u7684\u5f00\u59cb\u548c\u76ee\u6807\u72b6\u6001\u3001\u6d4b\u8bd5\u5404\u79cd\u8fd0\u52a8\u89c4\u5212\u5668\u4ee5\u53ca\u53ef\u89c6\u5316\u8f93\u51fa\u3002\u8ba9\u6211\u4eec\u5f00\u59cb\u5427\uff01</p>"},{"location":"%E6%99%BA%E8%83%BDAI/ROS2/moveit/02_MoveIt%20Quickstart%20in%20RViz/#_1","title":"\u5165\u95e8\uf0c1","text":"<p>\u5982\u679c\u60a8\u5c1a\u672a\u6267\u884c\u6b64\u64cd\u4f5c\uff0c\u8bf7\u786e\u4fdd\u60a8\u5df2\u5b8c\u6210\u5165\u95e8\u6216\u6211\u4eec\u7684Docker \u6307\u5357\u4e2d\u7684\u6b65\u9aa4\u3002\u622a\u81f3 2022 \u5e74 9 \u6708 26 \u65e5\uff0c\u786e\u4fdd\u60a8\u5df2\u6309\u7167\u6b64\u5904\u6240\u8ff0\u542f\u7528 Cyclone DDS\u3002</p>"},{"location":"%E6%99%BA%E8%83%BDAI/ROS2/moveit/02_MoveIt%20Quickstart%20in%20RViz/#1","title":"\u7b2c 1 \u6b65\uff1a\u542f\u52a8\u6f14\u793a\u5e76\u914d\u7f6e\u63d2\u4ef6\uf0c1","text":"<ul> <li>\u542f\u52a8\u6f14\u793a\uff1a</li> </ul> <p><code>ros2 launch moveit2_tutorials demo.launch.py rviz_config:=panda_moveit_config_demo_empty.rviz</code></p> <ul> <li> <p>\u5982\u679c\u60a8\u662f\u7b2c\u4e00\u6b21\u6267\u884c\u6b64\u64cd\u4f5c\uff0c\u60a8\u5e94\u8be5\u5728 RViz \u4e2d\u770b\u5230\u4e00\u4e2a\u7a7a\u7684\u4e16\u754c\uff0c\u5e76\u4e14\u5fc5\u987b\u6dfb\u52a0\u8fd0\u52a8\u89c4\u5212\u63d2\u4ef6\uff1a</p> </li> <li> <p>\u60a8\u5e94\u8be5\u5728 RViz \u4e2d\u770b\u5230\u4e00\u4e2a\u7a7a\u7684\u4e16\u754c\uff1a</p> </li> </ul> <p></p> <ul> <li>\u5728 RViz \u663e\u793a\u9009\u9879\u5361\u4e2d\uff0c\u6309\u6dfb\u52a0\uff1a</li> </ul> <p></p> <ul> <li>\u4ece moveit_ros_visualization \u6587\u4ef6\u5939\u4e2d\uff0c\u9009\u62e9\u201cMotionPlanning\u201d\u4f5c\u4e3a DisplayType\u3002\u6309\u201c\u786e\u5b9a\u201d\u3002</li> </ul> <p></p> <ul> <li>\u60a8\u73b0\u5728\u5e94\u8be5\u5728 RViz \u4e2d\u770b\u5230 Panda \u673a\u5668\u4eba\uff1a</li> </ul> <p></p> <ul> <li>\u52a0\u8f7d\u8fd0\u52a8\u89c4\u5212\u63d2\u4ef6\u540e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5bf9\u5176\u8fdb\u884c\u914d\u7f6e\u3002\u5728\u201c\u663e\u793a\u201d\u5b50\u7a97\u53e3\u7684\u201c\u5168\u5c40\u9009\u9879\u201d\u9009\u9879\u5361\u4e2d\uff0c\u5c06\u201c\u56fa\u5b9a\u6846\u67b6\u201d\u5b57\u6bb5\u8bbe\u7f6e\u4e3a<code>/panda_link0</code></li> <li>\u73b0\u5728\uff0c\u60a8\u53ef\u4ee5\u5f00\u59cb\u4e3a\u60a8\u7684\u673a\u5668\u4eba\uff08\u672c\u4f8b\u4e2d\u4e3a Panda\uff09\u914d\u7f6e\u63d2\u4ef6\u3002\u5355\u51fb\u201c\u663e\u793a\u201d\u4e2d\u7684\u201cMotionPlanning\u201d\u3002</li> <li>\u786e\u4fdd\u673a\u5668\u4eba\u63cf\u8ff0\u5b57\u6bb5\u8bbe\u7f6e\u4e3a<code>robot_description</code>\u3002</li> <li>\u786e\u4fdd\u89c4\u5212\u573a\u666f\u4e3b\u9898\u5b57\u6bb5\u8bbe\u7f6e\u4e3a<code>/monitored_planning_scene</code>\u3002\u5355\u51fb\u4e3b\u9898\u540d\u79f0\u4ee5\u663e\u793a\u4e3b\u9898\u540d\u79f0\u4e0b\u62c9\u5217\u8868\u3002</li> <li>\u786e\u4fdd\u8ba1\u5212\u8def\u5f84\u4e0b\u7684\u8f68\u8ff9\u4e3b\u9898\u8bbe\u7f6e\u4e3a\u3002<code>/display_planned_path</code></li> <li>\u5728\u8ba1\u5212\u8bf7\u6c42\u4e2d\uff0c\u5c06\u8ba1\u5212\u7ec4\u66f4\u6539\u4e3a<code>panda_arm</code>\u3002\u60a8\u8fd8\u53ef\u4ee5\u5728\u5de6\u4e0b\u89d2\u7684 MotionPlanning \u9762\u677f\u4e2d\u770b\u5230\u8fd9\u4e00\u70b9\u3002</li> </ul> <p></p>"},{"location":"%E6%99%BA%E8%83%BDAI/ROS2/moveit/02_MoveIt%20Quickstart%20in%20RViz/#2","title":"\u7b2c 2 \u6b65\uff1a\u73a9\u53ef\u89c6\u5316\u673a\u5668\u4eba\uf0c1","text":"<p>\u6709\u56db\u79cd\u4e0d\u540c\u7684\u91cd\u53e0\u53ef\u89c6\u5316\uff1a</p> <ol> <li>\u673a\u5668\u4eba\u5728<code>/monitored_planning_scene</code>\u89c4\u5212\u73af\u5883\u4e2d\u7684\u914d\u7f6e\uff08\u9ed8\u8ba4\u5904\u4e8e\u6d3b\u52a8\u72b6\u6001\uff09\u3002</li> <li>\u673a\u5668\u4eba\u7684\u89c4\u5212\u8def\u5f84\uff08\u9ed8\u8ba4\u5904\u4e8e\u6d3b\u52a8\u72b6\u6001\uff09\u3002</li> <li>\u7eff\u8272\uff1a\u8fd0\u52a8\u89c4\u5212\u7684\u5f00\u59cb\u72b6\u6001\uff08\u9ed8\u8ba4\u7981\u7528\uff09\u3002</li> <li>\u6a59\u8272\uff1a\u8fd0\u52a8\u89c4\u5212\u7684\u76ee\u6807\u72b6\u6001\uff08\u9ed8\u8ba4\u5904\u4e8e\u6d3b\u52a8\u72b6\u6001\uff09\u3002</li> </ol> <p>\u53ef\u4ee5\u4f7f\u7528\u590d\u9009\u6846\u6253\u5f00\u548c\u5173\u95ed\u6bcf\u4e2a\u53ef\u89c6\u5316\u7684\u663e\u793a\u72b6\u6001\uff1a</p> <ol> <li>\u4f7f\u7528\u201c\u573a\u666f\u673a\u5668\u4eba\u201d\u6811\u83dc\u5355\u4e2d\u7684\u201c\u663e\u793a\u673a\u5668\u4eba\u89c6\u89c9\u201d\u590d\u9009\u6846\u89c4\u5212\u573a\u666f\u673a\u5668\u4eba\u3002</li> <li>\u4f7f\u7528\u201c\u89c4\u5212\u8def\u5f84\u201d\u6811\u83dc\u5355\u4e2d\u7684\u201c\u663e\u793a\u673a\u5668\u4eba\u89c6\u89c9\u201d\u590d\u9009\u6846\u6765\u89c4\u5212\u8def\u5f84\u3002</li> <li>\u4f7f\u7528\u89c4\u5212\u8bf7\u6c42\u6811\u83dc\u5355\u4e2d\u7684\u67e5\u8be2\u5f00\u59cb\u72b6\u6001\u590d\u9009\u6846\u7684\u5f00\u59cb\u72b6\u6001\u3002</li> <li> <p>\u4f7f\u7528\u8ba1\u5212\u8bf7\u6c42\u6811\u83dc\u5355\u4e2d\u7684\u67e5\u8be2\u76ee\u6807\u72b6\u6001\u590d\u9009\u6846\u7684\u76ee\u6807\u72b6\u6001\u3002</p> </li> <li> <p>\u4f7f\u7528\u6240\u6709\u8fd9\u4e9b\u590d\u9009\u6846\u6765\u6253\u5f00\u548c\u5173\u95ed\u4e0d\u540c\u7684\u53ef\u89c6\u5316\u6548\u679c\u3002</p> </li> </ol> <p></p>"},{"location":"%E6%99%BA%E8%83%BDAI/ROS2/moveit/02_MoveIt%20Quickstart%20in%20RViz/#_2","title":"\u7b2c\u4e09\u6b65\uff1a\u4e0e\u718a\u732b\u4e92\u52a8\uf0c1","text":"<p>\u5bf9\u4e8e\u63a5\u4e0b\u6765\u7684\u6b65\u9aa4\uff0c\u6211\u4eec\u53ea\u9700\u8981\u573a\u666f\u673a\u5668\u4eba\u3001\u5f00\u59cb\u72b6\u6001\u548c\u76ee\u6807\u72b6\u6001\uff1a</p> <ol> <li>\u9009\u4e2d\u89c4\u5212\u8def\u5f84\u6811\u83dc\u5355\u4e2d\u7684\u663e\u793a\u673a\u5668\u4eba\u89c6\u89c9\u590d\u9009\u6846</li> <li>\u53d6\u6d88\u9009\u4e2d\u573a\u666f\u673a\u5668\u4eba\u6811\u83dc\u5355\u4e2d\u7684\u663e\u793a\u673a\u5668\u4eba\u89c6\u89c9\u590d\u9009\u6846</li> <li>\u9009\u4e2d\u89c4\u5212\u8bf7\u6c42\u6811\u83dc\u5355\u4e2d\u7684\u67e5\u8be2\u76ee\u6807\u72b6\u6001\u590d\u9009\u6846\u3002</li> <li>\u9009\u4e2d\u89c4\u5212\u8bf7\u6c42\u6811\u83dc\u5355\u4e2d\u7684\u67e5\u8be2\u5f00\u59cb\u72b6\u6001\u590d\u9009\u6846\u3002</li> </ol> <p>\u73b0\u5728\u5e94\u8be5\u6709\u4e24\u4e2a\u4ea4\u4e92\u5f0f\u6807\u8bb0\u3002\u4e0e\u6a59\u8272\u624b\u81c2\u76f8\u5bf9\u5e94\u7684\u4e00\u4e2a\u6807\u8bb0\u5c06\u7528\u4e8e\u8bbe\u7f6e\u8fd0\u52a8\u89c4\u5212\u7684\u201c\u76ee\u6807\u72b6\u6001\u201d\uff0c\u4e0e\u7eff\u8272\u624b\u81c2\u76f8\u5bf9\u5e94\u7684\u53e6\u4e00\u4e2a\u6807\u8bb0\u5c06\u7528\u4e8e\u8bbe\u7f6e\u8fd0\u52a8\u89c4\u5212\u7684\u201c\u5f00\u59cb\u72b6\u6001\u201d\u3002\u5982\u679c\u60a8\u6ca1\u6709\u770b\u5230\u4ea4\u4e92\u6807\u8bb0\uff0c\u8bf7\u6309RViz \u9876\u90e8\u83dc\u5355\u4e2d\u7684\u201c\u4ea4\u4e92\u201d \uff08\u6ce8\u610f\uff1a\u67d0\u4e9b\u5de5\u5177\u53ef\u80fd\u4f1a\u88ab\u9690\u85cf\uff0c\u8bf7\u6309\u9876\u90e8\u83dc\u5355\u4e2d\u7684\u201c+\u201d\u6dfb\u52a0\u4ea4\u4e92\u5de5\u5177\uff0c\u5982\u4e0b\u6240\u793a\uff09\u3002</p> <p></p> <p>\u60a8\u73b0\u5728\u5e94\u8be5\u80fd\u591f\u4f7f\u7528\u8fd9\u4e9b\u6807\u8bb0\u6765\u62d6\u52a8\u624b\u81c2\u5e76\u66f4\u6539\u5176\u65b9\u5411\u3002\u5c1d\u8bd5\u4e00\u4e0b\uff01</p>"},{"location":"%E6%99%BA%E8%83%BDAI/ROS2/moveit/02_MoveIt%20Quickstart%20in%20RViz/#_3","title":"\u8fdb\u5165\u78b0\u649e\u72b6\u6001\uf0c1","text":"<p>\u5bf9\u4e8e\u672c\u90e8\u5206\uff0c\u9690\u85cf\u8ba1\u5212\u8def\u5f84\u548c\u76ee\u6807\u72b6\u6001\uff1a</p> <ol> <li>\u53d6\u6d88\u9009\u4e2d\u89c4\u5212\u8def\u5f84\u6811\u83dc\u5355\u4e2d\u7684\u663e\u793a\u673a\u5668\u4eba\u89c6\u89c9\u590d\u9009\u6846</li> <li>\u53d6\u6d88\u9009\u4e2d\u89c4\u5212\u8bf7\u6c42\u6811\u83dc\u5355\u4e2d\u7684\u67e5\u8be2\u76ee\u6807\u72b6\u6001\u590d\u9009\u6846\u3002</li> </ol> <p>\u73b0\u5728\uff0c\u53ea\u6709\u201c\u5f00\u59cb\u72b6\u6001\u201d\uff08\u7eff\u8272\u81c2\uff09\u5e94\u8be5\u53ef\u89c1\u3002\u5c1d\u8bd5\u5c06\u624b\u81c2\u79fb\u52a8\u5230\u5176\u4e24\u4e2a\u8fde\u6746\u76f8\u4e92\u78b0\u649e\u7684\u914d\u7f6e\u3002 \uff08\u5982\u679c\u60a8\u53d1\u73b0\u8fd9\u5f88\u56f0\u96be\uff0c\u8bf7\u786e\u4fdd\u672a\u9009\u4e2d MotionPlanning \u63d2\u4ef6\u7684\u89c4\u5212\u9009\u9879\u5361\u4e0b\u7684\u201c\u4f7f\u7528\u78b0\u649e\u611f\u77e5 IK\u201d\u590d\u9009\u6846\u3002\uff09\u6267\u884c\u6b64\u64cd\u4f5c\u540e\uff0c\u53d1\u751f\u78b0\u649e\u7684\u94fe\u63a5\u5c06\u53d8\u4e3a\u7ea2\u8272\u3002</p> <p></p> <p>\u73b0\u5728\uff0c\u9009\u4e2d\u201c\u4f7f\u7528\u78b0\u649e\u611f\u77e5 IK\u201d\u590d\u9009\u6846\uff0c\u5e76\u518d\u6b21\u5c1d\u8bd5\u5c06\u4e24\u4e2a\u94fe\u63a5\u79fb\u52a8\u5230\u5f7c\u6b64\u78b0\u649e\u3002\u52fe\u9009\u8be5\u590d\u9009\u6846\u540e\uff0cIK \u89e3\u7b97\u5668\u5c06\u7ee7\u7eed\u5c1d\u8bd5\u4e3a\u6240\u9700\u7684\u672b\u7aef\u6267\u884c\u5668\u59ff\u52bf\u627e\u5230\u65e0\u78b0\u649e\u89e3\u51b3\u65b9\u6848\u3002\u5982\u679c\u672a\u9009\u4e2d\uff0c\u89e3\u7b97\u5668\u5c06\u5141\u8bb8\u89e3\u51b3\u65b9\u6848\u4e2d\u53d1\u751f\u78b0\u649e\u3002\u65e0\u8bba\u590d\u9009\u6846\u7684\u72b6\u6001\u5982\u4f55\uff0c\u53d1\u751f\u51b2\u7a81\u7684\u94fe\u63a5\u59cb\u7ec8\u4f1a\u663e\u793a\u4e3a\u7ea2\u8272\u3002</p> <p></p>"},{"location":"%E6%99%BA%E8%83%BDAI/ROS2/moveit/02_MoveIt%20Quickstart%20in%20RViz/#_4","title":"\u79fb\u51fa\u53ef\u5230\u8fbe\u7684\u5de5\u4f5c\u7a7a\u95f4\uf0c1","text":"<p>\u8bf7\u6ce8\u610f\u5f53\u60a8\u5c1d\u8bd5\u5c06\u672b\u7aef\u6267\u884c\u5668\u79fb\u51fa\u5176\u53ef\u5230\u8fbe\u7684\u5de5\u4f5c\u7a7a\u95f4\u65f6\u4f1a\u53d1\u751f\u4ec0\u4e48\u3002</p> <p></p> <p>\u5728\u8fdb\u5165\u4e0b\u4e00\u90e8\u5206\u4e4b\u524d\uff0c\u91cd\u65b0\u542f\u7528\u8ba1\u5212\u8def\u5f84\u548c\u76ee\u6807\u72b6\u6001\uff1a</p> <ol> <li>\u9009\u4e2d\u89c4\u5212\u8def\u5f84\u6811\u83dc\u5355\u4e2d\u7684\u663e\u793a\u673a\u5668\u4eba\u89c6\u89c9\u590d\u9009\u6846</li> <li>\u9009\u4e2d\u89c4\u5212\u8bf7\u6c42\u6811\u83dc\u5355\u4e2d\u7684\u67e5\u8be2\u76ee\u6807\u72b6\u6001\u590d\u9009\u6846\u3002</li> </ol>"},{"location":"%E6%99%BA%E8%83%BDAI/ROS2/moveit/02_MoveIt%20Quickstart%20in%20RViz/#_5","title":"\u79fb\u52a8\u5173\u8282\u6216\u5728\u96f6\u7a7a\u95f4\u4e2d\uf0c1","text":"<p>\u60a8\u53ef\u4ee5\u4f7f\u7528\u201c\u5173\u8282\u201d\u9009\u9879\u5361\u79fb\u52a8 7-DOF \u673a\u5668\u4eba\u7684\u5355\u4e2a\u5173\u8282\u548c\u5197\u4f59\u5173\u8282\u3002\u5c1d\u8bd5\u79fb\u52a8\u201c\u96f6\u7a7a\u95f4\u63a2\u7d22\u201d\u6ed1\u5757\uff0c\u5982\u4e0b\u9762\u7684\u52a8\u753b\u6240\u793a\u3002</p>"},{"location":"%E6%99%BA%E8%83%BDAI/ROS2/moveit/02_MoveIt%20Quickstart%20in%20RViz/#4-panda","title":"\u7b2c 4 \u6b65\uff1a\u5bf9 Panda \u4f7f\u7528\u8fd0\u52a8\u89c4\u5212\uf0c1","text":"<ul> <li>\u73b0\u5728\uff0c\u60a8\u53ef\u4ee5\u5728 MoveIt RViz \u63d2\u4ef6\u4e2d\u4f7f\u7528 Panda \u5f00\u59cb\u8fd0\u52a8\u89c4\u5212\u3002</li> <li>\u5c06\u5f00\u59cb\u72b6\u6001\u79fb\u52a8\u5230\u6240\u9700\u4f4d\u7f6e\u3002</li> <li>\u5c06\u76ee\u6807\u72b6\u6001\u79fb\u52a8\u5230\u53e6\u4e00\u4e2a\u6240\u9700\u4f4d\u7f6e\u3002</li> <li>\u786e\u4fdd\u8fd9\u4e24\u79cd\u72b6\u6001\u90fd\u4e0d\u4f1a\u4e0e\u673a\u5668\u4eba\u672c\u8eab\u53d1\u751f\u78b0\u649e\u3002</li> <li>\u786e\u4fdd\u8ba1\u5212\u8def\u5f84\u88ab\u53ef\u89c6\u5316\u3002\u53e6\u8bf7\u9009\u4e2d \u201c\u89c4\u5212\u8def\u5f84\u201d\u6811\u83dc\u5355\u4e2d\u7684\u201c\u663e\u793a\u8f68\u8ff9\u201d\u590d\u9009\u6846\u3002</li> <li>\u5728\u201cMotionPlanning\u201d\u7a97\u53e3\u7684\u201c\u89c4\u5212\u201d\u9009\u9879\u5361\u4e0b\uff0c\u6309\u201c\u89c4\u5212\u201d\u6309\u94ae\u3002\u60a8\u5e94\u8be5\u80fd\u591f\u770b\u5230\u624b\u81c2\u79fb\u52a8\u548c\u8f68\u8ff9\u7684\u53ef\u89c6\u5316\u3002</li> </ul>"},{"location":"%E6%99%BA%E8%83%BDAI/ROS2/moveit/02_MoveIt%20Quickstart%20in%20RViz/#_6","title":"\u5185\u7701\u8f68\u8ff9\u8def\u70b9\uf0c1","text":"<p>\u60a8\u53ef\u4ee5\u5728 RViz \u4e2d\u9010\u70b9\u76f4\u89c2\u5730\u5185\u7701\u8f68\u8ff9\u3002</p> <ul> <li>\u4ece\u201c\u9762\u677f\u201d\u83dc\u5355\u4e2d\uff0c\u9009\u62e9\u201c\u8f68\u8ff9 - \u8f68\u8ff9\u6ed1\u5757\u201d\u3002\u60a8\u5c06\u5728 RViz \u4e0a\u770b\u5230\u4e00\u4e2a\u65b0\u7684\u6ed1\u5757\u9762\u677f\u3002</li> <li>\u8bbe\u7f6e\u60a8\u7684\u76ee\u6807\u59ff\u52bf\uff0c\u7136\u540e\u8fd0\u884cPlan\u3002</li> <li>\u4f7f\u7528\u201c\u6ed1\u5757\u201d\u9762\u677f\u8fdb\u884c\u64ad\u653e\uff0c\u4f8b\u5982\u79fb\u52a8\u6ed1\u5757\uff0c\u6309\u201c\u64ad\u653e\u201d\u6309\u94ae\u3002</li> </ul> <p>\u6ce8\u610f\uff1a\u5c06 EEF \u8bbe\u7f6e\u4e3a\u65b0\u76ee\u6807\u540e\uff0c\u8bf7\u52a1\u5fc5\u5728\u8fd0\u884c\u201c\u64ad\u653e\u201d\u4e4b\u524d\u8fd0\u884c\u201c\u8ba1\u5212\u201d \u2014\u2014\u5426\u5219\u60a8\u5c06\u770b\u5230\u4e0a\u4e00\u4e2a\u76ee\u6807\u7684\u822a\u8def\u70b9\uff08\u5982\u679c\u6709\uff09\u3002</p> <p></p>"},{"location":"%E6%99%BA%E8%83%BDAI/ROS2/moveit/02_MoveIt%20Quickstart%20in%20RViz/#_7","title":"\u89c4\u5212\u7b1b\u5361\u5c14\u8fd0\u52a8\uf0c1","text":"<p>\u5982\u679c\u6fc0\u6d3b\u201c\u4f7f\u7528\u7b1b\u5361\u5c14\u8def\u5f84\u201d\u590d\u9009\u6846\uff0c\u673a\u5668\u4eba\u5c06\u5c1d\u8bd5\u5728\u7b1b\u5361\u5c14\u7a7a\u95f4\u4e2d\u7ebf\u6027\u79fb\u52a8\u672b\u7aef\u6267\u884c\u5668\u3002</p> <p> </p>"},{"location":"%E6%99%BA%E8%83%BDAI/ROS2/moveit/02_MoveIt%20Quickstart%20in%20RViz/#_8","title":"\u6267\u884c\u8f68\u8ff9\u3001\u8c03\u6574\u901f\u5ea6\uf0c1","text":"<p>\u8ba1\u5212\u6210\u529f\u540e\u70b9\u51fb\u201c\u8ba1\u5212\u5e76\u6267\u884c\u201d\u6216\u201c\u6267\u884c\u201d\u4f1a\u5c06\u8f68\u8ff9\u53d1\u9001\u7ed9\u673a\u5668\u4eba\u2014\u2014\u5728\u672c\u6559\u7a0b\u4e2d\uff0c\u7531\u4e8e\u60a8\u4f7f\u7528\u4e86<code>demo.launch</code>\uff0c\u56e0\u6b64\u4ec5\u6a21\u62df\u673a\u5668\u4eba\u3002</p> <p>\u6700\u521d\uff0c\u9ed8\u8ba4\u901f\u5ea6\u548c\u52a0\u901f\u5ea6\u7f29\u653e\u4e3a<code>0.1</code>\u673a\u5668\u4eba\u6700\u5927\u503c\u7684 10% ( )\u3002\u60a8\u53ef\u4ee5\u5728\u5982\u4e0b\u6240\u793a\u7684\u201c\u89c4\u5212\u201d\u9009\u9879\u5361\u4e2d\u66f4\u6539\u8fd9\u4e9b\u7f29\u653e\u7cfb\u6570\uff0c\u6216\u5728<code>moveit_config</code>\u673a\u5668\u4eba\u7684\uff08\u5728<code>joint_limits.yaml</code>\uff09\u4e2d\u66f4\u6539\u8fd9\u4e9b\u9ed8\u8ba4\u503c\u3002</p> <p></p>"},{"location":"%E6%99%BA%E8%83%BDAI/ROS2/moveit/02_MoveIt%20Quickstart%20in%20RViz/#_9","title":"\u4e0b\u4e00\u6b65\uf0c1","text":""},{"location":"%E6%99%BA%E8%83%BDAI/ROS2/moveit/02_MoveIt%20Quickstart%20in%20RViz/#rviz","title":"RViz \u53ef\u89c6\u5316\u5de5\u5177\uf0c1","text":"<p>\u8bb8\u591a\u6559\u7a0b\u90fd\u7528\u6765<code>moveit_visual_tools</code>\u9010\u6b65\u5b8c\u6210\u6f14\u793a\u3002\u5728\u7ee7\u7eed\u5b66\u4e60\u4e0b\u4e00\u4e2a\u6559\u7a0b\u4e4b\u524d\uff0c\u6700\u597d\u542f\u7528RvizVisualToolsGui\u3002</p> <p>\u4ece\u201c\u9762\u677f\u201d\u83dc\u5355\u4e2d\uff0c\u9009\u62e9\u201c\u6dfb\u52a0\u65b0\u9762\u677f\u201d\u3002\u4ece\u83dc\u5355\u4e2d\u9009\u62e9\u201c RvizVisualToolsGui \u201d\u5e76\u5355\u51fb\u201c\u786e\u5b9a\u201d\u3002\u60a8\u5c06\u770b\u5230\u6dfb\u52a0\u5230 RViz \u7684\u65b0\u9762\u677f\u3002</p> <p> </p>"},{"location":"%E6%99%BA%E8%83%BDAI/ROS2/moveit/02_MoveIt%20Quickstart%20in%20RViz/#_10","title":"\u4fdd\u5b58\u60a8\u7684\u914d\u7f6e\uf0c1","text":"<p>RViz \u4f7f\u60a8\u80fd\u591f\u5c06\u914d\u7f6e\u4fdd\u5b58\u5728.\u60a8\u5e94\u8be5\u5728\u7ee7\u7eed\u5b66\u4e60\u4e0b\u4e00\u4e2a\u6559\u7a0b\u4e4b\u524d\u6267\u884c\u6b64\u64cd\u4f5c\u3002\u5982\u679c\u60a8\u9009\u62e9\u4ee5\u65b0\u540d\u79f0\u4fdd\u5b58\u914d\u7f6e\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u6765\u4f7f\u7528\u548c\u5f15\u7528\u60a8\u7684\u914d\u7f6e\u6587\u4ef6\uff1a<code>File-&gt;Save Config``File-&gt;Save Config As</code></p> <pre><code>ros2 launch moveit2_tutorials demo.launch.py rviz_config:=your_rviz_config.rviz\n</code></pre> <p>\u66ff\u6362<code>your_rviz_config.rviz</code>\u4e3a\u60a8\u4fdd\u5b58\u7684\u6587\u4ef6\u7684\u540d\u79f0<code>moveit2_tutorials/doc/tutorials/quickstart_in_rviz/launch/</code>\u5e76\u6784\u5efa\u5de5\u4f5c\u533a\u4ee5\u4fbf\u53ef\u4ee5\u627e\u5230\u5b83\u3002</p>"},{"location":"%E6%99%BA%E8%83%BDAI/ROS2/moveit/02_MoveIt%20Quickstart%20in%20RViz/#_11","title":"\u4e0b\u4e00\u4e2a\u6559\u7a0b\uf0c1","text":"<p>\u5728\u60a8\u7684\u7b2c\u4e00\u4e2a MoveIt \u9879\u76ee\u4e2d\uff0c\u60a8\u5c06\u4f7f\u7528 MoveIt \u521b\u5efa\u4e00\u4e2a C++ \u7a0b\u5e8f\u6765\u8ba1\u5212\u548c\u6267\u884c\u79fb\u52a8\u3002</p>"},{"location":"%E6%99%BA%E8%83%BDAI/YOLO/Python%E4%B8%8EOpencv%E9%85%8D%E7%BD%AE%E5%AE%89%E8%A3%85/","title":"Python\u4e0eOpencv\u914d\u7f6e\u5b89\u88c5","text":""},{"location":"%E6%99%BA%E8%83%BDAI/YOLO/Python%E4%B8%8EOpencv%E9%85%8D%E7%BD%AE%E5%AE%89%E8%A3%85/#_1","title":"Python\u4e0eOpencv\u914d\u7f6e\u5b89\u88c5","text":""},{"location":"%E6%99%BA%E8%83%BDAI/YOLO/Python%E4%B8%8EOpencv%E9%85%8D%E7%BD%AE%E5%AE%89%E8%A3%85/#conda","title":"\u73af\u5883conda\u5b89\u88c5","text":"<pre><code># anaconda\u4e0b\u8f7d\u5b89\u88c5\nwget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh\n\npip install opencv-python\npip install opencv-contrib-python\n\n# conda\u73af\u5883\u642d\u5efa\nconda create -n ultralytics python=3.9\n\n\n</code></pre> <pre><code># \u6570\u636e\u8bfb\u53d6-\u56fe\u50cf\ncv2.IMREAD_COLOR        # \u5f69\u8272\u56fe\u50cf\nCV2.IMREAD_GRAYSCALE    # \u7070\u5ea6\u56fe\u50cf\n</code></pre> <pre><code># \u6570\u636e\u96c6\nhttps://public.roboflow.com\n</code></pre> <pre><code># \u68c0\u6d4b YOLOv8\n\u6293\u53d6\u70b9     graspnet\n\n</code></pre>"},{"location":"%E6%99%BA%E8%83%BDAI/YOLO/yolov8%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/","title":"Yolov8\u73af\u5883\u642d\u5efa","text":""},{"location":"%E6%99%BA%E8%83%BDAI/YOLO/yolov8%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#_1","title":"Yolov8\u73af\u5883\u642d\u5efa","text":""},{"location":"%E6%99%BA%E8%83%BDAI/YOLO/yolov8%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#yolo","title":"\u73af\u5883yolo\u5b89\u88c5","text":"<pre><code>1.\u663e\u5361\u9a71\u52a8\u67e5\u770b\nnvidia-smi\n\n2.yolo\u6e90\u7801\u4e0e\u6a21\u578b\nhttps://hub.nuaa.cf/ultralytics/ultralytics\nhttps://github.com/ultralytics/ultralytics\n\n3.anaconda\nhttps://www.anaconda.com/download\nhttps://repo.anaconda.com/miniconda/Miniconda3-latest-Windows-x86_64.exe\n\u73af\u5883\u53d8\u91cf\uff1a\nC:\\ProgramData\\miniconda3\nC:\\ProgramData\\miniconda3\\Scripts\nC:\\ProgramData\\miniconda3\\Library\\bin\n\n4.\u521b\u5efapython\u73af\u5883\nconda create -n yolo python==3.8\n\u67e5\u770b\u73b0\u6709\u73af\u5883\nconda env list\n\u6fc0\u6d3b\u73af\u5883\nconda activate yolo\n\u6fc0\u6d3b\u5931\u8d25\nconda init cmd.exe\n\u5220\u9664\u73af\u5883\nconda env remove -n yolo\n\n5.\u5b89\u88c5\u5e93\npip3 install -i https://pypi.tuna.tsinghua.edu.cn/simple torch torchvision torchaudio   # CPU\npip3 install torch torchvision torchaudio --index-url  #GUP https://download.pytorch.org/whl/cu118\npip install ultralytics -i https://pypi.tuna.tsinghua.edu.cn/simple\npip install onnx -i https://pypi.tuna.tsinghua.edu.cn/simple\npip install onnxsim -i https://pypi.tuna.tsinghua.edu.cn/simple\npip install onnxruntime -i https://pypi.tuna.tsinghua.edu.cn/simple\n\n\n\u4fee\u6539\u8f93\u51fa\u7ef4\u5ea6\ngitub\u955c\u50cf\u4e0b\u8f7d\u5730\u5740:https://hub.nuaa.cf/shouxieai/infer\npython v8trans.py best.onnx\n\n\u63a8\u7406\u68c0\u6d4b\nyolo predict model=yolov8n.pt source=4.png\n\n\n\n</code></pre> <p>YOLOv8n \u6a21\u578b\u5bfc\u51fa\u4e3a\u4e0d\u540c\u7684\u683c\u5f0f</p> <pre><code>from ultralytics import YOLO\n\n# Load a model\nmodel = YOLO('yolov8n.pt')  # load an official model\nmodel = YOLO('path/to/best.pt')  # load a custom trained model\n\n# Export the model\nmodel.export(format='onnx')\n</code></pre> <pre><code>yolo export model=yolov8n.pt format=onnx  # export official model\nyolo export model=path/to/best.pt format=onnx  # export custom trained model\n</code></pre> <pre><code>pip3 install -i https://pypi.tuna.tsinghua.edu.cn/simple ultralytics\npip3 install -i https://pypi.tuna.tsinghua.edu.cn/simple onnx\npip3 install -i https://pypi.tuna.tsinghua.edu.cn/simple onnxruntime\n</code></pre> <p>yolo detect train data=coco8.yaml model=yolov8n.pt epochs=100 imgsz=640</p>"},{"location":"%E6%99%BA%E8%83%BDAI/YOLO/yolov8%E9%A2%84%E6%B5%8B%E4%BB%A3%E7%A0%81/","title":"Yolov8\u9884\u6d4b\u4ee3\u7801","text":""},{"location":"%E6%99%BA%E8%83%BDAI/YOLO/yolov8%E9%A2%84%E6%B5%8B%E4%BB%A3%E7%A0%81/#onnx","title":"\u73af\u5883onnx\u5b89\u88c5","text":"<pre><code>import cv2\nfrom ultralytics import YOLO\n\n# Load the YOLOv8 model\nmodel = YOLO('yolov8n.onnx', task='detect')\n\n# HTTP stream URL\nstream_url = \"http://dsm.t-plus.com.cn:7088/udp/238.255.2.16:5999\"\n\n# Open the video stream\ncap = cv2.VideoCapture(stream_url)\n\nwhile cap.isOpened():\n    # Read a frame from the stream\n    success, frame = cap.read()\n\n    if success:\n        # Run YOLOv8 inference on the frame\n        results = model(frame)\n\n        # Process results list\n        for result in results:\n            pass\n            # print(result.boxes.xywhn)\n            # print(result.probs)\n\n        # Visualize the results on the frame\n        annotated_frame = results[0].plot()\n\n        # Display the annotated frame\n        cv2.imshow(\"YOLOv8 Inference\", annotated_frame)\n\n        # Break the loop if 'q' is pressed\n        if cv2.waitKey(1) &amp; 0xFF == ord(\"q\"):\n            break\n    else:\n        # Break the loop if the end of the stream is reached or there's an error\n        break\n\n# Release the video capture object and close the display window\ncap.release()\ncv2.destroyAllWindows()\n</code></pre> <p>YOLOv8n \u6a21\u578b\u5bfc\u51fa\u4e3a\u4e0d\u540c\u7684\u683c\u5f0f</p> <pre><code>from ultralytics import YOLO\n\n# Load a model\nmodel = YOLO('yolov8n.pt')  # load an official model\nmodel = YOLO('path/to/best.pt')  # load a custom trained model\n\n# Export the model\nmodel.export(format='onnx')\n</code></pre> <pre><code>yolo export model=yolov8n.pt format=onnx  # export official model\nyolo export model=path/to/best.pt format=onnx  # export custom trained model\n</code></pre> <pre><code>pip3 install -i https://pypi.tuna.tsinghua.edu.cn/simple ultralytics\npip3 install -i https://pypi.tuna.tsinghua.edu.cn/simple onnx\npip3 install -i https://pypi.tuna.tsinghua.edu.cn/simple onnxruntime\n</code></pre> <p>yolo detect train data=coco8.yaml model=yolov8n.pt epochs=100 imgsz=640</p>"},{"location":"%E6%99%BA%E8%83%BDAI/gazebo/demo/","title":"Ubuntu \u4e0a\u7684\u4e8c\u8fdb\u5236\u5b89\u88c5","text":"<p>*\u9700\u8981\u5173\u95ed\u865a\u62df\u673a3d\u52a0\u901f***</p> <p>Fortress \u4e8c\u8fdb\u5236\u6587\u4ef6\u9002\u7528\u4e8e Ubuntu Bionic\u3001Focal \u548c Jammy\u3002\u6240\u6709 Fortress \u4e8c\u8fdb\u5236\u6587\u4ef6\u90fd\u6258\u7ba1\u5728 osrfoundation \u5b58\u50a8\u5e93\u4e2d\u3002\u8981\u5b89\u88c5\u6240\u6709\u8fd9\u4e9b\uff0c<code>ignition-fortress</code>\u53ef\u4ee5\u5b89\u88c5\u5143\u5305\u3002</p> <p>\u9996\u5148\u5b89\u88c5\u4e00\u4e9b\u5fc5\u8981\u7684\u5de5\u5177\uff1a</p> <pre><code>sudo apt-get update sudo apt-get install lsb-release wget gnupg\n</code></pre> <p>\u7136\u540e\u5b89\u88c5Ignition Fortress:</p> <pre><code>sudo wget https://packages.osrfoundation.org/gazebo.gpg -O /usr/share/keyrings/pkgs-osrf-archive-keyring.gpg echo \"deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/pkgs-osrf-archive-keyring.gpg] http://packages.osrfoundation.org/gazebo/ubuntu-stable $(lsb_release -cs) main\" | sudo tee /etc/apt/sources.list.d/gazebo-stable.list &gt; /dev/null sudo apt-get update sudo apt-get install ignition-fortress\n</code></pre> <p>\u6240\u6709\u5e93\u90fd\u5e94\u8be5\u51c6\u5907\u597d\u4f7f\u7528\uff0c\u5e76\u4e14<code>ign gazebo</code>\u5e94\u7528\u7a0b\u5e8f\u5e94\u8be5\u51c6\u5907\u597d\u6267\u884c\u3002</p> <pre><code>\n</code></pre> <p>\u8fd4\u56de\u5165\u95e8 \u9875\u9762\u5f00\u59cb\u4f7f\u7528 Ignition\uff01</p> <p>Launch Gazebo by running:</p> <pre><code>gz sim shapes.sdf  # Fortress and Citadel use \"ign gazebo\" instead of \"gz sim\"\n</code></pre>"},{"location":"%E6%99%BA%E8%83%BDAI/gazebo/demo/#_1","title":"\u5378\u8f7d\u4e8c\u8fdb\u5236\u5b89\u88c5","text":"<p>\u5982\u679c\u60a8\u5728\u4ece\u4e8c\u8fdb\u5236\u6587\u4ef6\u5b89\u88c5\u5e93\u540e\u9700\u8981\u5378\u8f7d Ignition \u6216\u5207\u6362\u5230\u57fa\u4e8e\u6e90\u7684\u5b89\u88c5\uff0c\u8bf7\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>sudo apt remove ignition-fortress &amp;&amp; sudo apt autoremove\n</code></pre> <pre><code># \u5b89\u88c5gazebo ubuntu22.04 ros-humble\nsudo apt-get install ros-${ROS_DISTRO}-ros-gz\n\n\n\nsudo wget https://packages.osrfoundation.org/gazebo.gpg -O /usr/share/keyrings/pkgs-osrf-archive-keyring.gpg\necho \"deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/pkgs-osrf-archive-keyring.gpg] http://packages.osrfoundation.org/gazebo/ubuntu-stable $(lsb_release -cs) main\" | sudo tee /etc/apt/sources.list.d/gazebo-stable.list &gt; /dev/null\nsudo apt-get update\nsudo apt-get install gz-harmonic\n</code></pre> <pre><code>\n\n# gazebosim\nhttps://github.com/gazebosim/gz-sim\n\nhttps://gazebosim.org/api/sim/8/classgz_1_1sim_1_1systems_1_1MecanumDrive.html\n</code></pre> <p>Gazebo\u4e2d\u6a21\u62df\u4e00\u4e2a\u7b80\u5355\u7684\u5dee\u52a8\u9a71\u52a8\u673a\u5668\u4eba</p> <pre><code># \u542f\u52a8\u6a21\u62df\nign gazebo -v 4 -r visualize_lidar.sdf\n\n# \u547d\u4ee4\u884c\u68c0\u67e5Gazebo\u63d0\u4f9b\u7684\u4e3b\u9898\nign topic -l\n\n# \u5b89\u88c5ros_gz_bridge\u8ba9\u4eff\u771f\u4e0eros2\u901a\u4fe1\nsudo apt install ros-humble-ros-ign-bridge -y\n\n# \u542f\u52a8\u4e00\u4e2a\u4eceROS\u5230Gazebo\u7684\u6865\u63a5\u5668\nsource /opt/ros/humble/setup.bash\nros2 run ros_gz_bridge parameter_bridge /model/vehicle_blue/cmd_vel@geometry_msgs/msg/Twist]ignition.msgs.Twist\n\n\n# \u4f7f\u7528ros2 topic pub\u5411\u4e3b\u9898\u53d1\u9001\u547d\u4ee4\nros2 topic pub /model/vehicle_blue/cmd_vel geometry_msgs/Twist \"linear: { x: 0.1 }\"\n\n# \u4f7f\u7528\u952e\u76d8\u5411\u4e3b\u9898\u53d1\u9001\u547d\u4ee4\nsource /opt/ros/humble/setup.bash\nros2 run teleop_twist_keyboard teleop_twist_keyboard --ros-args -r /cmd_vel:=/model/vehicle_blue/cmd_vel\n</code></pre>"},{"location":"%E6%99%BA%E8%83%BDAI/gazebo/%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E/","title":"\u4f7f\u7528\u8bf4\u660e","text":"<p>Gazebo\u4e2d\u6a21\u62df\u4e00\u4e2a\u7b80\u5355\u7684\u5dee\u52a8\u9a71\u52a8\u673a\u5668\u4eba</p> <pre><code># \u7f16\u8f91 ~/.bashrc \u6587\u4ef6\uff0c\u5b9a\u4e49\u6a21\u578b\u8def\u5f84\u3002\u5192\u53f7\u53ef\u6dfb\u52a0\u591a\u4e2a\nexport GZ_SIM_RESOURCE_PATH=/usr/share/gz/gz-sim8/worlds:~/tempmodel\nexport GZ_SIM_RESOURCE_PATH=~/worlds\n# gazebo\u53f3\u4e0a\u89d2\u4e09\u4e2a\u70b9 \nGrid Config         #\u7f51\u683c\u914d\u7f6e\nResource Spawner    #\u6dfb\u52a0\u6a21\u578b\nKey Publisher       #\u952e\u76d8\u76d1\u542c\nToleop              #\u901f\u5ea6\u63a7\u5236\u5668\u63d2\u4ef6\nImage display       #\u6444\u50cf\u5934\u63d2\u4ef6\n\n</code></pre> <p>\u4ee5\u4e0b\u547d\u4ee4\u5c06 URDF \u6587\u4ef6<code>model.urdf</code>\u4f5c\u4e3a\u540d\u4e3a \u7684\u6a21\u578b\u751f\u6210\u5230 Gazebo Sim \u4e16\u754c\u4e2d<code>urdf_model</code>\uff1a</p> <pre><code>gz service -s /world/empty/create --reqtype gz.msgs.EntityFactory --reptype gz.msgs.Boolean --timeout 1000 --req 'sdf_filename: \"/path/to/model.urdf\", name: \"urdf_model\"'\n\ngz service -s /world/empty/create --reqtype gz.msgs.EntityFactory --reptype gz.msgs.Boolean --timeout 1000 --req 'sdf_filename: \"/home/bobo/worlds/mecanum_drive.sdf\", name: \"mecanum_drive\"'\n</code></pre> <pre><code># \u5b89\u88c5``ros_gz_bridge``\u7684\u8f6f\u4ef6\u5305\nsudo apt-get install ros-humble-ros-ign-bridge\n\n\u542f\u52a8\u4e00\u4e2a\u4eceROS\u5230Gazebo\u7684\u6865\u63a5\u5668\nsource /opt/ros/humble/setup.bash\nros2 run ros_gz_bridge parameter_bridge /model/vehicle_blue/cmd_vel@geometry_msgs/msg/Twist]ignition.msgs.Twist\n\n# \u4f7f\u7528``ros2 topic pub``\u5411\u4e3b\u9898\u53d1\u9001\u547d\u4ee4\nros2 topic pub /model/vehicle_blue/cmd_vel geometry_msgs/Twist \"linear: { x: 0.1 }\"\n\n</code></pre> <pre><code>&lt;!-- Moving Forward--&gt;\n&lt;plugin filename=\"gz-sim-triggered-publisher-system\"\n        name=\"gz::sim::systems::TriggeredPublisher\"&gt;\n    &lt;input type=\"gz.msgs.Int32\" topic=\"/keyboard/keypress\"&gt;\n        &lt;match field=\"data\"&gt;16777235&lt;/match&gt;\n    &lt;/input&gt;\n    &lt;output type=\"gz.msgs.Twist\" topic=\"/cmd_vel\"&gt;\n        linear: {x: 0.5}, angular: {z: 0.0}\n    &lt;/output&gt;\n&lt;/plugin&gt;\n&lt;!-- Moving Backward--&gt;\n&lt;plugin filename=\"gz-sim-triggered-publisher-system\"\n        name=\"gz::sim::systems::TriggeredPublisher\"&gt;\n    &lt;input type=\"gz.msgs.Int32\" topic=\"/keyboard/keypress\"&gt;\n        &lt;match field=\"data\"&gt;16777237&lt;/match&gt;\n    &lt;/input&gt;\n    &lt;output type=\"gz.msgs.Twist\" topic=\"/cmd_vel\"&gt;\n        linear: {x: -0.5}, angular: {z: 0.0}\n    &lt;/output&gt;\n&lt;/plugin&gt;\n\n</code></pre> <pre><code>Left \u279e 16777234 \u279e linear: {x: 0.0}, angular: {z: 0.5}\nUp \u279e 16777235 \u279e linear: {x: 0.5}, angular: {z: 0.0}\nRight \u279e 16777236 \u279e linear: {x: 0.0}, angular: {z: -0.5}\nDown \u279e 16777237 \u279e linear: {x: -0.5}, angular: {z: 0.0}\n</code></pre>"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/OpenWrt/OpenWrt%E5%90%AF%E7%94%A8https/","title":"OpenWrt\u542f\u7528https","text":""},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/OpenWrt/OpenWrt%E5%90%AF%E7%94%A8https/#openwrthttps","title":"OpenWrt\u542f\u7528https","text":"<p>\u68c0\u67e5\u662f\u5426\u5b89\u88c5uhttpd\u8f6f\u4ef6\u5305</p> <pre><code># vi /etc/config/uhttpd\n</code></pre> <p>\u4e0a\u4f20\u5e76\u4fee\u6539\u8bc1\u4e66\u6587\u4ef6</p> <pre><code>    option cert '/etc/uhttpd.cer'\n    option key '/etc/uhttpd.key'\n</code></pre> <p>\u91cd\u542fuhttpd\u670d\u52a1</p> <pre><code>/etc/init.d/uhttpd restart\n</code></pre>"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/OpenWrt/readme/","title":"Readme","text":"<p>\u4e0b\u8f7d\u5730\u5740 https://fw.koolcenter.com/iStoreOS/x86_64_efi/</p> <p>\u79d1\u5b66\u5de5\u5177 https://github.com/AUK9527/Are-u-ok/tree/main/x86</p>"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/OpenWrt/%E6%97%81%E8%B7%AF%E7%94%B1SmartDNS%E6%90%AD%E9%85%8DPassWall%E9%85%8D%E7%BD%AE/","title":"\u65c1\u8def\u7531SmartDNS\u642d\u914dPassWall\u914d\u7f6e","text":"<p>\u914d\u7f6eopenwrt</p> <pre><code>\n# DHCP/DNS - HOST\u548c\u89e3\u6790\u6587\u4ef6\n\u4f7f\u7528/etc/ethers\u914d\u7f6e \u52fe\u9009\n\u5ffd\u7565/etc/hosts \u52fe\u9009\n</code></pre> <p>vim /etc/config/smartdns</p> <pre><code>config smartdns\n    option enabled '1'\n    option server_name 'smartdns'\n    option port '6053'\n    option tcp_server '1'\n    option ipv6_server '1'\n    option dualstack_ip_selection '1'\n    option prefetch_domain '1'\n    option serve_expired '1'\n    option redirect 'none'\n    option cache_size '32768'\n    option rr_ttl '600'\n    option rr_ttl_min '300'\n    option rr_ttl_max '600'\n    option coredump '0'\n    option seconddns_enabled '1'\n    option seconddns_port '6553'\n    option seconddns_tcp_server '1'\n    option seconddns_server_group 'foreign'\n    option seconddns_no_speed_check '1'\n    option seconddns_no_rule_addr '1'\n    option seconddns_no_rule_nameserver '1'\n    option seconddns_no_rule_ipset '0'\n    option seconddns_no_rule_soa '1'\n    option seconddns_no_dualstack_selection '1'\n    option seconddns_no_cache '1'\n    option force_aaaa_soa '0'\n    list old_redirect 'none'\n    list old_port '6053'\n    list old_enabled '0'\n\nconfig server\n        option enabled '1'\n        option name 'gzdx1_udp'\n        option ip '202.98.198.167'\n        option blacklist_ip '0'\n        option type 'udp'\n        option server_group 'cn'\n\nconfig server\n        option enabled '1'\n        option name 'gzdx2_udp'\n        option ip '202.98.192.67'\n        option blacklist_ip '0'\n        option type 'udp'\n        option server_group 'cn'\n\nconfig server\n        option enabled '1'\n        option name 'ali_udp'\n        option ip '223.5.5.5'\n        option blacklist_ip '0'\n        option type 'udp'\n        option server_group 'cn'\n\nconfig server\n        option enabled '1'\n        option name 'tencent_udp'\n        option ip '119.29.29.29'\n        option blacklist_ip '0'\n        option type 'udp'\n        option server_group 'cn'\n\nconfig server\n        option enabled '1'\n        option type 'udp'\n        option name 'baidu-ipv6'\n        option ip '2400:da00::6666'\n\nconfig server\n        option enabled '1'\n        option type 'udp'\n        option name 'aliyun-ipv6'\n        option ip '2400:3200::1'\n\nconfig server\n    option enabled '1'\n    option blacklist_ip '0'\n    option name 'google'\n    option ip '8.8.8.8'\n    option type 'tcp'\n    option server_group 'foreign'\n    option addition_arg '-exclude-default-group'\n\nconfig server\n    option enabled '1'\n    option name 'cloudflare'\n    option ip '1.1.1.1'\n    option type 'tcp'\n    option server_group 'foreign'\n    option blacklist_ip '0'\n    option addition_arg '-exclude-default-group'\n\nconfig server\n    option enabled '1'\n    option name 'QUAD9'\n    option ip '9.9.9.9'\n    option type 'tcp'\n    option blacklist_ip '0'\n    option server_group 'foreign'\n    option addition_arg '-exclude-default-group'\n\n\n</code></pre> <p>passwall\u8bbe\u7f6e</p> <p>DNS\u5206\u6d41\u9009\u62e9SmartDNS</p> <p>\u56fd\u5185\u5206\u7ec4\u540d cn</p> <p>\u8fc7\u6ee4\u6a21\u5f0f \u901a\u8fc7UDP\u8bf7\u6c42DNS</p> <p>\u8fdc\u7a0bDNS 127.0.0.1:6553</p>"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/ROS%20DDNS/","title":"ROS DDNS","text":"<p>\u65b0\u5efaSystem/Scripts\uff0cname: ddnsv6</p> <pre><code>##########################################\n## RouterOS DDNS \u811a\u672c for \u963f\u91cc\u4e91 / \u817e\u8baf\u4e91 IPv6\u7248\n##\n## \u8be5 DDNS \u811a\u672c\u53ef\u81ea\u52a8 \u83b7\u53d6/\u8bc6\u522b/\u66f4\u65b0 IP \u5730\u5740\n## \u517c\u5bb9 \u963f\u91cc\u4e91 / \u817e\u8baf\u4e91 DNS\u63a5\u53e3\n##\n## \u4f5c\u8005: vibbow\n## https://vsean.net/\n##\n## \u4fee\u6539\u65e5\u671f: 2023/3/15\n##########################################\n\n# \u57df\u540d\n:local domainName \"ros.t-plus.com.cn\";\n# wan\u63a5\u53e3\u540d\u79f0\n:local wanInterface \"bridge1\";\n# \u8981\u4f7f\u7528\u7684\u670d\u52a1 (aliyun/dnspod)\n:local service \"aliyun\";\n# API\u63a5\u53e3 Access ID\n:local accessID \"LTAI5tCfeuau6HYNJoXGbW5h\";\n# API\u63a5\u53e3 Access Secret\n:local accessSecret \"ojdzwQWEeAGYAWOcCvWjcqdzgXqsrv\";\n\n# \u817e\u8baf\u4e91 (dnspod) \u8bbe\u7f6e\n#\n# \u4e00\u822c\u60c5\u51b5\u4e0b\u65e0\u9700\u8bbe\u7f6e\u6b64\u5185\u5bb9\n# \u670d\u52a1\u5668\u4f1a\u81ea\u52a8\u8bc6\u522b domainID \u548c recordID\n#\n# \u5982\u4e00\u76f4\u63d0\u793a \"\u5f53\u524d\u57df\u540d\u65e0\u6743\u9650\uff0c\u8bf7\u8fd4\u56de\u57df\u540d\u5217\u8868\u3002\"\n# \u5219\u9700\u8981\u624b\u52a8\u8bbe\u7f6e\n:local domainID \"\";\n:local recordID \"\";\n\n# ==== \u4ee5\u4e0b\u5185\u5bb9\u65e0\u9700\u4fee\u6539 ====\n# =========================\n\n:local publicIP;\n:local dnsIP;\n:local epicFail false;\n\n# \u83b7\u53d6\u5f53\u524d\u63a5\u53e3IPv6\u5730\u5740\n:do {\n  :local interfaceIP [ /ipv6 address get [ :pick [ find interface=$wanInterface global ] 0 ] address ]\n  :set $interfaceIP [ :pick $interfaceIP 0 [ :find $interfaceIP \"/\" ] ];\n\n  :set $publicIP [ :toip6 $interfaceIP ];\n} \\\non-error {\n  :set $epicFail true;\n  :log error (\"DDNSv6: Get public IP failed.\");\n}\n\n# \u83b7\u53d6\u5f53\u524d\u89e3\u6790\u7684IP\n:do {\n  :set $dnsIP [ :resolve $domainName ];\n} \\\non-error {\n  :set $epicFail true;\n  :log error (\"DDNSv6: Resolve domain \" . $domainName . \" failed.\");\n}\n\n# \u5982IP\u6709\u53d8\u52a8\uff0c\u5219\u66f4\u65b0\u89e3\u6790\n:if ($epicFail = false &amp;&amp; $publicIP != $dnsIP) \\\ndo={\n    :local callUrl (\"https://ddns6.vsean.net/ddns.php\");\n    :local postData (\"service=\" . $service . \"&amp;domain=\" . $domainName . \"&amp;access_id=\" . $accessID . \"&amp;access_secret=\" . $accessSecret . \"&amp;domain_id=\" . $domainID . \"&amp;record_id=\" . $recordID);\n    :local fetchResult [/tool fetch url=$callUrl mode=https http-method=post http-data=$postData as-value output=user];\n    :log info (\"DDNSv6: \" . $fetchResult-&gt;\"data\");\n}\n\n</code></pre> <p>\u6253\u5f00\u5e76\u4fee\u6539 PPP/Profiles/default\uff0c\u5728Scripts  /  on up\u91cc\u6dfb\u52a0 ddnsv6</p>"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/ROS%20IP%E5%88%86%E6%B5%81/","title":"ROS IP\u5206\u6d41","text":"<p>ROS IP\u5206\u6d41</p> <pre><code># \u5bfc\u5165\u4e2d\u56fdIP\u5730\u5740\u5217\u8868\n/tool fetch url=http://www.iwik.org/ipcountry/mikrotik/CN\n/import file-name=CN\n\n# \u65b0\u5efaRouting/Tables\n\n</code></pre> <p>\u65b0\u5efaRouting/Tables\uff0c</p> <pre><code># Routing / Tables\nname: openwrt\nFIB: \u662f\n</code></pre> <p>\u65b0\u5efa\u5141\u8bb8\u51fa\u56fd\u5730\u5740\u5217\u8868 </p> <pre><code>#  IP / Firewall / Address Lists / \u65b0\u5efa\nName: proxy\nAddress: 10.10.10.1-10.10.10.254\n</code></pre> <p>\u8bbe\u7f6eMangle</p> <p>\u653e\u884c\u672c\u5730\u7f51\u6bb5\u6240\u6709\u6d41\u91cf</p> <pre><code>#  IP / Firewall / Mangle / \u65b0\u5efa\nGeneral\n    Chain: prerouting\n    Src. Address: 10.10.10.0/24\nAction\n    Action: mark accept\n</code></pre> <p>\u51fa\u56fd\u6d41\u91cf\u6253\u8def\u7531\u6807\u8bb0openwrt</p> <pre><code>#  IP / Firewall / Mangle / \u65b0\u5efa\nGeneral\n    Chain: prerouting\n    Src. Address: Proxy\n    Dst. Address: ! CN  \nAction\n    Action: mark routing\n    New Routing Mark: openwrt\n</code></pre> <p>\u8bbe\u7f6eIP Tables</p> <p>\u8def\u7531\u6807\u8bb0\u4e3aopenwrt\u7684\u6d41\u91cf\u8d70\u65c1\u8def\u7531</p> <pre><code># IP / Tables / \u65b0\u5efa\nst. Address: 0.0.0.0/0\nGateway: 10.10.10.2 # openwrt\u7684IP\u5730\u5740\nDsitance: 1\nScope: 30\nTarget Scope: 10\nRouting Table: openwrt\n</code></pre> <p>\u8bbe\u7f6e\u81ea\u52a8\u4efb\u52a1</p> <pre><code>/file remove CN\n/tool fetch url=http://www.iwik.org/ipcountry/mikrotik/CN\n/import file-name=CN\n</code></pre> <p>\u76d1\u63a7\u65c1\u8def\u6709\u4e0a\u4e0b\u7ebf</p> <pre><code>$ Tools / Netwatch / \u65b0\u5efa\nHost\n    Host: 10.10.10.2\n    Interval: 00:05:00 # 5\u5206\u949f\u76d1\u6d4b\u4e00\u6b21\n    Timeout: 1\nUp\n    /ip firewall mangle enable number=2     #number\u9700\u5bf9\u5e94Firewall/Mangle\u5e8f\u53f7\nDown\n    /ip firewall mangle disable number=2    #number\u9700\u5bf9\u5e94Firewall/Mangle\u5e8f\u53f7\n</code></pre>"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/ROS%E5%BC%80%E5%90%AFIPV6/","title":"ROS\u5f00\u542fIPV6","text":""},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/ROS%E5%BC%80%E5%90%AFIPV6/#rosipv6","title":"ROS\u5f00\u542fIPV6","text":"<pre><code> /ipv6/settings/set disable-ipv6=no\n /ipv6/dhcp-client/add interface=pppoe-out1 request=prefix pool-name=Local_Pool_GUA_IPv6 pool-prefix-length=64 use-peer-dns=yes add-default-route=no comment=\"defconf: DHCPv6 on PPPoE\"  \n/ipv6/address/add address=::1/64 from-pool=Local_Pool_GUA_IPv6 interface=bridge1 advertise=yes comment=\"defconf: Local LAN GUA IPv6 Address\"\n# \u8bbe\u7f6eND\u670d\u52a1\n/ipv6/nd/prefix/default/set valid-lifetime=02:00:00 preferred-lifetime=01:00:00\n/ipv6/nd disable numbers=0\n/ipv6/nd/add interface=bridge1 ra-interval=60-120 hop-limit=64 dns=fdac::1 advertise-mac-address=yes advertise-dns=yes\n\n</code></pre>"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/ROS%E5%BC%80%E5%90%AFIPV6/#0","title":"0.\u80cc\u666f\u8bf4\u660e","text":"<p>\u5728 RouterOS \u8fd1\u671f\u7248\u672c\u66f4\u65b0\u4e2d\uff0cMikrotik \u5b98\u65b9\u5bf9 IPv6 \u76f8\u5173\u529f\u80fd\u505a\u4e86\u8bb8\u591a\u4f18\u5316\uff0c\u662f\u65f6\u5019\u914d\u7f6e IPv6 \u7f51\u7edc\u4e86\u3002</p> <p>\u6839\u636e Mikrotik \u5b98\u65b9\u6587\u6863\uff0c\u76ee\u524d RouterOS \u80fd\u6bd4\u8f83\u597d\u7684\u652f\u6301\u4ee5 <code>SLAAC</code> \u65b9\u5f0f\u6765\u914d\u7f6e IPv6 \uff0c\u800c DHCPv6 \u6682\u65f6\u53ea\u652f\u6301\u901a\u544a\u524d\u7f00\u4fe1\u606f\uff0c\u800c\u4e0d\u80fd\u5206\u53d1\u5730\u5740\u3002</p> <p>\u7ecf\u8fc7\u5b9e\u9645\u6d4b\u8bd5\uff0c\u5982\u679c\u628a\u516c\u7f51 IPv6 \u524d\u7f00\u4fe1\u606f\u901a\u544a\u5230\u5185\u7f51\u8bbe\u5907\uff08\u5373\u8ba9\u5185\u7f51\u8bbe\u5907\u76f4\u63a5\u5177\u6709\u516c\u7f51 IPv6 \u5730\u5740\uff09\uff0c\u5f53 PPPoE \u91cd\u65b0\u62e8\u53f7\u6216\u5176\u4ed6\u539f\u56e0\u5bfc\u81f4\u8be5\u516c\u7f51 IPv6 \u524d\u7f00\u53d1\u751f\u53d8\u5316\u65f6\uff0c\u5185\u7f51\u8bbe\u5907\u867d\u7136\u4e5f\u80fd\u540c\u6b65\u83b7\u53d6\u65b0\u7684\u516c\u7f51 IPv6 \u5730\u5740\uff0c\u4f46\u6b64\u65f6 RouterOS \u7684 IPv6 \u8def\u7531\u8868\u5df2\u7ecf\u81ea\u52a8\u5237\u65b0\uff0c\u5bfc\u81f4\u65b0\u65e7\u516c\u7f51 IPv6 \u5730\u5740\u5e76\u5b58\u7684\u5185\u7f51\u8bbe\u5907\u65e0\u6cd5\u901a\u8fc7 IPv6 \u6b63\u5e38\u4e0a\u7f51\uff0c\u53ea\u80fd\u901a\u8fc7\u91cd\u542f\u8be5\u5185\u7f51\u8bbe\u5907\u7684\u7f51\u5361\uff0c\u8ba9\u8be5\u5185\u7f51\u8bbe\u5907\u5237\u65b0\u516c\u7f51 IPv6 \u5730\u5740\uff08\u7b49\u4ef7\u4e8e\u53bb\u6389\u65e7\u7684\u516c\u7f51 IPv6 \u5730\u5740\uff09\uff0c\u624d\u80fd\u6062\u590d IPv6 \u7684\u7f51\u7edc\u8bbf\u95ee\u3002</p> <p>\u6839\u636e\u6293\u53d6 RouterOS \u548c OpenWrt \u7684 <code>ICMPv6</code> \u76f8\u5173\u5305\u53ef\u4ee5\u53d1\u73b0\uff0cRouterOS \u7684 <code>Neighbor Discovery</code> \u529f\u80fd\u76ee\u524d\u4e0d\u652f\u6301\u901a\u544a <code>ICMPv6 Option</code> \u4e3a <code>Type: Route Information (24)</code> \u7684\u4fe1\u606f\u3002</p> <p>\u800c\u4e14 OpenWrt \u5728\u516c\u7f51 IPv6 \u524d\u7f00\u53d1\u751f\u53d8\u5316\u65f6\uff0c\u9664\u4e86\u4f1a\u901a\u544a\u65b0\u7684 IPv6 \u8def\u7531\u4fe1\u606f\u5916\uff0c\u4e5f\u4f1a\u5728\u7cfb\u7edf IPv6 \u8def\u7531\u8868\u4e2d\u65b0\u589e\u8def\u7531\u6761\u76ee\uff0c\u800c\u65e7\u7684 IPv6 \u8def\u7531\u6761\u76ee\u5e76\u4e0d\u4f1a\u5220\u9664\uff0c\u76f4\u5230 OpenWrt \u7cfb\u7edf\u91cd\u542f\u3002</p> <p>\u603b\u4f53\u800c\u8a00\uff0c OpenWrt \u5bf9 IPv6 \u7684\u652f\u6301\u5c31\u76ee\u524d\u6765\u8bf4\u662f\u597d\u4e8e RouterOS \u7684\uff0c\u6bd5\u7adf\u73b0\u5728 OpenWrt \u5bf9 DHCPv6 \u4e5f\u6709\u826f\u597d\u7684\u652f\u6301\u3002</p>"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/ROS%E5%BC%80%E5%90%AFIPV6/#1-ipv6","title":"1.\u83b7\u53d6 IPv6 \u524d\u7f00","text":"<p>\u5982\u679c\u6309\u7167\u4e4b\u524d\u7684\u6587\u7ae0 08.\u8bbe\u7f6e\u7cfb\u7edf\u53c2\u6570.md \u5173\u95ed\u4e86 IPv6 \uff0c\u6b64\u65f6\u9700\u8981\u5c06\u5176\u91cd\u65b0\u6253\u5f00\u3002</p> <p>\u4f7f\u7528 Winbox \u767b\u5f55 RouterOS \uff0c\u70b9\u51fb\u5de6\u4fa7\u5bfc\u822a <code>IPv6</code> \u83dc\u5355\u7684\u5b50\u83dc\u5355 <code>Settings</code> \u3002</p> <p>\u53d6\u6d88\u52fe\u9009 <code>Disable IPv6</code> \uff0c\u8868\u793a\u5f00\u542f RouterOS IPv6 \u76f8\u5173\u529f\u80fd\u3002</p> <p>\u5e76\u5c06 <code>Max Neighbor Entries</code> \u53c2\u6570\uff08\u7c7b\u4f3c\u4e8e <code>ARP</code> \u8868\u6700\u5927\u6761\u76ee\u6570\uff09\u4fee\u6539\u4e3a\u5408\u9002\u7684\u6570\u503c\uff0c\u6f14\u793a\u4e3a <code>1024</code> \u3002</p> <p></p> <p>\u70b9\u51fb\u5de6\u4fa7\u5bfc\u822a <code>IPv6</code> \u83dc\u5355\u7684\u5b50\u83dc\u5355 <code>DHCP Client</code> \uff0c\u70b9\u51fb <code>+</code> \u6309\u94ae\uff1a</p> \u53c2\u6570 \u503c \u8bf4\u660e Interface <code>pppoe-out1</code> \u4ece PPPoE \u62e8\u53f7\u4e2d\u83b7\u53d6 IPv6 \u524d\u7f00 Request <code>prefix</code> \u8868\u793a\u53ea\u83b7\u53d6\u524d\u7f00\u4fe1\u606f Pool Name <code>Local_Pool_GUA_IPv6</code> \u8bbe\u7f6e\u672c\u5730 IPv6 \u5730\u5740\u6c60\u540d\u79f0 Pool Prefix Length <code>60</code> \u8bbe\u7f6e\u672c\u5730 IPv6 \u5730\u5740\u6c60\u957f\u5ea6 Use Peer DNS \u53d6\u6d88\u52fe\u9009 \u4e0d\u4f7f\u7528\u8fd0\u8425\u5546\u7684 IPv6 DNS Add Default Route \u4e0d\u52fe\u9009 \u662f\u5426\u52a0\u5165\u9ed8\u8ba4\u8def\u7531\uff0c\u5efa\u8bae\u662f\u65e0\u9700\u52fe\u9009 Comment <code>defconf: DHCPv6 on PPPoE</code> \u5907\u6ce8\u4fe1\u606f <p>\u6ce8\u610f\uff1a \u5bf9\u4e8e <code>Add Default Route</code> \u53c2\u6570\uff0c\u5b98\u65b9\u5efa\u8bae\u662f\u65e0\u9700\u52fe\u9009\u3002 \u6ca1\u6709\u76f8\u5173 RFC \u6587\u6863\u8868\u660e <code>DHCPv6 Client</code> \u9700\u8981\u6dfb\u52a0\u9ed8\u8ba4\u8def\u7531\uff0c\u8be5\u9009\u9879\u53ef\u80fd\u662f RouterOS \u7279\u6709\u7684 \u201c\u4fbf\u6377\u8bbe\u7f6e\u201d \u3002 \u7ecf\u8fc7\u6d4b\u8bd5\uff0c\u8be5\u9009\u9879\u52fe\u9009\u4e0e\u5426\u5747\u4e0d\u5f71\u54cd\u540e\u7eed\u8bbe\u7f6e\u4ee5\u53ca IPv6 \u7684\u7f51\u7edc\u8bbf\u95ee\u3002 \u540c\u65f6\uff0c\u8be5\u9009\u9879\u4e5f\u65e0\u6cd5\u89e3\u51b3 IPv6 \u524d\u7f00\u6539\u53d8\u540e\uff0c\u5185\u7f51\u8bbe\u5907\u56e0\u65e7\u7684 IPv6 \u516c\u7f51\u5730\u5740\u8fc7\u671f\u800c\u7f51\u7edc\u4e2d\u65ad\u7684\u95ee\u9898\u3002</p> <p></p> <p><code>DHCPv6 Client</code> \u521b\u5efa\u5b8c\u6210\u540e\uff0c\u5982\u679c\u6b63\u786e\u83b7\u53d6\u5230\u4e86 IPv6 \u524d\u7f00\u4fe1\u606f\uff0c\u5c06\u5982\u56fe\u6240\u793a\uff1a</p> <p></p> <p>\u5982\u679c\u672a\u83b7\u53d6\u5230\u524d\u7f00\u4fe1\u606f\uff0c\u5c1d\u8bd5\u8ba9 PPPoE \u91cd\u65b0\u62e8\u53f7\u3002</p> <p>\u5982\u679c\u5728\u91cd\u65b0\u62e8\u53f7\u540e\uff0c\u4ecd\u672a\u83b7\u53d6 IPv6 \u7684\u524d\u7f00\u4fe1\u606f\uff0c\u90a3\u4e48\u8fd0\u8425\u5546\u53ef\u80fd\u5e76\u672a\u63d0\u4f9b IPv6 \u63a5\u5165\u80fd\u529b\u3002</p>"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/ROS%E5%BC%80%E5%90%AFIPV6/#2-ipv6","title":"2.\u8bbe\u7f6e\u63a5\u53e3 IPv6 \u5730\u5740","text":"<p>\u5728\u8bbe\u7f6e\u63a5\u53e3 IPv6 \u65f6\uff0c\u62e8\u53f7\u63a5\u53e3 <code>pppoe-out1</code> \u662f \u65e0\u9700 \u5206\u914d IPv6 \u516c\u7f51\u5730\u5740\u7684\u3002</p> <p>\u53ea\u9700\u7ed9\u7f51\u6865\u63a5\u53e3 <code>bridge1</code> \u5206\u914d\u4e00\u4e2a IPv6 GUA \u516c\u7f51\u5730\u5740\uff0c\u5e76\u9644\u52a0\u4e00\u4e2a IPv6 ULA \u79c1\u6709\u5730\u5740\u5373\u53ef\u3002</p> <p>\u6ce8\u610f\uff1a \u5f53\u524d RouterOS IPv6 \u8fd8\u672a\u8bbe\u7f6e\u9632\u706b\u5899\uff0c\u7ed9\u5185\u90e8\u63a5\u53e3\u5206\u914d\u516c\u7f51 IPv6 \u4e4b\u540e\uff0cRouterOS \u76f8\u5f53\u4e8e\u5df2\u7ecf\u4e0e\u516c\u7f51\u4e92\u8054\u3002 \u5982\u679c\u5f53\u524d RouterOS \u6709\u4e0d\u5b8c\u5584\u7684\u5b89\u5168\u8bbe\u7f6e\uff08\u6bd4\u5982\u4f7f\u7528\u4e86\u5f31\u767b\u5f55\u5bc6\u7801\uff09\uff0c\u7cfb\u7edf\u5b58\u5728\u88ab\u5165\u4fb5\u7684\u98ce\u9669\u3002 \u56e0\u6b64\u5efa\u8bae\u5148\u5173\u95ed <code>DHCPv6 Client</code> \uff0c\u76f4\u5230 RouterOS IPv6 \u9632\u706b\u5899\u7b49\u5185\u5bb9\u8bbe\u7f6e\u5b8c\u6210\u540e\uff0c\u518d\u5c06\u5176\u6253\u5f00\u3002</p>"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/ROS%E5%BC%80%E5%90%AFIPV6/#21-ipv6","title":"2.1.\u5206\u914d IPv6 \u516c\u7f51\u5730\u5740","text":"<p>\u70b9\u51fb Winbox \u5de6\u4fa7\u5bfc\u822a <code>IPv6</code> \u83dc\u5355\u7684\u5b50\u83dc\u5355 <code>Addresses</code> \uff0c\u70b9\u51fb <code>+</code> \u6309\u94ae\uff1a</p> \u53c2\u6570 \u503c \u8bf4\u660e Address <code>::1/64</code> \u81ea\u52a8\u5339\u914d\u524d\u7f00\uff0c\u524d\u7f00\u957f\u5ea6 <code>64</code> \uff0c\u5e76\u4f7f\u7528\u987a\u5e8f\u7b2c\u4e00\u4e2a\u5730\u5740 From Pool <code>Local_Pool_GUA_IPv6</code> \u9009\u62e9 <code>DHCPv6 Client</code> \u4e2d\u521b\u5efa\u7684\u5730\u5740\u6c60 Interface <code>bridge1</code> \u9009\u62e9\u5185\u90e8\u7f51\u6865\u63a5\u53e3 Advertise \u52fe\u9009 \u52fe\u9009\u8be5\u9009\u9879\uff0c\u5185\u7f51\u8bbe\u5907\u5c06\u751f\u6210\u516c\u7f51 IPv6 \u5730\u5740 Comment <code>defconf: Local LAN GUA IPv6 Address</code> \u5907\u6ce8\u4fe1\u606f <p></p>"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/ROS%E5%BC%80%E5%90%AFIPV6/#22-ipv6","title":"2.2.\u5206\u914d IPv6 \u79c1\u6709\u5730\u5740","text":"<p>\u6839\u636e RFC4193 - Unique Local IPv6 Unicast Addresses \u4e2d\u7ed9\u51fa\u7684\u5b9a\u4e49\uff0cIPv6 ULA \u79c1\u6709\u5730\u5740\u524d\u7f00\u4e3a <code>FC00::/7</code> \u3002</p> <p>\u8be5\u524d\u7f00\u5305\u542b <code>FC00::/8</code> \u548c <code>FD00::/8</code> \u4e24\u4e2a\u90e8\u5206\uff0c\u4e25\u683c\u610f\u4e49\u4e0a ULA \u76ee\u524d\u5e94\u8be5\u4f7f\u7528 <code>FD00::/8</code> \u3002</p> <p>\u5728\u5b9e\u9645\u4f7f\u7528\u573a\u666f\u4e0b\uff0c\u5efa\u8bae\u4f7f\u7528\u7c7b\u4f3c RFC4193 IPv6 Generator \u7684\u5de5\u5177\u6765\u751f\u6210\u7b26\u5408\u89c4\u8303\u7684 ULA \u79c1\u6709\u5730\u5740\u3002</p> <p>\u8be5\u5de5\u5177\u53ea\u9700\u8981\u8f93\u5165\u63a5\u53e3\uff08\u4f8b\u5982 RouterOS \u7684 <code>bridge1</code> \uff09\u7684 MAC \u5730\u5740\u5373\u53ef\u3002</p> <p></p> <p>\u5f97\u5230\u7b26\u5408\u89c4\u8303\u7684 ULA \u79c1\u6709\u5730\u5740\u4e3a\uff1a</p> <p></p> <p>\u56de\u5230 Winbox \uff0c\u518d\u6b21\u70b9\u51fb <code>+</code> \u6309\u94ae\uff1a</p> \u53c2\u6570 \u503c \u8bf4\u660e Address <code>fdac::1/64</code> \u6307\u5b9a\u524d\u7f00\uff0c\u524d\u7f00\u957f\u5ea6 <code>64</code> \uff0c\u5e76\u4f7f\u7528\u987a\u5e8f\u7b2c\u4e00\u4e2a\u5730\u5740 Interface <code>bridge1</code> \u9009\u62e9\u5185\u90e8\u7f51\u6865\u63a5\u53e3 Advertise \u52fe\u9009 \u52fe\u9009\u8be5\u9009\u9879\uff0c\u5185\u7f51\u8bbe\u5907\u5c06\u751f\u6210\u79c1\u6709 IPv6 \u5730\u5740 Comment <code>defconf: Local LAN ULA IPv6 Address</code> \u5907\u6ce8\u4fe1\u606f <p>\u6ce8\u610f\uff1a\u65b9\u4fbf\u8d77\u89c1\uff0c\u672c\u6587\u4f7f\u7528 <code>fdac::/64</code> \u4f5c\u4e3a\u6f14\u793a\u3002</p> <p></p> <p><code>DHCPv6 Client</code> \u6b63\u786e\u83b7\u53d6 IPv6 \u524d\u7f00\uff0c\u5e76\u4e14\u5185\u90e8\u7f51\u6865 <code>bridge1</code> \u4e24\u4e2a IPv6 \u5730\u5740\u5747\u6dfb\u52a0\u5b8c\u6210\u540e\uff0c\u5982\u56fe\u6240\u793a\uff1a</p> <p></p>"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/ROS%E5%BC%80%E5%90%AFIPV6/#3-nd","title":"3.\u8bbe\u7f6e ND \u670d\u52a1","text":""},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/ROS%E5%BC%80%E5%90%AFIPV6/#31-nd","title":"3.1.\u8bbe\u7f6e ND \u524d\u7f00","text":"<p>\u70b9\u51fb Winbox \u5de6\u4fa7\u5bfc\u822a <code>IPv6</code> \u83dc\u5355\u7684\u5b50\u83dc\u5355 <code>ND</code> \u3002</p> <p>\u5728 <code>Neighbor Discovery</code> \u5bf9\u8bdd\u6846\u4e2d\u5207\u6362\u5230 <code>Prefixes</code> \u9009\u9879\u5361\u3002</p> <p>\u8fd9\u91cc\u53ef\u4ee5\u770b Prefix <code>fdac::/64</code> \u88ab\u6807\u8bb0\u4e3a <code>D</code> \uff0c\u8868\u793a\u8be5\u6761\u76ee\u4e3a \u201c\u81ea\u52a8\u52a8\u6001\u751f\u6210\u201d \u6761\u76ee\u3002</p> <p>\u70b9\u51fb <code>Default</code> \uff0c\u4fee\u6539 Prefix \u7684\u6709\u6548\u671f\uff1a</p> <p></p> <p>\u6839\u636e Systemd.Network \u4e2d\u7684\u63cf\u8ff0\uff1a</p> <p>Preferred and valid lifetimes for the prefix measured in seconds. PreferredLifetimeSec= defaults to 1800 seconds (30 minutes) and ValidLifetimeSec= defaults to 3600 seconds (one hour).</p> <p>\u7ecf\u8fc7\u4e00\u6bb5\u65f6\u95f4\u7684\u6d4b\u8bd5\uff0c\u5c06 <code>Preferred Lifetime</code> \u8bbe\u7f6e\u4e3a <code>1</code> \u5c0f\u65f6\uff0c\u5c06 <code>Valid Lifetime</code> \u8bbe\u7f6e\u4e3a <code>2</code> \u5c0f\u65f6\u8f83\u4e3a\u53ef\u9760\u3002</p> \u53c2\u6570 \u503c \u8bf4\u660e Valid Lifetime <code>02:00:00</code> IPv6 \u5730\u5740\u6700\u5927\u6709\u6548\u671f Preferred Lifetime <code>01:00:00</code> IPv6 \u5730\u5740\u5efa\u8bae\u6709\u6548\u671f"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/ROS%E5%BC%80%E5%90%AFIPV6/#32-nd","title":"3.2.\u8bbe\u7f6e ND \u901a\u544a","text":"<p>\u5728 <code>Neighbor Discovery</code> \u5bf9\u8bdd\u6846\u4e2d\u5207\u6362\u5230 <code>Interfaces</code> \u9009\u9879\u5361\u3002</p> <p>\u9f20\u6807 \u5355\u51fb \u9009\u4e2d <code>Interface</code> \u4e3a <code>all</code> \u7684\u6761\u76ee\uff0c\u70b9\u51fb <code>\u00d7</code> \u6309\u94ae\u5c06\u5176\u7981\u7528\uff1a</p> <p></p> <p>\u70b9\u51fb <code>+</code> \u6309\u94ae\uff0c\u65b0\u589e\u4e00\u4e2a ND \u901a\u544a\u914d\u7f6e\u3002</p> <p>\u5982\u679c\u5185\u7f51\u73af\u5883\u4e2d \u6ca1\u6709 \u81ea\u5efa DNS \u670d\u52a1\u5668\uff0c\u5219\u53ef\u4ee5\u5c06 <code>DNS Servers</code> \u53c2\u6570\u8bbe\u7f6e\u4e3a <code>fdac::1</code> \uff0c\u4e0e <code>bridge1</code> \u7684 ULA IPv6 \u5730\u5740\u76f8\u540c\u3002</p> \u53c2\u6570 \u503c \u8bf4\u660e Interface <code>bridge1</code> \u9009\u62e9ND\u901a\u544a\u4f7f\u7528\u7684\u63a5\u53e3 RA Interval <code>60-120</code> \u8bbe\u7f6eND\u901a\u544a\u7684\u65f6\u95f4\u95f4\u9694\uff0c\u65f6\u95f4\u5355\u4f4d\u4e3a\u79d2 Hop Limit <code>64</code> \u7f3a\u7701\u60c5\u51b5\u4e0b\uff0c\u7531\u8bbe\u5907\u521d\u59cb\u53d1\u9001 IPv6 \u5355\u64ad\u62a5\u6587\u7684\u8df3\u6570\u9650\u5236\u662f64 DNS Servers <code>fdac::1</code> ND \u901a\u544a\u7684 IPv6 \u7684 DNS \u670d\u52a1\u5668\u5730\u5740 Advertise MAC Address \u5efa\u8bae\u52fe\u9009 ND \u901a\u544a\u4e2d\u5c06\u5305\u542b\u63a5\u53e3\u7684 MAC \u5730\u5740\u4fe1\u606f Advertise DNS \u5fc5\u987b\u52fe\u9009 \u4f7f\u7528 ND \u8bbe\u7f6e\u7684 DNS \u670d\u52a1\u5668\u6765\u901a\u544a <p></p> <p>\u5982\u679c\u5185\u7f51\u4e2d \u6709 \u81ea\u5efa DNS \u670d\u52a1\u5668\uff0c\u5219\u9700\u8981\u5c06 <code>DNS Servers</code> \u53c2\u6570\u8bbe\u7f6e\u4e3a\u5185\u7f51 DNS \u670d\u52a1\u5668\u7684 IPv6 \u5730\u5740\u3002</p> <p>\u5047\u8bbe\u5185\u7f51 DNS \u670d\u52a1\u5668\u5206\u522b\u4e3a <code>fdac::2</code> \u3001 <code>fdac::3</code> \uff0c\u5219 ND \u914d\u7f6e\u5982\u4e0b\uff1a</p> <p></p> <p><code>ND</code> \u914d\u7f6e\u5b8c\u6210\u540e\uff0c\u5982\u56fe\u6240\u793a\uff1a</p> <p></p>"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/ROS%E5%BC%80%E5%90%AFIPV6/#4-dns","title":"4.\u4fee\u6539\u7cfb\u7edf DNS","text":"<p>\u542f\u7528 IPv6 \u540e\uff0c\u9700\u8981\u7ed9 RouterOS \u91cd\u65b0\u6307\u5b9a\u4e0a\u6e38 DNS \u670d\u52a1\u5668\u5730\u5740\u3002</p> <p>\u70b9\u51fb Winbox \u5de6\u4fa7\u5bfc\u822a <code>IP</code> \u83dc\u5355\u7684\u5b50\u83dc\u5355 <code>DNS</code> \uff0c\u5e76\u4fee\u6539 <code>Servers</code> \u53c2\u6570\u3002</p> <p>\u5728 <code>Servers</code> \u5904\u589e\u52a0\u56fd\u5185\u77e5\u540d\u7684 DNS \u670d\u52a1\u63d0\u4f9b\u5546\u7684 IPv6 \u5730\u5740\u3002</p> <ul> <li>\u817e\u8baf\u4e91 DNSPod \u7684 IPv6 \u5730\u5740\u4e3a\uff1a<code>2402:4e00::</code> \u548c <code>2402:4e00:1::</code> \u3002</li> <li>\u963f\u91cc\u4e91 AliDNS \u7684 IPv6 \u5730\u5740\u4e3a\uff1a<code>2400:3200::1</code> \u548c <code>2400:3200:baba::1</code> \u3002</li> </ul> <p></p> <p>\u5982\u679c\u5185\u7f51\u4e2d \u6709 \u81ea\u5efa DNS \u670d\u52a1\u5668\uff0c\u5219\u9700\u8981\u5c06 <code>Servers</code> \u53c2\u6570\u8bbe\u7f6e\u4e3a\u5185\u7f51 DNS \u670d\u52a1\u5668\u7684 IPv6 \u5730\u5740\u3002</p> <p>\u5047\u8bbe\u5185\u7f51 DNS \u670d\u52a1\u5668\u5206\u522b\u4e3a <code>fdac::2</code> \u3001 <code>fdac::3</code> \uff0c\u5219 DNS \u914d\u7f6e\u5982\u4e0b\uff1a</p> <p></p>"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/ROS%E5%BC%80%E5%90%AFIPV6/#5-ipv6","title":"5.\u8bbe\u7f6e IPv6 \u9632\u706b\u5899","text":"<p>\u4e0e\u524d\u6587 05.\u8bbe\u7f6e\u9632\u706b\u5899 \u7c7b\u4f3c\uff0cIPv6 \u9632\u706b\u5899\u540c\u6837\u6d89\u53ca <code>address-list</code> \u3001<code>filter</code> \u3001<code>nat</code> \u3001<code>mangle</code> \u3001<code>raw</code> \u7b49\u5185\u5bb9\u3002</p> <p>\u4f9d\u7136\u5efa\u8bae\u590d\u5236\u9632\u706b\u5899\u914d\u7f6e\u547d\u4ee4\uff0c\u4e00\u6b21\u6027\u5168\u90e8\u7c98\u8d34\u5230 CLI \u4e2d\u8fdb\u884c \u201c\u4e00\u952e\u914d\u7f6e\u201d \u3002</p> <p>\u82e5\u9700\u4f7f\u7528 NAT66 \u7684\u65b9\u5f0f\u6765\u8bbf\u95ee\u5916\u90e8 IPv6 \u7f51\u7edc\uff0c\u8bf7\u5728 <code>nat</code> \u8868\u4e2d\u542f\u7528\u7b2c\u4e00\u6761\u9632\u706b\u5899\u89c4\u5219\u3002</p> <p>\u9632\u706b\u5899\u914d\u7f6e\u547d\u4ee4\u4e2d\u7684\u90e8\u5206 IPv6 ULA \u5730\u5740\u9700\u8981\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8fdb\u884c\u8c03\u6574\u3002</p> <ul> <li>\u5185\u7f51\u4f7f\u7528\u7684 IPv6 ULA \u5730\u5740\u524d\u7f00</li> </ul> <p><code>fdac::/64</code></p> <ul> <li> <p>RouterOS \u7684 IPv6 ULA \u5730\u5740 <code>fdac::1</code></p> </li> <li> <p>\u5185\u7f51 DNS \u670d\u52a1\u5668\u7684 IPv6 ULA \u5730\u5740 <code>fdac::2</code> \u3001 <code>fdac::3</code></p> </li> </ul> <p>\u5982\u679c \u6ca1\u6709 \u5185\u7f51 DNS \u670d\u52a1\u5668\uff0c\u5e76\u79fb\u9664\u4e86 <code>local_dns_ipv6</code> \u5730\u5740\u5217\u8868\uff0c\u5219\u9700\u540c\u6b65\u79fb\u9664 <code>nat</code> \u8868\u4e2d\u4ee5\u4e0b <code>2</code> \u6761\u9632\u706b\u5899\u6761\u76ee\uff1a</p> <pre><code>add action=accept chain=dstnat comment=\"lanconf: accept local DNS server's query (UDP)\" dst-port=53 in-interface-list=LAN protocol=udp src-address-list=local_dns_ipv6\nadd action=accept chain=dstnat comment=\"lanconf: accept local DNS server's query (TCP)\" dst-port=53 in-interface-list=LAN protocol=tcp src-address-list=local_dns_ipv6 log=yes log-prefix=fw_dnsv6_tcp\n</code></pre> <p>\u7531\u4e8e IPv6 \u9632\u706b\u5899\u7684\u914d\u7f6e\u547d\u4ee4\u5f88\u957f\uff0c\u56e0\u6b64\u8bf7\u67e5\u9605\u6587\u4ef6 ros_firewall_ipv6.conf \u8fdb\u884c\u590d\u5236\u3002</p> <p>IPv6 \u9632\u706b\u5899\u914d\u7f6e\u5b8c\u6210\u540e\uff0c\u56de\u5230 Winbox\uff0c\u70b9\u51fb\u5de6\u4fa7\u5bfc\u822a <code>IPv6</code> \u83dc\u5355\u7684\u5b50\u83dc\u5355 <code>Firewall</code> \u5e76\u67e5\u770b\u9632\u706b\u5899\u5404\u4e2a\u9009\u9879\u5361\u4e2d\u5185\u5bb9\uff1a</p> <p></p> <p>\u786e\u8ba4\u9632\u706b\u5899\u6761\u76ee\u4e0e\u547d\u4ee4\u4e2d\u7684\u6761\u76ee\u4e00\u81f4\u540e\uff0c\u4fbf\u53ef\u542f\u7528 IPv6 \u7684 <code>DHCPv6 Client</code> \uff0c\u5efa\u8bae\u91cd\u542f\u4e00\u6b21 RouterOS\u3002</p> <p>\u91cd\u542f\u5185\u7f51\u8bbe\u5907\u7684\u7f51\u5361\uff0c\u68c0\u67e5\u662f\u5426\u83b7\u53d6\u4e86 GUA / ULA \u5730\u5740\u3002</p> <p>Windows11 IPv6 \u8fde\u63a5\u5904\u4f1a\u663e\u793a <code>Internet</code> \uff0c\u8868\u793a\u6b64\u65f6 Windows \u662f\u53ef\u4ee5\u8bbf\u95ee IPv6 \u7f51\u7edc\u7684\u3002</p> <p>\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e2a\u7f51\u7ad9\u6765\u8fdb\u884c\u6d4b\u8bd5 IPv6 Test \u3002</p> <p></p>"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/ROS%E5%BC%80%E5%90%AFIPV6/#6-ipv6","title":"6.\u8bbe\u7f6e IPv6 \u9ed1\u6d1e\u8def\u7531","text":"<p>IPv6 \u9ed1\u6d1e\u8def\u7531 <code>blackhole route</code> \u662f\u4e00\u7ec4\u9759\u6001\u8def\u7531\uff0c\u57fa\u4e8e RFC6890 - Special-Purpose IP Address Registries \u521b\u5efa\u3002</p> <p>\u590d\u5236 IPv6 \u9ed1\u6d1e\u8def\u7531\u914d\u7f6e\u547d\u4ee4\uff0c\u4e00\u6b21\u6027\u5168\u90e8\u7c98\u8d34\u5230 CLI \u4e2d\u6267\u884c\u3002</p> <pre><code>/ipv6 route\n\nadd blackhole comment=\"defconf: RFC6890 for loopback address\" disabled=no dst-address=::1/128\nadd blackhole comment=\"defconf: RFC6890 for unspecified address\" disabled=no dst-address=::/128\nadd blackhole comment=\"defconf: RFC6890 for IPv4-IPv6 translat\" disabled=no dst-address=64:ff9b::/96\nadd blackhole comment=\"defconf: RFC6890 for IPv4-mapped address\" disabled=no dst-address=::ffff:0:0/96\nadd blackhole comment=\"defconf: RFC6890 for discard-only address block\" disabled=no dst-address=100::/64\nadd blackhole comment=\"defconf: RFC6890 for IETF protocol assignments\" disabled=no dst-address=2001::/23\nadd blackhole comment=\"defconf: RFC6890 for TEREDO\" disabled=no dst-address=2001::/32\nadd blackhole comment=\"defconf: RFC6890 for benchmarking\" disabled=no dst-address=2001:2::/48\nadd blackhole comment=\"defconf: RFC6890 for documentation\" disabled=no dst-address=2001:db8::/32\nadd blackhole comment=\"defconf: RFC6890 for ORCHID\" disabled=no dst-address=2001:10::/28\nadd blackhole comment=\"defconf: RFC6890 for 6to4\" disabled=no dst-address=2002::/16\nadd blackhole comment=\"defconf: RFC6890 for unique-local\" disabled=no dst-address=fc00::/7\nadd blackhole comment=\"defconf: RFC6890 for linked-scoped unicast\" disabled=no dst-address=fe80::/10\n</code></pre> <p>\u5982\u679c\u8fd9\u6bb5\u4ee3\u7801\u4e0d\u597d\u590d\u5236\uff0c\u8bf7\u67e5\u9605\u6587\u4ef6 ros_blackhole_ipv6.conf \u8fdb\u884c\u590d\u5236\u3002</p> <p>\u70b9\u51fb Winbox \u5de6\u4fa7\u5bfc\u822a <code>IP</code> \u83dc\u5355\u7684\u5b50\u83dc\u5355 <code>Routes</code> \u5e76\u67e5\u770b\u9632\u706b\u5899\u5404\u4e2a\u9009\u9879\u5361\u4e2d\u5185\u5bb9\uff1a</p> <p></p> <p>\u81f3\u6b64\uff0cRouterOS \u8bbe\u7f6e IPv6 \u6b65\u9aa4\u5b8c\u6210\u3002</p>"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/RouterOS%20Container%E8%AE%BE%E7%BD%AE/","title":"RouterOS Container\u8bbe\u7f6e","text":""},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/RouterOS%20Container%E8%AE%BE%E7%BD%AE/#routeros-container","title":"RouterOS Container\u8bbe\u7f6e","text":"<pre><code>#\u542f\u7528container\uff0c\u6309\u63d0\u793a\u91cd\u542f\u6216\u62e8\u7535\u63a5\u7535\n/system/device-mode/update container=yes\n#\u91cd\u542f\u540e\u67e5\u770b\u72b6\u6001\u5982\u4e0b\n[admin@MikroTik] &gt; system/device-mode/print\n       mode: enterprise\n  container: yes\n</code></pre> <pre><code>#\u521b\u5efa\u4e00\u4e2abridge\uff0c\u7528\u4e8e\u8fde\u63a5docker\n/interface bridge add name=bridge1-docker\n\n#\u5b9a\u4e49bridge_iP\n/ip address add address=10.10.5.254/24 interface=bridge1-docker network=10.10.5.0\n#\u521b\u5efa\u4e00\u4e2a\u865a\u62df\u63a5\u53e3\u7ed9docker\u4f7f\u7528\u5e76\u5b9a\u4e49IP\u548c\u7f51\u5173\n/interface veth add address=10.10.5.1/24 gateway=10.10.5.254 name=veth1-adg\n#\u5c06\u865a\u62df\u63a5\u53e3\u6865\u63a5\u5230bridge\u4e0a\n/interface bridge port add bridge=bridge1-docker interface=veth1-adg\n\n\n#\u5b9a\u4e49docker\u4ed3\u5e93url\uff0c\u548c\u7528\u6237\u540d\u5bc6\u7801\n/container config\nset password=tianyingn registry-url=https://registry-1.docker.io tmpdir=sata/images username=\u4f60\u7684\u7528\u6237\u540d password=\u4f60\u7684\u5bc6\u7801\n</code></pre> <p>\u63a5\u4e0b\u6765\u521b\u5efacontainer\u5bb9\u5668,\u5728hub.docker.com\u627e\u5230\u955c\u50cf\u5730\u5740</p>"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/RouterOS%20Container%E8%AE%BE%E7%BD%AE/#enable-container-mode","title":"enable container mode","text":"<pre><code>/system/device-mode/update container=yes\n</code></pre>"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/RouterOS%20Container%E8%AE%BE%E7%BD%AE/#create-network","title":"Create network","text":"<p>Add veth interface for the container:</p> <pre><code>/interface/veth/add name=veth1 address=172.17.0.2/24 gateway=172.17.0.1\n</code></pre> <p>Create a bridge for containers and add veth to it:</p> <pre><code>/interface/bridge/add name=containers\n/ip/address/add address=172.17.0.1/24 interface=containers\n/interface/bridge/port add bridge=containers interface=veth1\n</code></pre> <p>Setup NAT for outgoing traffic:</p> <pre><code>/ip/firewall/nat/add chain=srcnat action=masquerade src-address=172.17.0.0/24\n</code></pre>"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/RouterOS%20Container%E8%AE%BE%E7%BD%AE/#add-environment-variables-and-mounts-optional","title":"Add environment variables and mounts (optional)","text":"<p>Create environment variables for container(optional):</p> <pre><code>/container/envs/add name=pihole_envs key=TZ value=\"Europe/Riga\"\n/container/envs/add name=pihole_envs key=WEBPASSWORD value=\"mysecurepassword\"\n/container/envs/add name=pihole_envs key=DNSMASQ_USER value=\"root\"\n</code></pre> <p>Define mounts (optional):</p> <pre><code>/container/mounts/add name=etc_pihole src=disk1/etc dst=/etc/pihole\n/container/mounts/add name=dnsmasq_pihole src=disk1/etc-dnsmasq.d dst=/etc/dnsmasq.d\n</code></pre>"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/RouterOS%20Container%E8%AE%BE%E7%BD%AE/#a-get-an-image-from-an-external-library","title":"a) get an image from an external library","text":"<pre><code>/container/config/set registry-url=https://registry-1.docker.io tmpdir=container\n</code></pre> <pre><code>/container/add remote-image=jeessy/ddns-go:latest interface=veth1 root-dir=container/ddns-go logging=yes\n\n</code></pre>"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/RouterOS%20Wireguard%2BOSPF%20Mesh%E7%BB%84%E7%BD%91/","title":"RouterOS Wireguard+OSPF Mesh\u7ec4\u7f51","text":"<p>\u5173\u4e8eWireguard\u7684Mesh\u7ec4\u7f51\u95ee\u9898\uff0cWireguard\u53ea\u662f\u4f5c\u4e3a\u96a7\u9053\u8fde\u63a5\u5b9e\u73b0\u8fdc\u7aef\u7684\u901a\u9053\uff0c\u800c\u8fd9\u4e2a\u901a\u9053\u6211\u4eec\u53ef\u4ee5\u9009\u62e9\u5176\u4ed6\u4efb\u4f55\u7684\u96a7\u9053\u534f\u8bae\uff0c\u89c6\u4e4eWireguard\u66f4\u53d7\u6b22\u8fce\u3002\u5982\u4f55\u5b9e\u73b0Mesh\u7684\u8def\u5f84\u9009\u62e9\u548c\u7f51\u7edc\u52a8\u6001\u81ea\u6108\u80fd\u529b\uff0c\u624d\u662f\u5173\u952e\uff0c\u5c31\u50cf\u65e0\u7ebf\u7f51\u7edc\u7684802.11s\uff0c\u8003\u8651\u5230\u8fd9\u4e2a\u95ee\u9898\u6574\u4e2a\u7f51\u7edc\u5efa\u7acb\u5728\u4e09\u5c42\u8def\u7531\u901a\u4fe1\u9700\u8981\u5b9e\u73b0\u8def\u5f84\u9009\u62e9\u548c\u7f51\u7edc\u81ea\u6108\u80fd\u529b\uff0c\u81ea\u7136\u5c31\u60f3\u5230\u4e86\u4f7f\u7528OSPF\u5efa\u7acb\u52a8\u6001\u8def\u7531\u3002</p> <p>\u8be5\u5b9e\u4f8b\u4e3a\u4e86\u4fdd\u8bc1\u7f51\u7edc\u7684\u5197\u4f59\uff0c\u4f1a\u8981\u6c42\u5230\u6bcf\u4e2aPeer\u5141\u8bb8\u76f8\u540c\u7684IP\u901a\u8fc7\uff0c\u9700\u8981\u91c7\u7528\u591a\u4e2aWireguard\u5b9e\u4f8b\uff0c\u56e0\u4e3a\u5355\u4e2aWireguard\u63a5\u53e3\u5b9e\u4f8b\u65e0\u6cd5\u5b9e\u73b0\u591aPeer\u5141\u8bb8\u76f8\u540cIP\u901a\u8fc7\uff0c\u5305\u62ecOSPF\u7684\u7ec4\u64ad\u5730\u5740\uff08\u4f1a\u5bfc\u81f4Cryptokey Routing\u8def\u7531\u51b2\u7a81\uff0c\u53ef\u4ee5\u53c2\u8003Linux\u4e0b\u7684Wireguard\u8def\u7531\u914d\u7f6e\u7406\u89e3\uff09\uff0c\u7f51\u7edc\u62d3\u6251\u5982\u4e0b\uff1a</p> <p></p> <p>\u4f7f\u7528Wireguard\u5efa\u7acb3\u53f0\u8def\u7531\u5668\u7684\u8fdc\u7aef\u96a7\u9053\u8fde\u63a5\uff0c3\u53f0\u901a\u8fc7OSP\u4f7f\u7528Area0\u5efa\u7acb\u8def\u7531\u5173\u7cfb\uff0c\u5176\u4e2dR3\u8def\u7531\u5668\u53d1\u5e03192.168.10.0/24\u7684LAN\u7f51\u7edc\u8def\u7531\u5230OSPF\u3002</p>"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/RouterOS%20Wireguard%2BOSPF%20Mesh%E7%BB%84%E7%BD%91/#_1","title":"\u57fa\u7840\u7f51\u7edc\u914d\u7f6e","text":"<p>R1\u8def\u7531\u5668 \u914d\u7f6eIP\u5730\u5740\uff1a</p> <pre><code>### \u57fa\u7840\u7f51\u7edc\u914d\u7f6e ###\n# R1\u8def\u7531\u5668 \u914d\u7f6eIP\u5730\u5740\uff1a\n/ip address add address=192.168.88.30/24 interface=ether1\n# \u521b\u5efa2\u4e2aWireguard\u63a5\u53e3\uff0c\u5206\u522b\u5bf9\u5e94R2\u548cR3\uff0c\u76d1\u542c\u7aef\u53e3\u5206\u522b\u4f7f\u752813231\u548c13232\n/interface wireguard add listen-port=13231 name=wireguard1-R2\n/interface wireguard add listen-port=13232 name=wireguard2-R3\n\n# R2\u8def\u7531\u5668 \u914d\u7f6eIP\u5730\u5740\uff1a\n/ip address add address=192.168.88.31/24 interface=ether1\n# \u521b\u5efa2\u4e2aWireguard\u63a5\u53e3\uff0c\u5206\u522b\u5bf9\u5e94R1\u548cR3\uff0c\u76d1\u542c\u7aef\u53e3\u5206\u522b\u4f7f\u752813231\u548c13230\n/interface wireguard add listen-port=13231 name=wireguard1-R1\n/interface wireguard add listen-port=13230 name=wireguard2-R3\n\n# R3\u8def\u7531\u5668 \u914d\u7f6eIP\u5730\u5740\uff0c\u5728R3\u8def\u7531\u5668\u6dfb\u52a0bridge-lan\u768410.10.10.1\uff1a\n/ip address add address=192.168.88.32/24 interface=ether1\n/ip address add address=10.10.10.1/24 interface=bridge1\n# \u521b\u5efa2\u4e2aWireguard\u63a5\u53e3\uff0c\u5206\u522b\u5bf9\u5e94R2\u548cR3\uff0c\u76d1\u542c\u7aef\u53e3\u5206\u522b\u4f7f\u752813231\u548c13232\n/interface wireguard add listen-port=13232 name=wireguard1-R1\n/interface wireguard add listen-port=13230 name=wireguard2-R2\n\n### Wireguard\u8fde\u63a5 ###\n# 3\u53f0\u8def\u7531\u5668\u7684\u521b\u5efa\u4e24\u4e2aWireguard\u63a5\u53e3\uff0c\u5206\u522b\u548c\u8fdc\u7aef\u7684\u4e24\u53f0\u8fde\u63a5\uff0c\u7ec4\u6210\u4e00\u4e2a\u73af\u5f62\u7f51\u7edc \uff0c\u591a\u63a5\u53e3\u7684wireguard\u5b9e\u4f8b\u624d\u80fd\u8ba9peer\u901a\u8fc7\u76f8\u540c\u7684IP\u6bb5\uff0c\u591a\u70b9\u7684OSPF\u7ec4\u64ad\u901a\u4fe1\u5141\u8bb8224.0.0.5\u901a\u8fc7\u624d\u80fd\u5b9e\u73b0\n\n# R1\u8def\u7531\u5668\n/ip address add address=172.16.0.1/30 interface=wireguard1-R2\n/ip address add address=172.17.0.1/30 interface=wireguard2-R3\n# R2\u8def\u7531\u5668\n/ip address add address=172.16.0.2/30 interface=wireguard1-R1\n/ip address add address=172.18.0.1/30 interface=wireguard2-R3\n# R3\u8def\u7531\u5668\n/ip address add address=172.17.0.2/30 interface=wireguard1-R1\n/ip address add address=172.18.0.2/30 interface=wireguard2-R2\n\n\n# R1\u8def\u7531\u5668\u8fde\u63a5R2\u548cR3\u8def\u7531\u5668\uff0cR2\u8fde\u63a5IP192.168.88.31\uff0c\u6307\u5b9a\u7aef\u53e313231\u548c\u5bf9\u7aef\u7684Public key\uff0c R3\u8fde\u63a5192.168.88.32\u4f7f\u752813232\u8fde\u63a5 \uff0c\u8bbe\u7f6e\u76f8\u5e94\u7684allowed-address\u901a\u8fc7\n/interface/wireguard/peers/add allowed-address=172.16.0.0/30,192.168.10.0/24,224.0.0.5/32 comment=R2 endpoint-address=192.168.88.31 endpoint-port=13231 interface=wireguard1-R2 persistent-keepalive=10s public-key=\"eeUEscll0VQOGIcmF9vDHEzX8oeUiXQFIoVxG/JMEQ4=\"\n/interface/wireguard/peers/add allowed-address=172.17.0.0/30,192.168.10.0/24,224.0.0.5/32 comment=R3 endpoint-address=192.168.88.32 endpoint-port=13232 interface=wireguard2-R3 persistent-keepalive=10s public-key=\"mtPhuqpAKTjISgHItQsX4J8Eh0xQitx+ANhOszfIrgQ=\"\n\n# R2\u8def\u7531\u5668\u8fde\u63a5R1\u548cR3\u8def\u7531\u5668\uff0cR1\u8fde\u63a5IP192.168.88.30\uff0c\u6307\u5b9a\u7aef\u53e313231\u548c\u5bf9\u7aef\u7684Public key\uff0c R3\u8fde\u63a5192.168.88.32\u4f7f\u752813230\u8fde\u63a5 \uff0c\u8bbe\u7f6e\u76f8\u5e94\u7684allowed-address\u901a\u8fc7\n/interface/wireguard/peers/add allowed-address=172.16.0.0/30,192.168.10.0/24,224.0.0.5/32 comment=R1 endpoint-address=192.168.99.30 endpoint-port=13231 interface=wireguard1-R1 persistent-keepalive=10s public-key= \"x4nugLg1yrJH1rdwuXbI1OO/ih8kAwuA4ez29/iYCyQ=\"\n/interface/wireguard/peers/add allowed-address=172.18.0.0/30,192.168.10.0/24,224.0.0.5/32 comment=R3 endpoint-address=192.168.99.32 endpoint-port=13230 interface=wireguard2-R3 persistent-keepalive=10s public-key= \"WpkkCwhtiWIjDITZN2mfe82oEUbdMAU9/70oRoZ2zwQ=\"\n\n# R3\u8def\u7531\u5668\u8fde\u63a5R1\u548cR2\u8def\u7531\u5668\uff0cR1\u8fde\u63a5IP192.168.88.30\uff0c\u6307\u5b9a\u7aef\u53e313232\u548c\u5bf9\u7aef\u7684Public key\uff0c R2\u8fde\u63a5192.168.88.31\u4f7f\u752813230\u8fde\u63a5 \uff0c\u8bbe\u7f6e\u76f8\u5e94\u7684allowed-address\u901a\u8fc7\n/interface/wireguard/peers/add allowed-address=172.17.0.0/30,192.168.10.0/24,224.0.0.5/32 comment=R1 endpoint-address=192.168.99.30 endpoint-port=13232 interface=wireguard1-R1 persistent-keepalive=10s public-key=\"CvOoGQqfIh76q9fVf04Km9IJtdqDLOY4Owr0hNj9ow4=\"\n/interface/wireguard/peers/add allowed-address=172.18.0.0/30,192.168.10.0/24,224.0.0.5/32 comment=R2 endpoint-address=192.168.99.31 endpoint-port=13230 interface=wireguard2-R2 persistent-keepalive=10s public-key= \"9Sm+3ZoJZ/ixPk7RY7dtkDM4dWRXaNu7rLjx/HvEmV4=\"\n\n### OSPF\u914d\u7f6e ###\n## R1\u8def\u7531\u5668 \n# \u521b\u5efaospf\u5b9e\u4f8b\uff0c\u8bbe\u7f6earea\u533a\u57df0\n/routing ospf instance add disabled=no name=ospf-instance-1 redistribute=static\n/routing ospf area add disabled=no instance=ospf-instance-1 name=ospf-area-0\n# R1\u4e0eR2\u548cR3\u5efa\u7acbOSPF\u5173\u7cfb\n/routing ospf interface-template add area=ospf-area-0 disabled=no networks=172.16.0.0/30 type=ptp\n/routing ospf interface-template add area=ospf-area-0 disabled=no networks=172.17.0.0/30 type=ptp\n\n## R2\u8def\u7531\u5668 \n# \u521b\u5efaospf\u5b9e\u4f8b\uff0c\u8bbe\u7f6earea\u533a\u57df0\n/routing ospf instance add disabled=no name=ospf-instance-1\n/routing ospf area add disabled=no instance=ospf-instance-1 name=ospf-area-0\n# R2\u4e0eR1\u548cR3\u5efa\u7acbOSPF\u5173\u7cfb\n/routing ospf interface-template add area=ospf-area-0 disabled=no networks=172.16.0.0/30 type=ptp\n/routing ospf interface-template add area=ospf-area-0 disabled=no networks=172.18.0.0/30 type=ptp\n\n## R3\u8def\u7531\u5668 \n# \u521b\u5efaospf\u5b9e\u4f8b\uff0c\u8bbe\u7f6earea\u533a\u57df0\n/routing ospf instance add disabled=no name=ospf-instance-1\n/routing ospf area add disabled=no instance=ospf-instance-1 name=ospf-area-1\n# R3\u4e0eR1\u548cR2\u5efa\u7acbOSPF\u5173\u7cfb\n/routing ospf interface-template add area=ospf-area-1 disabled=no networks=172.18.0.0/30 type=ptp\n/routing ospf interface-template add area=ospf-area-1 disabled=no networks=172.17.0.0/30 type=ptp\n/routing ospf interface-template add area=ospf-area-1 disabled=no networks=10.10.10.0/24\n\n</code></pre>"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/RouterOS%20Wireguard%2BOSPF%20Mesh%E7%BB%84%E7%BD%91/#_2","title":"RouterOS Wireguard+OSPF Mesh\u7ec4\u7f51","text":""},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/RouterOS%20Wireguard%2BOSPF%20Mesh%E7%BB%84%E7%BD%91/#ospf","title":"OSPF\u914d\u7f6e","text":"<p>\u67e5\u770bR3\u7684OSPF\u90bb\u5c45\u5173\u7cfb\uff0c\u5230R1\u548cR2\u7684state\u72b6\u6001\u4e3aFull\uff0c\u67e5\u770bR1\u548cR2\u7684OSPF\u72b6\u6001\u8fd9\u91cc\u4e0d\u518d\u5c55\u793a\u3002</p> <pre><code>/routing/ospf/neighbor print\nFlags: V - virtual; D - dynamic\n0 D instance=ospf-instance-1 area=ospf-area-1 address=172.17.0.1 router-id=172.17.0.1 state=\"Full\" state-changes=4 adjacency=32m11s\ntimeout=39s\n\n1 D instance=ospf-instance-1 area=ospf-area-1 address=172.18.0.1\nrouter-id=172.18.0.1 state=\"Full\" state-changes=5 adjacency=34m21s\ntimeout=39s\n[admin@R3] /routing/ospf/neighbor&gt;\n</code></pre> <p>\u67e5\u770bR1\u7684\u8def\u7531\uff0c\u53ef\u4ee5\u770b\u5230192.168.10.0/24\u8def\u7531\u6765\u81f3172.17.0.2%wireguard2-R3\uff0c\u5f53\u524dR1\u5230R3\u662f\u76f4\u63a5\u8fde\u63a5\u3002</p> <pre><code>[admin@R1] /ip/route&gt; print\nFlags: D - DYNAMIC; A - ACTIVE; c, o, d, y - COPY; + - ECMP\nColumns: DST-ADDRESS, GATEWAY, DISTANCE\nDST-ADDRESS GATEWAY DISTANCE\nDAd 0.0.0.0/0 192.168.88.1 1\nDAc 172.16.0.0/30 wireguard1-R2 0\nDAc 172.17.0.0/30 wireguard2-R3 0\nDAo+ 172.18.0.0/30 172.16.0.2%wireguard1-R2 110\nDAo+ 172.18.0.0/30 172.17.0.2%wireguard2-R3 110\nDAo 192.168.10.0/24 172.17.0.2%wireguard2-R3 110\nDAc 192.168.88.0/24 ether1 0\n</code></pre> <p>\u67e5\u770bR2\u7684\u8def\u7531</p> <pre><code>[admin@R2] /routing/ospf&gt; /ip route print\nFlags: D - DYNAMIC; A - ACTIVE; c, o, d, y - COPY; + - ECMP\nColumns: DST-ADDRESS, GATEWAY, DISTANCE\nDST-ADDRESS GATEWAY DISTANCE\nDAd 0.0.0.0/0 192.168.88.1 1\nDAc 172.16.0.0/30 wireguard1-R1 0\nDAo+ 172.17.0.0/30 172.16.0.1%wireguard1-R1 110\nDAo+ 172.17.0.0/30 172.18.0.2%wireguard2-R3 110\nDAc 172.18.0.0/30 wireguard2-R3 0\nDAo 192.168.10.0/24 172.18.0.2%wireguard2-R3 110\nDAc 192.168.88.0/24 ether1 0\n</code></pre> <p>\u4e2d\u65adR3\u5230R1\u7684wireguard\u8fde\u63a5\uff0cR3\u548cR1\u4e4b\u95f4\u7684OSPF\u4e2d\u65ad\uff0cOSPF\u53d1\u5e03\u7684\u8def\u7531\u5c06\u4eceR3-&gt;R2-&gt;R1,\u53ef\u4ee5\u67e5\u770bR1\u7684\u8def\u7531\u8868\uff0c\u5230192.168.10.0/24\u7684\u8def\u7531\u6765\u81f3172.16.0.2%wireguard1-R2\uff0cR1\u5230192.168.10.0/24\u8def\u7531\u81ea\u52a8\u5207\u6362\u5230R1-&gt;R2-&gt;R3\u3002</p> <pre><code>[admin@R1] /interface/wireguard&gt; /ip route/print\nFlags: D - DYNAMIC; A - ACTIVE; c, o, d, y - COPY\nColumns: DST-ADDRESS, GATEWAY, DISTANCE\nDST-ADDRESS GATEWAY DISTANCE\nDAd 0.0.0.0/0 192.168.88.1 1\nDAc 172.16.0.0/30 wireguard1-R2 0\nDAc 172.17.0.0/30 wireguard2-R3 0\nDAo 172.18.0.0/30 172.16.0.2%wireguard1-R2 110\nDAo 192.168.10.0/24 172.16.0.2%wireguard1-R2 110\nDAc 192.168.88.0/24 ether1 0\n</code></pre> <p>\u4eceR3\u53d1\u5e03\u7684\u8def\u7531R1\u548cR2\u90fd\u80fd\u5b66\u4e60\u5230\uff0c\u5373\u4f7fR1\u5230R3\u8def\u7531\u4e2d\u65ad\uff0cR1\u4e5f\u80fd\u4eceR2\u5b66\u4e60\u5230R3\u53d1\u5e03\u7684192.168.10.0/24\u7684\u8def\u7531\uff0c\u8fd9\u6837\u5728\u57fa\u4e8eWireguard\u7ec4\u5efa\u7684Mesh\u7f51\u7edc\u4e2d\uff0c\u4f7f\u7528OSPF\u5b9e\u73b0\u4e86\u7f51\u7edc\u81ea\u6108\u80fd\u529b\u3002</p> <p>\u9009\u62e9\u9759\u6001\u8def\u7531\u4e5f\u53ef\u4ee5\u5b9e\u73b0\uff0cR1\u5230R3\u7684192.168.10.0/24\u9700\u914d\u7f6e\u4e24\u6761\u9759\u6001\u8def\u7531\uff0c\u4e00\u6761\u7ecf\u8fc7R2\u5230R3\uff0c\u4e00\u6761\u76f4\u63a5\u5230R3\uff0c\u540c\u65f6R2\u8fd8\u8981\u914d\u7f6e\u9759\u6001\u8def\u7531\uff0c\u7136\u540e\u901a\u8fc7distance\u6765\u63a7\u5236\u8ddd\u79bb\uff0c\u8fd8\u9700\u8981\u901a\u8fc7\u7f51\u7edc\u76d1\u63a7\u5224\u65ad\u7ebf\u8def\u662f\u5426\u4e2d\u65ad\uff0c\u6574\u4e2a\u4e00\u5957\u914d\u7f6e\u5f88\u7e41\u7410\u590d\u6742\uff0c\u4f7f\u7528OSPF\u7b80\u5316\u4e86\u5f88\u591a\u914d\u7f6e\u3002</p> <p>\u6574\u5957\u914d\u7f6e\u601d\u8def\u5982\u679c\u4f60\u80fd\u7406\u89e3\uff0c\u653e\u5728Openwrt\u6216\u8005\u5176\u4ed6Linux\u4e0a\uff0c\u7ed3\u5408OSPF\u8def\u7531\u534f\u8bae\uff0c\u4e5f\u80fd\u6309\u7167\u8fd9\u4e2a\u65b9\u5f0f\u90e8\u7f72\uff0c\u5e76\u4e0d\u662f\u4e00\u5b9a\u5c40\u9650\u4e8eRouterOS\u5e73\u53f0\uff0c\u53ea\u662fRouterOS\u5728\u914d\u7f6e\u7684UI\u65b9\u9762\u8981\u80dc\u8fc7Openwrt\u548c\u5176\u4ed6Linux\u3002RouterOS\u9010\u6b65\u5b8c\u5584Container\u540e\uff0c\u5728\u53ef\u73a9\u6027\u65b9\u9762\u4e5f\u5f00\u59cb\u8d76\u4e0aOpenwrt\u3002</p>"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/RouterOS%20Wireguard%E5%AE%98%E7%BD%91%E8%AF%B4%E6%98%8E/","title":"\u5e94\u7528\u5b9e\u4f8b","text":""},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/RouterOS%20Wireguard%E5%AE%98%E7%BD%91%E8%AF%B4%E6%98%8E/#wireguard","title":"\u7ad9\u70b9\u5230\u7ad9\u70b9 WireGuard \u96a7\u9053","text":"<p>\u8003\u8651\u5982\u4e0b\u56fe\u6240\u793a\u7684\u8bbe\u7f6e\u3002\u4e24\u4e2a\u8fdc\u7a0b\u529e\u516c\u5ba4\u8def\u7531\u5668\u8fde\u63a5\u5230\u4e92\u8054\u7f51\uff0c\u529e\u516c\u5ba4\u5de5\u4f5c\u7ad9\u4f4d\u4e8e NAT \u540e\u9762\u3002\u6bcf\u4e2a\u529e\u516c\u5ba4\u90fd\u6709\u81ea\u5df1\u7684\u672c\u5730\u5b50\u7f51\uff0cOffice1 \u4e3a 10.1.202.0/24\uff0cOffice2 \u4e3a 10.1.101.0/24\u3002\u4e24\u4e2a\u8fdc\u7a0b\u529e\u516c\u5ba4\u90fd\u9700\u8981\u5728\u8def\u7531\u5668\u540e\u9762\u5efa\u7acb\u901a\u5f80\u672c\u5730\u7f51\u7edc\u7684\u5b89\u5168\u96a7\u9053\u3002</p> <p></p>"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/RouterOS%20Wireguard%E5%AE%98%E7%BD%91%E8%AF%B4%E6%98%8E/#wireguard_1","title":"WireGuard \u63a5\u53e3\u914d\u7f6e","text":"<p>\u9996\u5148\uff0c\u5fc5\u987b\u5728\u4e24\u4e2a\u7ad9\u70b9\u4e0a\u914d\u7f6e WireGuard \u63a5\u53e3\uff0c\u4ee5\u5141\u8bb8\u81ea\u52a8\u751f\u6210\u79c1\u94a5\u548c\u516c\u94a5\u3002\u4e24\u4e2a\u8def\u7531\u5668\u7684\u547d\u4ee4\u76f8\u540c\uff1a</p> <pre><code>/interface/wireguard/add listen-port=13231 name=wireguard1\n</code></pre> <p>\u73b0\u5728\uff0c\u5f53\u6253\u5370\u63a5\u53e3\u8be6\u7ec6\u4fe1\u606f\u65f6\uff0c\u79c1\u94a5\u548c\u516c\u94a5\u90fd\u5e94\u8be5\u53ef\u89c1\u4ee5\u5141\u8bb8\u4ea4\u6362\u3002</p> <p>\u8fdc\u7a0b\u7aef\u8bbe\u5907\u6c38\u8fdc\u4e0d\u9700\u8981\u4efb\u4f55\u79c1\u94a5 - \u56e0\u6b64\u79f0\u4e3a\u79c1\u6709\u3002</p> <p>\u529e\u516c\u5ba41</p> <pre><code>/interface/wireguard/print\nFlags: X - disabled; R - running 0 R name=\"wireguard1\"   mtu=1420   listen-port=13231   private-key=\"yKt9NJ4e5qlaSgh48WnPCDCEkDmq+VsBTt/DDEBWfEo=\"   public-key=\"u7gYAg5tkioJDcm3hyS7pm79eADKPs/ZUGON6/fF3iI=\"\n</code></pre> <p>\u529e\u516c\u5ba42</p> <pre><code>/interface/wireguard/print\nFlags: X - disabled; R - running 0 R name=\"wireguard1\"   mtu=1420   listen-port=13231   private-key=\"KMwxqe/iXAU8Jn9dd1o5pPdHep2blGxNWm9I944/I24=\"   public-key=\"v/oIzPyFm1FPHrqhytZgsKjU7mUToQHLrW+Tb5e601M=\"\n</code></pre>"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/RouterOS%20Wireguard%E5%AE%98%E7%BD%91%E8%AF%B4%E6%98%8E/#_2","title":"\u5bf9\u7b49\u914d\u7f6e","text":"<p>\u5bf9\u7b49\u914d\u7f6e\u5b9a\u4e49\u8c01\u53ef\u4ee5\u4f7f\u7528 WireGuard \u63a5\u53e3\u4ee5\u53ca\u53ef\u4ee5\u901a\u8fc7\u5b83\u53d1\u9001\u4ec0\u4e48\u7c7b\u578b\u7684\u6d41\u91cf\u3002\u4e3a\u4e86\u8bc6\u522b\u8fdc\u7a0b\u5bf9\u7b49\u4f53\uff0c\u5fc5\u987b\u5c06\u5176\u516c\u94a5\u4e0e\u521b\u5efa\u7684 WireGuard \u63a5\u53e3\u4e00\u8d77\u6307\u5b9a\u3002</p> <p>\u529e\u516c\u5ba41</p> <pre><code>/interface/wireguard/peers/add allowed-address=10.1.101.0/24   endpoint-address=192.168.80.1   endpoint-port=13231   interface=wireguard1   \\public-key=\"v/oIzPyFm1FPHrqhytZgsKjU7mUToQHLrW+Tb5e601M=\"\n</code></pre> <p>\u529e\u516c\u5ba42</p> <pre><code>/interface/wireguard/peers/add allowed-address=10.1.202.0/24   endpoint-address=192.168.90.1   endpoint-port=13231   interface=wireguard1   \\public-key=\"u7gYAg5tkioJDcm3hyS7pm79eADKPs/ZUGON6/fF3iI=\"\n</code></pre>"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/RouterOS%20Wireguard%E5%AE%98%E7%BD%91%E8%AF%B4%E6%98%8E/#ip","title":"IP\u548c\u8def\u7531\u914d\u7f6e","text":"<p>\u6700\u540e\uff0c\u5fc5\u987b\u914d\u7f6e IP \u548c\u8def\u7531\u4fe1\u606f\u4ee5\u5141\u8bb8\u901a\u8fc7\u96a7\u9053\u53d1\u9001\u6d41\u91cf\u3002</p> <p>\u529e\u516c\u5ba41</p> <pre><code>/ip/address/add address=10.255.255.1/30   interface=wireguard1/ip/routeadd dst-address=10.1.101.0/24   gateway=wireguard1\n</code></pre> <p>\u529e\u516c\u5ba42</p> <pre><code>/ip/address/add address=10.255.255.2/30   interface=wireguard1/ip/routeadd dst-address=10.1.202.0/24   gateway=wireguard1\n</code></pre>"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/RouterOS%20Wireguard%E5%AE%98%E7%BD%91%E8%AF%B4%E6%98%8E/#_3","title":"\u9632\u706b\u5899\u6ce8\u610f\u4e8b\u9879","text":"<p>\u9ed8\u8ba4\u7684 RouterOS \u9632\u706b\u5899\u5c06\u963b\u6b62\u96a7\u9053\u6b63\u786e\u5efa\u7acb\u3002\u5728\u4e24\u4e2a\u7ad9\u70b9\u4e0a\u6267\u884c\u4efb\u4f55\u4e22\u5f03\u89c4\u5219\u4e4b\u524d\uff0c\u5e94\u5728\u201c\u8f93\u5165\u201d\u94fe\u4e2d\u63a5\u53d7\u6d41\u91cf\u3002</p> <p>\u529e\u516c\u5ba41</p> <pre><code>/ip/firewall/filter/add action=accept   chain=input   dst-port=13231   protocol=udp   src-address=192.168.80.1\n</code></pre> <p>\u529e\u516c\u5ba42</p> <pre><code>/ip/firewall/filter/add action=accept   chain=input   dst-port=13231   protocol=udp   src-address=192.168.90.1\n</code></pre> <p>\u6b64\u5916\uff0c\u201c\u8f6c\u53d1\u201d\u94fe\u4e5f\u53ef\u80fd\u9650\u5236\u5b50\u7f51\u4e4b\u95f4\u7684\u901a\u4fe1\uff0c\u56e0\u6b64\u4e5f\u5e94\u5728\u4efb\u4f55\u4e22\u5f03\u89c4\u5219\u4e4b\u524d\u63a5\u53d7\u6b64\u7c7b\u6d41\u91cf\u3002</p> <p>\u529e\u516c\u5ba41</p> <pre><code>/ip/firewall/filter/add action=accept   chain=forward   dst-address=10.1.202.0/24   src-address=10.1.101.0/24add action=accept   chain=forward   dst-address=10.1.101.0/24   src-address=10.1.202.0/24\n</code></pre> <p>\u529e\u516c\u5ba42</p> <pre><code>/ip/firewall/filter/add action=accept   chain=forward   dst-address=10.1.101.0/24   src-address=10.1.202.0/24add action=accept   chain=forward   dst-address=10.1.202.0/24   src-address=10.1.101.0/24\n</code></pre>"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/RouterOS%20Wireguard%E5%AE%98%E7%BD%91%E8%AF%B4%E6%98%8E/#roadwarrior-wireguard","title":"RoadWarrior WireGuard \u96a7\u9053","text":""},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/RouterOS%20Wireguard%E5%AE%98%E7%BD%91%E8%AF%B4%E6%98%8E/#_4","title":"\u8def\u7531\u5668\u64cd\u4f5c\u7cfb\u7edf\u914d\u7f6e","text":"<p>\u6dfb\u52a0\u65b0\u7684 WireGuard \u63a5\u53e3\u5e76\u4e3a\u5176\u5206\u914d IP \u5730\u5740\u3002</p> <pre><code>/interface wireguard add listen-port=13230   name=wireguard_phone\n/ip address add address=192.168.100.1/24   interface=wireguard_phone\n\n\n# \u8fdc\u7a0b\u8bbe\u5907\u4e0a\u914d\u7f6e\u516c\u94a5\u3002\u8981\u83b7\u53d6\u516c\u94a5\u503c\n/interface wireguard peers add allowed-address=192.168.100.2/32 interface=wireguard_phone public-key=\"eeUEscll0VQOGIcmF9vDHEzX8oeUiXQFIoVxG/JMEQ4=\"\n\n# \u914d\u7f6e\u9632\u706b\u5899\n/ip firewall filter add action=accept   chain=input   comment=\"allow WireGuard\"   dst-port=13231   protocol=udp   place-before=1\n/ip firewall filter add action=accept   chain=input   comment=\"allow WireGuard traffic\"   src-address=192.168.100.0/24   place-before=1\n\n\n</code></pre> <p>\u6dfb\u52a0\u65b0\u7684 WireGuard \u63a5\u53e3\u5c06\u81ea\u52a8\u751f\u6210\u4e00\u5bf9\u79c1\u94a5\u548c\u516c\u94a5\u3002\u60a8\u9700\u8981\u5728\u8fdc\u7a0b\u8bbe\u5907\u4e0a\u914d\u7f6e\u516c\u94a5\u3002\u8981\u83b7\u53d6\u516c\u94a5\u503c\uff0c\u53ea\u9700\u6253\u5370\u51fa\u63a5\u53e3\u8be6\u7ec6\u4fe1\u606f\u5373\u53ef\u3002</p> <pre><code>[admin@home] &gt; /interface wireguard print\n      name=\"wireguard_phone\" mtu=1420 listen-port=13230 \n      private-key=\"4OibiJsDYkzcCESyjymR+YTG52moUASeMUfuFmlM+Hw=\" \n      public-key=\"P7+6bhaZJfKG5XsYzGm+xnntTo/m1BQaAt9cyEsQ3BY=\" \n</code></pre> <p>\u9632\u706b\u5899\u6ce8\u610f\u4e8b\u9879</p> <p>\u5982\u679c\u60a8\u914d\u7f6e\u4e86\u9ed8\u8ba4\u6216\u4e25\u683c\u7684\u9632\u706b\u5899\uff0c\u5219\u9700\u8981\u5141\u8bb8\u8fdc\u7a0b\u8bbe\u5907\u4e0e\u60a8\u7684\u8bbe\u5907\u5efa\u7acb WireGuard \u8fde\u63a5\u3002</p> <pre><code>\n</code></pre> <p>\u8981\u5141\u8bb8\u8fdc\u7a0b\u8bbe\u5907\u8fde\u63a5\u5230 RouterOS \u670d\u52a1\uff08\u4f8b\u5982\u8bf7\u6c42 DNS\uff09\uff0c\u8bf7\u5728\u8f93\u5165\u94fe\u4e2d\u5141\u8bb8 WireGuard \u5b50\u7f51\u3002</p> <pre><code>\n</code></pre> <p>\u6216\u8005\u53ea\u9700\u5c06 WireGuard \u63a5\u53e3\u6dfb\u52a0\u5230\u201cLAN\u201d\u63a5\u53e3\u5217\u8868\u4e2d\u3002</p>"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/RouterOS%20Wireguard%E5%AE%98%E7%BD%91%E8%AF%B4%E6%98%8E/#ios","title":"iOS\u914d\u7f6e","text":"<p>\u4ece App Store \u4e0b\u8f7d WireGuard \u5e94\u7528\u7a0b\u5e8f\u3002\u6253\u5f00\u5b83\u5e76\u4ece\u5934\u5f00\u59cb\u521b\u5efa\u4e00\u4e2a\u65b0\u914d\u7f6e\u3002</p> <p></p> <p>\u9996\u5148\uff0c\u4e3a\u60a8\u7684\u8fde\u63a5\u6307\u5b9a\u4e00\u4e2a\u201c\u540d\u79f0\u201d\u5e76\u9009\u62e9\u751f\u6210\u5bc6\u94a5\u5bf9\u3002\u751f\u6210\u7684\u516c\u94a5\u5bf9\u4e8e RouterOS \u7aef\u7684\u5bf9\u7b49\u914d\u7f6e\u662f\u5fc5\u9700\u7684\u3002</p> <p>** **</p> <p>\u5728\u201c\u5730\u5740\u201d\u5b57\u6bb5\u4e2d\u6307\u5b9a\u4e0e\u670d\u52a1\u5668\u7aef\u914d\u7f6e\u4f4d\u4e8e\u540c\u4e00\u5b50\u7f51\u4e2d\u7684 IP \u5730\u5740\u3002\u8be5\u5730\u5740\u5c06\u7528\u4e8e\u901a\u4fe1\u3002\u5bf9\u4e8e\u672c\u4f8b\uff0c\u6211\u4eec\u5728 RouterOS \u7aef\u4f7f\u7528 192.168.100.1/24\uff0c\u60a8\u53ef\u4ee5\u5728\u8fd9\u91cc\u4f7f\u7528 192.168.100.2\u3002</p> <p>\u5982\u6709\u5fc5\u8981\uff0c\u914d\u7f6e DNS \u670d\u52a1\u5668\u3002\u5982\u679c RouterOS \u7aef\u7684 IP/DNS \u90e8\u5206\u4e0b\u7684 allowed-remote-requests \u8bbe\u7f6e\u4e3a yes\uff0c\u60a8\u53ef\u4ee5\u5728\u6b64\u5904\u6307\u5b9a\u8fdc\u7a0b WireGuard IP \u5730\u5740\u3002</p> <p>** **</p> <p>\u5355\u51fb\u201c\u6dfb\u52a0\u5bf9\u7b49\u70b9\u201d\uff0c\u663e\u793a\u66f4\u591a\u53c2\u6570\u3002</p> <p>\u201c\u516c\u94a5\u201d\u503c\u662f\u5728 RouterOS \u7aef\u7684 WireGuard \u63a5\u53e3\u4e0a\u751f\u6210\u7684\u516c\u94a5\u503c\u3002</p> <p>\u201c\u7aef\u70b9\u201d\u662f iOS \u8bbe\u5907\u53ef\u4ee5\u901a\u8fc7 Internet \u8fdb\u884c\u901a\u4fe1\u7684 RouterOS \u8bbe\u5907\u7684 IP \u6216 DNS \u4ee5\u53ca\u7aef\u53e3\u53f7\u3002</p> <p>\u201c\u5141\u8bb8\u7684 IP\u201d\u8bbe\u7f6e\u4e3a 0.0.0.0/0 \u4ee5\u5141\u8bb8\u6240\u6709\u6d41\u91cf\u901a\u8fc7 WireGuard \u96a7\u9053\u53d1\u9001\u3002</p> <p></p>"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/RouterOS%20Wireguard%E5%AE%98%E7%BD%91%E8%AF%B4%E6%98%8E/#windows-10","title":"Windows 10 \u914d\u7f6e","text":"<p>\u4ece Wireguard \u4e0b\u8f7d WireGuard \u5b89\u88c5\u7a0b\u5e8f \u4ee5\u7ba1\u7406\u5458\u8eab\u4efd\u8fd0\u884c\u3002</p> <p></p> <p>\u6309 Ctrl+n \u6dfb\u52a0\u65b0\u7684\u7a7a\u96a7\u9053\uff0c\u6dfb\u52a0\u63a5\u53e3\u540d\u79f0\uff0c\u516c\u94a5\u5e94\u81ea\u52a8\u751f\u6210\uff0c\u5c06\u5176\u590d\u5236\u5230 RouterOS \u5bf9\u7b49\u914d\u7f6e\u3002 \u6dfb\u52a0\u5230\u670d\u52a1\u5668\u914d\u7f6e\uff0c\u5b8c\u6574\u914d\u7f6e\u5982\u4e0b\u6240\u793a\uff08\u5c06\u81ea\u52a8\u751f\u6210\u7684\u79c1\u94a5\u4fdd\u7559\u5728 [Interface] \u90e8\u5206\u4e2d\uff1a</p> <p>\u5448\u73b0\u4ee3\u7801\u5b8f\u51fa\u9519: \u53c2\u6570'com.atlassian.confluence.ext.code.render.InvalidValueException'\u7684\u503c\u65e0\u6548</p> <pre><code>[\u754c\u9762]\n\u79c1\u94a5 = your_auto generated_public_key=\n\u5730\u5740 = 192.168.100.3/24\nDNS = 192.168.100.1\n\n[\u540c\u884c]\n\u516c\u94a5 = your_MikroTik_public_KEY=\n\u5141\u8bb8\u7684IP = 0.0.0.0/0\n\u7aef\u70b9 = example.com:13231\n</code></pre> <p>\u4fdd\u5b58\u5e76\u6fc0\u6d3b</p>"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/RouterOS%E4%B8%8EUbuntu20.04%E5%BB%BA%E7%AB%8BWireGuard/","title":"RouterOS\u4e0eUbuntu20.04\u5efa\u7acbWireGuard","text":"<p>\u8003\u8651\u8fd9\u6837\u4e00\u4e2a\u7f51\u7edc\u60c5\u51b5\uff0c\u5f53\u4e24\u4e2a\u5f02\u5730\u529e\u516c\u533a\uff0cofficeA\u548cofficeB\u9700\u8981\u5efa\u7acbWireGuard\u96a7\u9053\uff0cofficeA\u662fRouterOS\uff0c\u800cofficeB\u662f\u666e\u901a\u8def\u7531\u5668\uff0c\u53d7\u9650\u4e8e\u666e\u901a\u8def\u7531\u5668\u4e0d\u652f\u6301WireGuard\u534f\u8bae\uff0c\u65e0\u6cd5\u5efa\u7acb\u4e92\u8054\uff0c\u4f46officeB\u53ef\u4ee5\u642d\u5efaVM\u865a\u62df\u673a\u642d\u5efa\u4e00\u53f0ubuntu20.04\u670d\u52a1\u5668\uff0c\u8fd9\u6837\u53ef\u4ee5\u901a\u8fc7ubuntu20.04\u4e0eRouterOS\u5efa\u7acbWireGuard\u7684\u4e92\u8054\uff0c\u5982\u4e0b\u62d3\u6251\uff1a</p> <p></p> <p>\u5728\u8fd9\u4e2a\u62d3\u6251\u4e0a\u53ef\u4ee5\u770b\u5230\uff0cRB5009\u548cUbuntu20.04\u5efa\u7acbWireGuard\u96a7\u9053\uff0c\u5728ubuntu\u4e0b\u6709\u4e00\u4e2a\u72ec\u7acb\u7684\u7f51\u7edc192.168.50.0/24\u4e0eOfficeA\u7684192.168.88.0/24\u505a\u8def\u7531\u4e92\u8054\u8bbf\u95ee\u3002</p>"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/RouterOS%E4%B8%8EUbuntu20.04%E5%BB%BA%E7%AB%8BWireGuard/#rb5009","title":"RB5009\u914d\u7f6e","text":"<p>\u57fa\u4e8eRouterOS\u7684RB5009\uff0c\u80fd\u83b7\u53d6\u516c\u7f51IP\u5730\u5740\u4e0a\u7f51\uff0c\u5177\u4f53\u7f51\u7edc\u63a5\u5165\u914d\u7f6e\u5728\u6b64\u7701\u7565\uff0c\u76f4\u63a5\u4ecb\u7ecd\u914d\u7f6ewireguard\uff0c\u9996\u5148\u5728wireguard\u4e0b\u65b0\u5efa\u4e00\u4e2a\u63a5\u53e3wireguard1\uff0c\u5982\u4e0b\uff1a</p> <p></p> <p>\u8bb0\u5f55\u4e0bRouterOS\u4e0awireguard1\u63a5\u53e3\u7684Public Key\uff0c\u9700\u8981\u5728ubuntu\u914d\u7f6e\u65f6\u6dfb\u52a0\u3002</p> <p>RouterOS\u5728wireguard\u7684peer\u6dfb\u52a0ubuntu\u7684\u5ba2\u6237\u7aef\u8fde\u63a5\u53c2\u6570\uff08Public Key\u662f\u5df2\u7ecf\u83b7\u53d6\uff0c\u5728\u540e\u9762\u5bf9ubuntu\u914d\u7f6e\u7684\u4ecb\u7ecd\u4f1a\u6709\uff09\uff0c\u7531\u4e8eubuntu\u662f\u5728officeB\u7684\u5185\u7f51\uff0c\u6240\u4ee5\u65e0\u9700\u6307\u5b9aendpoint\u7684\u5730\u5740\u3002</p> <p></p> <p>\u8fdb\u5165/ip address\uff0c\u6dfb\u52a0wireguard1\u63a5\u53e3IP\u5730\u574010.0.0.1/24\uff0cwinbox\u914d\u7f6e\u5982\u4e0b\uff1a</p> <p></p> <p>\u5728/ip route\u4e0b\u6dfb\u52a0\u5230\u76ee\u6807IP\u5730\u5740\u6bb5192.168.50.0/24\u7684\u9759\u6001\u8def\u7531\uff0cwinbox\u914d\u7f6e\u5982\u4e0b\uff1a</p> <p></p>"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/RouterOS%E4%B8%8EUbuntu20.04%E5%BB%BA%E7%AB%8BWireGuard/#ubuntu-2004","title":"Ubuntu 20.04\u914d\u7f6e","text":"<p>\u9996\u5148\u901a\u8fc7apt-get\u66f4\u65b0\u955c\u50cf\u5e93\uff0c\u5e76\u5b89\u88c5wireguard\uff0c\u64cd\u4f5c\u5982\u4e0b\uff1a</p> <pre><code>apt-get update \napt-get install wireguard\n</code></pre> <p>\u5b89\u88c5\u5b8c\u6210\u540e\uff0cubuntu\u751f\u6210wireguard\u7684\u79c1\u94a5\u548c\u516c\u94a5\uff0c\u5e76\u5b58\u653e\u5728\u6307\u5b9a\u76ee\u5f55\u4e0b</p> <pre><code>wg genkey | tee /etc/wireguard/privatekey | wg pubkey | tee /etc/wireguard/publickey\n</code></pre> <p>\u5728/etc/wireguard/publickey\u4e0b\u67e5\u770b\u751f\u6210\u7684Public Key\uff0c\u7528\u4e8e\u6dfb\u52a0\u5230RouterOS\u7684wireguard1\u7684Peer\u914d\u7f6e\uff0c\u4e4b\u524d\u5728RouterOS\u914d\u7f6e\u63d0\u5230\u3002</p> <pre><code>cat /etc/wireguard/publickey\n</code></pre> <p>\u540c\u6837\u67e5\u770bprivatekey\uff0c\u7528\u4e8e\u53c2\u6570\u914d\u7f6e</p> <pre><code>cat /etc/wireguard/ privatekey\n</code></pre> <p>\u5728/etc/wireguard/\uff0c\u901a\u8fc7vi\u521b\u5efa\u914d\u7f6e\u6587\u4ef6wg0.conf</p> <pre><code>vi /etc/wireguard/wg0.conf\n</code></pre> <p>\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\uff0c</p> <ul> <li>Interface\u63a5\u53e3\u53c2\u6570\uff0c\u670d\u52a1\u7aef\u53e3\u662f13233,\u63a5\u53e3IP\u5730\u5740\u662f0.0.2/24\uff0c\u5e76\u8bbe\u7f6eUbuntu\u81ea\u5df1\u7684privatekey</li> <li>Peer\u4e3a\u5bf9\u7aef\u53c2\u6570\uff1aPublicKey\u586b\u5199RouterOS publickey\uff0cAllowedIPs\u586b\u5199\u9700\u8981\u901a\u8fc7\u6240\u6709IP\u5730\u5740\uff0cEndpoint\u8bbe\u7f6eRouterOS\u7684\u516c\u7f51IP\u5730\u5740\uff08\u5047\u8bbe\u4e3a88.88.88\uff09\uff0c\u7aef\u53e3\u4e3a13233\uff0c\u8bbe\u7f6ePersistentKeepalive\u4e3a25\u79d2\uff08\u7528\u4e8e\u5b58\u6d3b\u63a2\u6d4b\uff09</li> </ul> <pre><code>[Interface]\nListenPort = 13233\nAddress = 10.0.0.2/24\nPrivateKey = \u590d\u5236Ubuntu privatekey\n\n[Peer]\nPublicKey = \u590d\u5236RouterOS publickey\nAllowedIPs = 0.0.0.0/0\nEndpoint = 88.88.88.88:13233\nPersistentKeepalive = 25\n</code></pre> <p>\u7136\u540e\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u548ckey\u7684\u6743\u9650</p> <pre><code>chmod 600 /etc/wireguard/{privatekey,wg0.conf}\n</code></pre> <p>\u8fd9\u4e2a\u65f6\u5019\u5982\u679cubuntu\u4f5c\u4e3a\u8def\u7531\u63a5\u5165\u5176\u4ed6\u7f51\u7edc\uff0c\u9700\u5f00\u542fLinux\u7684ip forward\u8f6c\u53d1\u529f\u80fd\uff0c\u901avi\u7f16\u8f91/etc/sysctl.conf\uff0c\u627e\u5230\u8fd9\u4e00\u884c #net.ipv4.ip_forward = 1 \u53bb\u6389\u6ce8\u91ca\u7b26 \u201c#\u201d \u4fee\u6539\u4e3a</p> <pre><code>net.ipv4.ip_forward = 1\n</code></pre> <p>\u9000\u51favi\u7f16\u8f91\uff0c\u7acb\u5373\u751f\u6548\u6307\u4ee4\u5982\u4e0b\uff0c</p> <pre><code>sysctl -p\n</code></pre> <p>\u901a\u8fc7\u547d\u4ee4\u542f\u7528wg0\u63a5\u53e3</p> <pre><code>root@yus:~# wg-quick up wg0\n[#] ip link add wg0 type wireguard\n[#] wg setconf wg0 /dev/fd/63\n[#] ip -4 address add 10.0.0.2 dev wg0\n[#] ip link set mtu 1420 up dev wg0\n[#] wg set wg0 fwmark 51820\n[#] ip -4 route add 0.0.0.0/0 dev wg0 table 51820\n[#] ip -4 rule add not fwmark 51820 table 51820\n[#] ip -4 rule add table main suppress_prefixlength 0\n[#] sysctl -q net.ipv4.conf.all.src_valid_mark=1\n[#] iptables-restore -n\n</code></pre> <p>\u6ce8\u610f\u5f53AllowedIPs\u662f0.0.0.0/0\u65f6\uff0cLinux\u4f1a\u81ea\u52a8\u521b\u5efa\u4e00\u4e2a\u8def\u7531\u8868\uff0c\u751f\u6210\u7b56\u7565\u8def\u7531\uff0c\u5982\u679c\u4f60\u914d\u7f6e\u4e3b\u673aIP\u548cubuntu\u4e0d\u5728\u540c\u4e00\u7f51\u6bb5\uff0c\u4f1a\u9020\u6210\u8def\u7531\u4e2d\u65ad\uff0c\u5207\u8bb0\u8003\u8651\u4f60\u8fde\u63a5ubuntu\u7684IP\u914d\u7f6e</p> <p>\u901a\u8fc7wg\u547d\u4ee4\u67e5\u770b\u8fde\u63a5\u72b6\u6001</p> <pre><code>root@yus:~# wg\ninterface: wg0\npublic key: OlczskR4y1Txxxxxxxm37gOo5LoCjhHr1u0VUDzY=\nprivate key: (hidden)\nlistening port: 13233\nfwmark: 0xca6c\npeer: kwHdyhZkxxxxxPHDvMRrsgpHs=\nendpoint: 88.88.88.88:13233\nallowed ips: 0.0.0.0/0\nlatest handshake: 1 minute, 47 seconds ago\ntransfer: 10.95 KiB received, 11.41 KiB sent\npersistent keepalive: every 25 seconds\n</code></pre> <p>\u5982\u679c\u4e0d\u5e0c\u671b\u5141\u8bb8\u6240\u6709IP\u901a\u8fc7\uff0c\u53ef\u4ee5\u8fd9\u6837\u4fee\u6539\u914d\u7f6e\u6587\u4ef6</p> <pre><code>[Interface]\nListenPort = 13233\nAddress = 10.0.0.2/24\nPrivateKey = privatekey\n\n[Peer]\nPublicKey = publickey\nAllowedIPs = 10.0.0.0/24,192.168.88.0/24\nEndpoint = 88.88.88.88:13233\nPersistentKeepalive = 25\n</code></pre> <p>\u4fee\u6539AllowedIPs\u540e\uff0c\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5173\u95edwg0\u63a5\u53e3</p> <pre><code>wg-quick down wg0\n</code></pre> <p>\u518d\u6b21\u542f\u7528\u7f51\u5361\u65f6\uff0c\u53ef\u4ee5\u770b\u5230\u901a\u8fc7ip -4 route add\u6dfb\u52a0\u4e86\u9759\u6001\u8def\u7531</p> <pre><code>root@yus:~# wg-quick up wg0\n[#] ip link add wg0 type wireguard\n[#] wg setconf wg0 /dev/fd/63\n[#] ip -4 address add 10.0.0.2/24 dev wg0\n[#] ip link set mtu 1420 up dev wg0\n[#] ip -4 route add 192.168.88.0/24 dev wg0\n</code></pre> <p>\u67e5\u770b\u8def\u7531\uff0c\u53ef\u4ee5\u770b\u5230wireguard\u81ea\u52a8\u6dfb\u52a0\u4e86\u9759\u6001\u8def\u7531\uff1a</p> <pre><code>root@yus:~# ip route \ndefault via 192.168.10.1 dev ens160 proto static\n10.0.0.0/24 dev wg0 proto kernel scope link src 10.0.0.2 \n192.168.10.0/24 dev ens160 proto kernel scope link src 192.168.10.10\n192.168.50.0/24 dev ens192 proto kernel scope link src \n192.168.50.11192.168.88.0/24 dev wg0 scope link\n</code></pre> <p>\u8fd9\u6837RB5009\u548cubuntu\u7684wireguard\u96a7\u9053\u5efa\u7acb\uff0c\u53ef\u4ee5\u6d4b\u8bd5192.168.88.0/24\u5230192.168.50.0/24\u8def\u7531\u662f\u5426\u8fde\u901a\u3002</p> <p>\u63d0\u9192\uff1a192.168.50.0/24\u7f51\u7edc\u662fubuntu\u7684ens192\u7f51\u5361\u4e0b\uff0cens160\u63a5\u5165\u7684\u662f\u5b9e\u9645\u7684\u666e\u901a\u8def\u7531\u5668192.168.10.0/24\u5c40\u57df\u7f51\uff0c\u5982\u679c\u5e0c\u671b192.168.10.0/24\u80fd\u8bbf\u95ee\u5230RB\u7684192.168.88.0/24\u7f51\u7edc\uff0c\u9700\u8981\u5728\u666e\u901a\u8def\u7531\u5668\u914d\u7f6e\u9759\u6001\u8def\u7531\u6307\u5411ubuntu\u7684ens160\u7684\u63a5\u53e3IP\uff0c\u5982\u679c\u662f\u534e\u4e3a\u8def\u7531\u5668\u914d\u7f6e\u5982\u4e0b\uff1a</p> <pre><code>[HuaWei]ip route-static 192.168.88.0 24 192.168.10.10\n</code></pre> <p>RouterOS\u4e5f\u9700\u8981\u8865\u5145\u914d\u7f6e</p> <p>\u5728peer\u4e0a\u589e\u52a0\u5141\u8bb8IP\u5730\u5740\u6bb5192.168.10.0/24\uff0c\u5982\u679c\u4f60\u662f0.0.0.0/0\u5219\u65e0\u9700\u505a\u914d\u7f6e</p> <p></p> <p>\u9700\u8981\u5728ip route\u4e0b\u6dfb\u52a0\u5230192.168.10.0/24\u7ecf\u8fc710.0.0.2\u7684\u9759\u6001\u8def\u7531\uff1a</p> <p></p> <p>\u6ce8\u610f\uff1a\u4ee5\u4e0a\u914d\u7f6e\u91c7\u7528\u9759\u6001\u8def\u7531\u65b9\u5f0f\uff0c\u4e0d\u8003\u8651nat\u89c4\u5219\uff0c\u5982\u679c\u4f60\u5728ubuntu\u6216\u8005routeros\u914d\u7f6e\u4e86nat\u89c4\u5219\uff0c\u9700\u8981\u6ce8\u610f\u63a5\u53e3\u51fa\u65b9\u5411\u88ab\u8f6c\u4e3a\u63a5\u53e3IP\u5730\u5740\u7684\u60c5\u51b5\uff0c\u8fd9\u91cc\u4e0d\u505a\u8ba8\u8bba\u3002</p>"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/RouterOS%E5%88%9D%E5%A7%8B%E5%8C%96%E8%AE%BE%E7%BD%AE/","title":"RouterOS\u521d\u59cb\u5316\u8bbe\u7f6e","text":""},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/RouterOS%E5%88%9D%E5%A7%8B%E5%8C%96%E8%AE%BE%E7%BD%AE/#routeros","title":"RouterOS\u521d\u59cb\u5316\u8bbe\u7f6e","text":"<pre><code># \u65f6\u533a\n/system/clock set time-zone-name=Asia/Shanghai\n\n# \u5b89\u5168\u6027\u8bbe\u7f6e\n/ip/service set api disabled=yes \n/ip/service set api-ssl disabled=yes \n/ip/service set ftp disabled=yes \n/ip/service set ssh disabled=yes \n/ip/service set telnet disabled=yes \n/ip/service set www disabled=yes \n\n# \u6dfb\u52a0\u7f51\u6865bridge1\n/interface bridge add auto-mac=yes comment=\"defconf: Local Bridge\" name=bridge1 igmp-snooping=yes dhcp-snooping=yes igmp-version=3\n\n# \u7f51\u6865IPv4\u5730\u5740\n/ip address add address=\"10.10.10.1/24\" interface=bridge1 comment=\"defconf: Local LAN IPv4 Address\"\n\n# \u7f51\u53e3\u5907\u6ce8\n/interface set ether1 comment=\"defconf: Local LAN1\"\n/interface set ether2 comment=\"defconf: Local LAN2\"\n/interface set ether3 comment=\"defconf: Local LAN3\"\n/interface set ether4 comment=\"defconf: Local LAN4\"\n/interface set ether5 comment=\"defconf: Local LAN5\"\n/interface set ether6 comment=\"defconf: Local IPTV\"\n/interface set ether7 comment=\"defconf: Local WAN\"\n\n# \u5c06\u6240\u6709 LAN \u53e3\u90fd\u6dfb\u52a0\u5165\u8be5\u7f51\u6865\n/interface bridge port\nadd bridge=bridge1 interface=ether1\nadd bridge=bridge1 interface=ether2\nadd bridge=bridge1 interface=ether3\nadd bridge=bridge1 interface=ether4\nadd bridge=bridge1 interface=ether5\nadd bridge=bridge1 interface=ether6\n\n# \u521b\u5efa PPPoE \u5ba2\u6237\u7aef\n/interface pppoe-client add name=pppoe-out1 interface=ether7 user=085150736047 password=736047 use-peer-dns=yes add-default-route=yes disabled=no\n\n# \u5b9a\u4e49 PPPoE \u63a5\u53e3\u7ec4\n/interface list\nadd name=WAN comment=\"defconf: Connect To Global\"\nadd name=LAN comment=\"defconf: Local Bridge\"\nadd name=ONU comment=\"onuconf: Access To ONU\"\nadd name=IPTV comment=\"onuconf: Access To IPTV\"\n\n/interface list member\nadd interface=pppoe-out1 list=WAN comment=\"defconf: Connect To Global\"\nadd interface=bridge1 list=LAN comment=\"defconf: Local Bridge\"\nadd interface=ether7 list=ONU comment=\"onuconf: Access To ONU\"\nadd interface=ether6 list=IPTV comment=\"onuconf: Access To IPTV\"\n\n# \u8bbe\u7f6eDNS\n/ip/dns/set servers=223.5.5.5,114.114.114.114 allow-remote-requests=yes \n\n# \u8bbe\u7f6eDHCP pool\n/ip/pool/add name=Local_Pool_IPv4 ranges=10.10.10.50-10.10.10.250 comment=\"defconf: Local LAN IPv4 Pool\"\n\n# \u8bbe\u7f6eDHCP Server\n/ip/dhcp-server/add name=Local_DHCP_IPv4 interface=bridge1 lease-time=\"1d 00:00:00\" address-pool=Local_Pool_IPv4 comment=\"defconf: Local LAN IPv4 DHCP Server\"\n/ip/dhcp-server/network/add address=10.10.10.0/24 netmask=24 gateway=10.10.10.1 dns-server=10.10.10.1 ntp-server=10.10.10.1 comment=\"defconf: Local LAN IPv4 DHCP Network\"\n\n#\u8bbe\u7f6eNTP Client\n/system/ntp/client/set enabled=yes mode=unicast servers=cn.pool.ntp.org vrf=main \n\n#\u8bbe\u7f6eNTP Server\n/system/ntp/server/set enabled=yes broadcast=yes broadcast-addresses=10.10.10.1 vrf=main \n\n#\u8bbe\u7f6eNAT\n/ip firewall nat add action=masquerade chain=srcnat comment=\"defconf: masquerade IPv4\" out-interface-list=WAN\n\n</code></pre>"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/RouterOS%E5%88%9D%E5%A7%8B%E5%8C%96%E8%AE%BE%E7%BD%AE/#ipv6","title":"IPv6\u8bbe\u7f6e","text":"<pre><code>/ipv6/settings/set disable-ipv6=no\n/ipv6/dhcp-client/add interface=pppoe-out1 request=prefix pool-name=Local_Pool_GUA_IPv6 pool-prefix-length=64 use-peer-dns=yes add-default-route=no comment=\"defconf: DHCPv6 on PPPoE\"  \n/ipv6/address/add address=::1/64 from-pool=Local_Pool_GUA_IPv6 interface=bridge1 advertise=yes comment=\"defconf: Local LAN GUA IPv6 Address\"\n# \u8bbe\u7f6eIPv6\u6c60\n/ipv6/pool/add name=Local_Pool_ULA_IPv6 prefix=fdac::/64 prefix-length=64\n/ipv6/address/add address=::1/64 from-pool=Local_Pool_ULA_IPv6 interface=bridge1 advertise=yes comment=\"defconf: Local LAN ULA IPv6 Address\"\n/ipv6/address/add address=fdac::1/64 interface=bridge1 advertise=yes comment=\"defconf: Local LAN ULA IPv6 Address\"\n\n# \u8bbe\u7f6eND\u670d\u52a1\n/ipv6/nd/prefix/default/set valid-lifetime=02:00:00 preferred-lifetime=01:00:00\n/ipv6/nd disable numbers=0\n/ipv6/nd/add interface=bridge1 ra-interval=60-120 hop-limit=64 dns=fdac::1 advertise-mac-address=yes advertise-dns=yes\n\n</code></pre>"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/RouterOS%E5%88%9D%E5%A7%8B%E5%8C%96%E8%AE%BE%E7%BD%AE/#ddns","title":"ddns\u8bbe\u7f6e","text":"<p>\u65b0\u5efaSystem/Scripts\uff0cname: ddnsv6</p> <pre><code>##########################################\n## RouterOS DDNS \u811a\u672c for \u963f\u91cc\u4e91 / \u817e\u8baf\u4e91 IPv6\u7248\n##\n## \u8be5 DDNS \u811a\u672c\u53ef\u81ea\u52a8 \u83b7\u53d6/\u8bc6\u522b/\u66f4\u65b0 IP \u5730\u5740\n## \u517c\u5bb9 \u963f\u91cc\u4e91 / \u817e\u8baf\u4e91 DNS\u63a5\u53e3\n##\n## \u4f5c\u8005: vibbow\n## https://vsean.net/\n##\n## \u4fee\u6539\u65e5\u671f: 2023/3/15\n##########################################\n\n# \u57df\u540d\n:local domainName \"ros.t-plus.com.cn\";\n# wan\u63a5\u53e3\u540d\u79f0\n:local wanInterface \"bridge1\";\n# \u8981\u4f7f\u7528\u7684\u670d\u52a1 (aliyun/dnspod)\n:local service \"aliyun\";\n# API\u63a5\u53e3 Access ID\n:local accessID \"LTAI5tCfeuau6HYNJoXGbW5h\";\n# API\u63a5\u53e3 Access Secret\n:local accessSecret \"ojdzwQWEeAGYAWOcCvWjcqdzgXqsrv\";\n\n# \u817e\u8baf\u4e91 (dnspod) \u8bbe\u7f6e\n#\n# \u4e00\u822c\u60c5\u51b5\u4e0b\u65e0\u9700\u8bbe\u7f6e\u6b64\u5185\u5bb9\n# \u670d\u52a1\u5668\u4f1a\u81ea\u52a8\u8bc6\u522b domainID \u548c recordID\n#\n# \u5982\u4e00\u76f4\u63d0\u793a \"\u5f53\u524d\u57df\u540d\u65e0\u6743\u9650\uff0c\u8bf7\u8fd4\u56de\u57df\u540d\u5217\u8868\u3002\"\n# \u5219\u9700\u8981\u624b\u52a8\u8bbe\u7f6e\n:local domainID \"\";\n:local recordID \"\";\n\n# ==== \u4ee5\u4e0b\u5185\u5bb9\u65e0\u9700\u4fee\u6539 ====\n# =========================\n\n:local publicIP;\n:local dnsIP;\n:local epicFail false;\n\n# \u83b7\u53d6\u5f53\u524d\u63a5\u53e3IPv6\u5730\u5740\n:do {\n  :local interfaceIP [ /ipv6 address get [ :pick [ find interface=$wanInterface global ] 0 ] address ]\n  :set $interfaceIP [ :pick $interfaceIP 0 [ :find $interfaceIP \"/\" ] ];\n\n  :set $publicIP [ :toip6 $interfaceIP ];\n} \\\non-error {\n  :set $epicFail true;\n  :log error (\"DDNSv6: Get public IP failed.\");\n}\n\n# \u83b7\u53d6\u5f53\u524d\u89e3\u6790\u7684IP\n:do {\n  :set $dnsIP [ :resolve $domainName ];\n} \\\non-error {\n  :set $epicFail true;\n  :log error (\"DDNSv6: Resolve domain \" . $domainName . \" failed.\");\n}\n\n# \u5982IP\u6709\u53d8\u52a8\uff0c\u5219\u66f4\u65b0\u89e3\u6790\n:if ($epicFail = false &amp;&amp; $publicIP != $dnsIP) \\\ndo={\n    :local callUrl (\"https://ddns6.vsean.net/ddns.php\");\n    :local postData (\"service=\" . $service . \"&amp;domain=\" . $domainName . \"&amp;access_id=\" . $accessID . \"&amp;access_secret=\" . $accessSecret . \"&amp;domain_id=\" . $domainID . \"&amp;record_id=\" . $recordID);\n    :local fetchResult [/tool fetch url=$callUrl mode=https http-method=post http-data=$postData as-value output=user];\n    :log info (\"DDNSv6: \" . $fetchResult-&gt;\"data\");\n}\n\n</code></pre> <p>\u6253\u5f00\u5e76\u4fee\u6539 PPP/Profiles/default\uff0c\u5728Scripts  /  on up\u91cc\u6dfb\u52a0 ddnsv6</p>"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/RouterOS%E5%88%9D%E5%A7%8B%E5%8C%96%E8%AE%BE%E7%BD%AE/#wireguard","title":"WireGuard\u96a7\u9053\u8bbe\u7f6e","text":"<p>\u624b\u673a\u96a7\u9053\u8bbe\u7f6e\uff1a</p> <pre><code>/interface wireguard add listen-port=13230   name=wireguard_phone\n/ip address add address=192.168.100.1/24   interface=wireguard_phone\n\n\n# \u8fdc\u7a0b\u8bbe\u5907\u4e0a\u914d\u7f6e\u516c\u94a5\u3002\u8981\u83b7\u53d6\u516c\u94a5\u503c\n/interface wireguard peers add allowed-address=192.168.100.2/32 interface=wireguard_phone public-key=\"eeUEscll0VQOGIcmF9vDHEzX8oeUiXQFIoVxG/JMEQ4=\"\n\n# \u914d\u7f6e\u9632\u706b\u5899\n/ip firewall filter add action=accept   chain=input   comment=\"allow WireGuard\"   dst-port=13231   protocol=udp   place-before=1\n/ip firewall filter add action=accept   chain=input   comment=\"allow WireGuard traffic\"   src-address=192.168.100.0/24   place-before=1\n\n\n</code></pre> <pre><code>\n\n# \u8bbe\u7f6eIPv4 \u9632\u706b\u5899\n/ip firewall address-list\nadd address=10.10.10.8 comment=\"onuconf: local ONU address\" list=local_onu_ipv4\nadd address=10.10.10.0/24 comment=\"lanconf: local LAN address\" list=local_lan_ipv4\nadd address=10.10.10.2 comment=\"lanconf: local DNS server\" list=local_dns_ipv4\nadd address=0.0.0.0/8 comment=\"defconf: RFC6890\" list=no_forward_ipv4\nadd address=169.254.0.0/16 comment=\"defconf: RFC6890\" list=no_forward_ipv4\nadd address=224.0.0.0/4 comment=\"defconf: multicast\" list=no_forward_ipv4\nadd address=255.255.255.255/32 comment=\"defconf: RFC6890\" list=no_forward_ipv4\nadd address=127.0.0.0/8 comment=\"defconf: RFC6890\" list=bad_ipv4\nadd address=192.0.0.0/24 comment=\"defconf: RFC6890\" list=bad_ipv4\nadd address=192.0.2.0/24 comment=\"defconf: RFC6890 documentation\" list=bad_ipv4\nadd address=198.51.100.0/24 comment=\"defconf: RFC6890 documentation\" list=bad_ipv4\nadd address=203.0.113.0/24 comment=\"defconf: RFC6890 documentation\" list=bad_ipv4\nadd address=240.0.0.0/4 comment=\"defconf: RFC6890 reserved\" list=bad_ipv4\nadd address=0.0.0.0/8 comment=\"defconf: RFC6890\" list=not_global_ipv4\nadd address=10.0.0.0/8 comment=\"defconf: RFC6890\" list=not_global_ipv4\nadd address=100.64.0.0/10 comment=\"defconf: RFC6890\" list=not_global_ipv4\nadd address=169.254.0.0/16 comment=\"defconf: RFC6890\" list=not_global_ipv4\nadd address=172.16.0.0/12 comment=\"defconf: RFC6890\" list=not_global_ipv4\nadd address=192.0.0.0/29 comment=\"defconf: RFC6890\" list=not_global_ipv4\nadd address=192.168.0.0/16 comment=\"defconf: RFC6890\" list=not_global_ipv4\nadd address=198.18.0.0/15 comment=\"defconf: RFC6890 benchmark\" list=not_global_ipv4\nadd address=255.255.255.255/32 comment=\"defconf: RFC6890\" list=not_global_ipv4\nadd address=224.0.0.0/4 comment=\"defconf: multicast\" list=bad_src_ipv4\nadd address=255.255.255.255/32 comment=\"defconf: RFC6890\" list=bad_src_ipv4\nadd address=0.0.0.0/8 comment=\"defconf: RFC6890\" list=bad_dst_ipv4\nadd address=224.0.0.0/4 comment=\"defconf: RFC6890\" list=bad_dst_ipv4\nadd comment=\"ddosconf: DDoS\" list=ddos_targets_ipv4\nadd comment=\"ddosconf: DDoS\" list=ddos_attackers_ipv4\n\n/ip firewall filter\nadd action=accept chain=input comment=\"defconf: accept ICMP after RAW\" protocol=icmp\nadd action=accept chain=input comment=\"defconf: accept established,related,untracked\" connection-state=established,related,untracked\nadd action=drop chain=input comment=\"defconf: drop invalid\" connection-state=invalid\nadd action=drop chain=input comment=\"defconf: drop all not coming from LAN\" in-interface-list=!LAN\nadd action=fasttrack-connection chain=forward comment=\"defconf: fasttrack\" connection-state=established,related disabled=yes\nadd action=accept chain=forward comment=\"defconf: accept established,related,untracked\" connection-state=established,related,untracked\nadd action=drop chain=forward comment=\"defconf: drop invalid\" connection-state=invalid\nadd action=drop chain=forward comment=\"defconf: drop all from WAN not DSTNATed\" connection-nat-state=!dstnat connection-state=new in-interface-list=WAN log=yes log-prefix=fw_wan_not_DSTNATed\nadd action=drop chain=forward comment=\"onuconf: drop all from ONU not DSTNATed\" connection-nat-state=!dstnat connection-state=new in-interface-list=ONU log=yes log-prefix=fw_onu_not_DSTNATed\nadd action=drop chain=forward comment=\"defconf: drop bad forward IPs\" src-address-list=no_forward_ipv4\nadd action=drop chain=forward comment=\"defconf: drop bad forward IPs\" dst-address-list=no_forward_ipv4\nadd action=jump chain=forward comment=\"ddosconf: DDoS\" connection-state=new jump-target=detect_ddos\nadd action=return chain=detect_ddos comment=\"ddosconf: DDoS SYN-ACK Flood\" dst-limit=32,32,src-and-dst-addresses/10s protocol=tcp tcp-flags=syn,ack log=yes log-prefix=fw_syn_ack_detected\nadd action=return chain=detect_ddos comment=\"ddosconf: DDoS\" dst-limit=256,32,src-and-dst-addresses/10s\nadd action=add-dst-to-address-list chain=detect_ddos comment=\"ddosconf: DDoS\" address-list=ddos_targets_ipv4 address-list-timeout=10m\nadd action=add-src-to-address-list chain=detect_ddos comment=\"ddosconf: DDoS\" address-list=ddos_attackers_ipv4 address-list-timeout=10m log=yes log-prefix=fw_ddos_attackers\n\n\n/ip firewall nat\nadd action=masquerade chain=srcnat comment=\"defconf: masquerade IPv4\" out-interface-list=WAN\nadd action=masquerade chain=srcnat comment=\"onuconf: access to ONU\" out-interface-list=ONU src-address-list=local_lan_ipv4 dst-address-list=local_onu_ipv4\nadd action=accept chain=dstnat comment=\"lanconf: accept local DNS server's query (UDP)\" dst-port=53 in-interface-list=LAN protocol=udp src-address-list=local_dns_ipv4\nadd action=accept chain=dstnat comment=\"lanconf: accept local DNS server's query (TCP)\" dst-port=53 in-interface-list=LAN protocol=tcp src-address-list=local_dns_ipv4 log=yes log-prefix=fw_dnsv4_tcp\nadd action=redirect chain=dstnat comment=\"lanconf: redirect DNS query (UDP)\" dst-port=53 in-interface-list=LAN protocol=udp to-ports=53\nadd action=redirect chain=dstnat comment=\"lanconf: redirect DNS query (TCP)\" dst-port=53 in-interface-list=LAN protocol=tcp to-ports=53 log=yes log-prefix=fw_dnsv4_tcp\n\n\n/ip firewall mangle\nadd action=change-mss chain=forward comment=\"defconf: fix IPv4 mss For WAN\" new-mss=clamp-to-pmtu passthrough=yes protocol=tcp tcp-flags=syn\nadd action=accept chain=prerouting comment=\"onuconf: access to ONU\" src-address-list=local_lan_ipv4 dst-address-list=local_onu_ipv4\n\n\n/ip firewall raw\nadd action=accept chain=prerouting comment=\"defconf: enable for transparent firewall\" disabled=yes\nadd action=drop chain=prerouting comment=\"ddosconf: DDoS\" dst-address-list=ddos_targets_ipv4 src-address-list=ddos_attackers_ipv4\nadd action=accept chain=prerouting comment=\"defconf: accept DHCP discover\" dst-address=255.255.255.255 dst-port=67 in-interface-list=LAN protocol=udp src-address=0.0.0.0 src-port=68\nadd action=drop chain=prerouting comment=\"defconf: drop bogon IPs\" src-address-list=bad_ipv4\nadd action=drop chain=prerouting comment=\"defconf: drop bogon IPs\" dst-address-list=bad_ipv4\nadd action=drop chain=prerouting comment=\"defconf: drop bogon IPs\" src-address-list=bad_src_ipv4\nadd action=drop chain=prerouting comment=\"defconf: drop bogon IPs\" dst-address-list=bad_dst_ipv4\nadd action=drop chain=prerouting comment=\"defconf: drop non global from WAN\" src-address-list=not_global_ipv4 in-interface-list=WAN\nadd action=drop chain=prerouting comment=\"defconf: drop forward to local LAN from WAN\" in-interface-list=WAN dst-address-list=local_lan_ipv4 log=yes log-prefix=fw_wan_to_lan_forward\nadd action=drop chain=prerouting comment=\"onuconf: drop if not from ONU address\" in-interface-list=ONU src-address-list=!local_onu_ipv4 log=yes log-prefix=fw_not_from_onu_address\nadd action=drop chain=prerouting comment=\"onuconf: drop forward to local LAN from ONU\" in-interface-list=ONU dst-address-list=local_lan_ipv4 log=yes log-prefix=fw_onu_to_lan_forward\nadd action=drop chain=prerouting comment=\"defconf: drop local if not from default IP range\" in-interface-list=LAN src-address-list=!local_lan_ipv4\nadd action=drop chain=prerouting comment=\"defconf: drop bad UDP\" port=0 protocol=udp log=yes log-prefix=fw_udp_0_port\nadd action=jump chain=prerouting comment=\"defconf: jump to ICMP chain\" jump-target=icmp4 protocol=icmp\nadd action=jump chain=prerouting comment=\"defconf: jump to TCP chain\" jump-target=bad_tcp protocol=tcp\nadd action=accept chain=prerouting comment=\"defconf: accept everything else from LAN\" in-interface-list=LAN\nadd action=accept chain=prerouting comment=\"defconf: accept everything else from WAN\" in-interface-list=WAN\nadd action=accept chain=prerouting comment=\"onuconf: accept everything else from ONU\" in-interface-list=ONU\nadd action=drop chain=prerouting comment=\"defconf: drop the rest\"\nadd action=drop chain=bad_tcp comment=\"defconf: TCP flag filter\" protocol=tcp tcp-flags=!fin,!syn,!rst,!ack\nadd action=drop chain=bad_tcp comment=\"defconf: tcp-flags=fin,syn\" protocol=tcp tcp-flags=fin,syn\nadd action=drop chain=bad_tcp comment=\"defconf: tcp-flags=fin,rst\" protocol=tcp tcp-flags=fin,rst\nadd action=drop chain=bad_tcp comment=\"defconf: tcp-flags=fin,!ack\" protocol=tcp tcp-flags=fin,!ack\nadd action=drop chain=bad_tcp comment=\"defconf: tcp-flags=fin,urg\" protocol=tcp tcp-flags=fin,urg\nadd action=drop chain=bad_tcp comment=\"defconf: tcp-flags=syn,rst\" protocol=tcp tcp-flags=syn,rst\nadd action=drop chain=bad_tcp comment=\"defconf: tcp-flags=rst,urg\" protocol=tcp tcp-flags=rst,urg\nadd action=drop chain=bad_tcp comment=\"defconf: TCP port 0 drop\" port=0 protocol=tcp log=yes log-prefix=fw_tcp_0_port\nadd action=accept chain=icmp4 comment=\"lanconf: accept echo reply from WAN\" icmp-options=0:0 protocol=icmp in-interface-list=WAN\nadd action=accept chain=icmp4 comment=\"lanconf: accept net unreachable from WAN\" icmp-options=3:0 protocol=icmp in-interface-list=WAN\nadd action=accept chain=icmp4 comment=\"lanconf: accept fragmentation needed from WAN\" icmp-options=3:4 protocol=icmp in-interface-list=WAN\nadd action=accept chain=icmp4 comment=\"lanconf: accept time exceeded from WAN\" icmp-options=11:0-255 protocol=icmp in-interface-list=WAN\nadd action=drop chain=icmp4 comment=\"lanconf: drop other ICMP from WAN\" protocol=icmp in-interface-list=WAN\nadd action=accept chain=icmp4 comment=\"onuconf: accept echo reply from ONU\" icmp-options=0:0 protocol=icmp in-interface-list=ONU\nadd action=drop chain=icmp4 comment=\"onuconf: drop other ICMP from ONU\" protocol=icmp in-interface-list=ONU log=yes log-prefix=fw_drop_onu_icmp\nadd action=accept chain=icmp4 comment=\"defconf: echo reply\" icmp-options=0:0 protocol=icmp in-interface-list=LAN log=yes log-prefix=fw_lan_ehco_reply\nadd action=accept chain=icmp4 comment=\"defconf: net unreachable\" icmp-options=3:0 protocol=icmp in-interface-list=LAN\nadd action=accept chain=icmp4 comment=\"defconf: host unreachable\" icmp-options=3:1 protocol=icmp in-interface-list=LAN\nadd action=accept chain=icmp4 comment=\"defconf: protocol unreachable\" icmp-options=3:2 protocol=icmp in-interface-list=LAN\nadd action=accept chain=icmp4 comment=\"defconf: port unreachable\" icmp-options=3:3 protocol=icmp in-interface-list=LAN\nadd action=accept chain=icmp4 comment=\"defconf: fragmentation needed\" icmp-options=3:4 protocol=icmp in-interface-list=LAN\nadd action=accept chain=icmp4 comment=\"onuconf: echo to ONU\" icmp-options=8:0 protocol=icmp in-interface-list=LAN dst-address-list=local_onu_ipv4\nadd action=accept chain=icmp4 comment=\"defconf: echo to local device\" icmp-options=8:0 protocol=icmp in-interface-list=LAN dst-address-list=local_lan_ipv4\nadd action=drop chain=icmp4 comment=\"defconf: echo to non global\" icmp-options=8:0 protocol=icmp in-interface-list=LAN dst-address-list=not_global_ipv4\nadd action=accept chain=icmp4 comment=\"defconf: echo to WAN\" icmp-options=8:0 protocol=icmp in-interface-list=LAN\nadd action=accept chain=icmp4 comment=\"defconf: time exceeded\" icmp-options=11:0-255 protocol=icmp in-interface-list=LAN\nadd action=drop chain=icmp4 comment=\"defconf: drop all other ICMP\" protocol=icmp\n\n\n# \u8bbe\u7f6e IPv4 \u9ed1\u6d1e\u8def\u7531\n/ip route\nadd blackhole comment=\"defconf: RFC6890 for this host on this network\" disabled=no dst-address=0.0.0.0/8\nadd blackhole comment=\"defconf: RFC6890 for private use\" disabled=no dst-address=10.0.0.0/8\nadd blackhole comment=\"defconf: RFC6890 for shared address space\" disabled=no dst-address=100.64.0.0/10\nadd blackhole comment=\"defconf: RFC6890 for loopback\" disabled=no dst-address=127.0.0.0/8\nadd blackhole comment=\"defconf: RFC6890 for link local\" disabled=no dst-address=169.254.0.0/16\nadd blackhole comment=\"defconf: RFC6890 for private use\" disabled=no dst-address=172.16.0.0/12\nadd blackhole comment=\"defconf: RFC6890 for IETF protocol assignments\" disabled=no dst-address=192.0.0.0/24\nadd blackhole comment=\"defconf: RFC6890 for DS-Lite\" disabled=no dst-address=192.0.0.0/29\nadd blackhole comment=\"defconf: RFC6890 for TEST-NET-1\" disabled=no dst-address=192.0.2.0/24\nadd blackhole comment=\"defconf: RFC6890 for 6to4 relay anycast\" disabled=no dst-address=192.88.99.0/24\nadd blackhole comment=\"defconf: RFC6890 for private use\" disabled=no dst-address=192.168.0.0/16\nadd blackhole comment=\"defconf: RFC6890 for benchmarking\" disabled=no dst-address=198.18.0.0/15\nadd blackhole comment=\"defconf: RFC6890 for TEST-NET-2\" disabled=no dst-address=198.51.100.0/24\nadd blackhole comment=\"defconf: RFC6890 for TEST-NET-3\" disabled=no dst-address=203.0.113.0/24\nadd blackhole comment=\"defconf: RFC6890 for reserved\" disabled=no dst-address=240.0.0.0/4\nadd blackhole comment=\"defconf: RFC6890 for limited broadcast\" disabled=no dst-address=255.255.255.255/32\n</code></pre> <p>IPV6\u8bbe\u7f6e</p> <pre><code>##       Filter \u89c4\u5219 26 \u6761\n##          NAT \u89c4\u5219  5 \u6761\n##       Mangle \u89c4\u5219  1 \u6761\n##          Raw \u89c4\u5219 47 \u6761\n## Address-list \u89c4\u5219 19 \u6761\n\n/ipv6 firewall address-list\nadd address=fdac::2 comment=\"lanconf: local DNS server\" list=local_dns_ipv6\nadd address=fdac::3 comment=\"lanconf: local DNS server\" list=local_dns_ipv6\nadd address=fe80::/10 comment=\"defconf: RFC6890 Linked-Scoped Unicast\" list=no_forward_ipv6\nadd address=ff00::/8 comment=\"defconf: multicast\" list=no_forward_ipv6\nadd address=::1/128 comment=\"defconf: RFC6890 lo\" list=bad_ipv6\nadd address=::ffff:0:0/96 comment=\"defconf: RFC6890 IPv4 mapped\" list=bad_ipv6\nadd address=2001::/23 comment=\"defconf: RFC6890\" list=bad_ipv6\nadd address=2001:db8::/32 comment=\"defconf: RFC6890 documentation\" list=bad_ipv6\nadd address=2001:10::/28 comment=\"defconf: RFC6890 orchid\" list=bad_ipv6\nadd address=::/96 comment=\"defconf: ipv4 compat\" list=bad_ipv6\nadd address=100::/64 comment=\"defconf: RFC6890 Discard-only\" list=not_global_ipv6\nadd address=2001::/32 comment=\"defconf: RFC6890 TEREDO\" list=not_global_ipv6\nadd address=2001:2::/48 comment=\"defconf: RFC6890 Benchmark\" list=not_global_ipv6\nadd address=fc00::/7 comment=\"defconf: RFC6890 Unique-Local\" list=not_global_ipv6\nadd address=::/128 comment=\"defconf: unspecified\" list=bad_dst_ipv6\nadd address=::/128 comment=\"defconf: unspecified\" list=bad_src_ipv6\nadd address=ff00::/8 comment=\"defconf: multicast\" list=bad_src_ipv6\nadd address=::/128 comment=\"ddosconf: DDoS\" list=ddos_targets_ipv6\nadd address=::/128 comment=\"ddosconf: DDoS\" list=ddos_attackers_ipv6\n\n\n/ipv6 firewall filter\nadd action=accept chain=input comment=\"defconf: accept ICMPv6 after RAW\" protocol=icmpv6\nadd action=accept chain=input comment=\"defconf: accept established,related,untracked\" connection-state=established,related,untracked\nadd action=drop chain=input comment=\"defconf: drop invalid\" connection-state=invalid\nadd action=accept chain=input comment=\"defconf: accept UDP traceroute\" port=33434-33534 protocol=udp\nadd action=accept chain=input comment=\"defconf: accept DHCPv6-Client prefix delegation\" dst-port=546 protocol=udp src-address=fe80::/10 log=yes log-prefix=fw_ipv6_pd\nadd action=accept chain=input comment=\"defconf: accept IKE\" dst-port=500,4500 protocol=udp\nadd action=accept chain=input comment=\"defconf: accept IPSec AH\" protocol=ipsec-ah\nadd action=accept chain=input comment=\"defconf: accept IPSec ESP\" protocol=ipsec-esp\nadd action=drop chain=input comment=\"defconf: drop all not coming from LAN\" in-interface-list=!LAN\nadd action=accept chain=forward comment=\"defconf: accept established,related,untracked\" connection-state=established,related,untracked\nadd action=drop chain=forward comment=\"defconf: drop invalid\" connection-state=invalid\nadd action=drop chain=forward comment=\"defconf: drop bad forward IPs\" src-address-list=no_forward_ipv6\nadd action=drop chain=forward comment=\"defconf: drop bad forward IPs\" dst-address-list=no_forward_ipv6\nadd action=drop chain=forward comment=\"defconf: rfc4890 drop hop-limit=1\" hop-limit=equal:1 protocol=icmpv6\nadd action=accept chain=forward comment=\"defconf: accept ICMPv6 after RAW\" protocol=icmpv6\nadd action=accept chain=forward comment=\"defconf: accept HIP\" protocol=139\nadd action=accept chain=forward comment=\"defconf: accept IKE\" dst-port=500,4500 protocol=udp\nadd action=accept chain=forward comment=\"defconf: accept AH\" protocol=ipsec-ah\nadd action=accept chain=forward comment=\"defconf: accept ESP\" protocol=ipsec-esp\nadd action=accept chain=forward comment=\"defconf: accept all that matches IPSec policy\" ipsec-policy=in,ipsec\nadd action=drop chain=forward comment=\"defconf: drop everything else not coming from LAN\" in-interface-list=!LAN\nadd action=jump chain=forward comment=\"ddosconf: DDoS\" connection-state=new jump-target=detect_ddos\nadd action=return chain=detect_ddos comment=\"ddosconf: DDoS SYN-ACK Flood\" dst-limit=32,32,src-and-dst-addresses/10s protocol=tcp tcp-flags=syn,ack log=yes log-prefix=fw_syn_ack_detected\nadd action=return chain=detect_ddos comment=\"ddosconf: DDoS\" dst-limit=256,32,src-and-dst-addresses/10s\nadd action=add-dst-to-address-list chain=detect_ddos comment=\"ddosconf: DDoS\" address-list=ddos_targets_ipv6 address-list-timeout=10m\nadd action=add-src-to-address-list chain=detect_ddos comment=\"ddosconf: DDoS\" address-list=ddos_attackers_ipv6 address-list-timeout=10m log=yes log-prefix=fw_ddos_attackers\n\n\n/ipv6 firewall nat\nadd action=masquerade chain=srcnat comment=\"defconf: masquerade IPv6\" out-interface-list=WAN disabled=yes\nadd action=accept chain=dstnat comment=\"lanconf: accept local DNS server's query (UDP)\" dst-port=53 in-interface-list=LAN protocol=udp src-address-list=local_dns_ipv6\nadd action=accept chain=dstnat comment=\"lanconf: accept local DNS server's query (TCP)\" dst-port=53 in-interface-list=LAN protocol=tcp src-address-list=local_dns_ipv6 log=yes log-prefix=fw_dnsv6_tcp\nadd action=redirect chain=dstnat comment=\"lanconf: redirect DNS query (UDP)\" dst-port=53 in-interface-list=LAN protocol=udp to-ports=53\nadd action=redirect chain=dstnat comment=\"lanconf: redirect DNS query (TCP)\" dst-port=53 in-interface-list=LAN protocol=tcp to-ports=53 log=yes log-prefix=fw_dnsv6_tcp\n\n\n/ipv6 firewall mangle\nadd action=change-mss chain=forward comment=\"defconf: fix IPv6 mss For WAN\" new-mss=clamp-to-pmtu passthrough=yes protocol=tcp tcp-flags=syn\n\n\n/ipv6 firewall raw\nadd action=accept chain=prerouting comment=\"defconf: enable for transparent firewall\" disabled=yes\nadd action=drop chain=prerouting comment=\"ddosconf: DDoS\" dst-address-list=ddos_targets_ipv6 src-address-list=ddos_attackers_ipv6\nadd action=accept chain=prerouting comment=\"defconf: RFC4291, section 2.7.1\" dst-address=ff02:0:0:0:0:1:ff00::/104 icmp-options=135 protocol=icmpv6 src-address=::/128\nadd action=drop chain=prerouting comment=\"defconf: drop bogon IPs\" src-address-list=bad_ipv6\nadd action=drop chain=prerouting comment=\"defconf: drop bogon IPs\" dst-address-list=bad_ipv6\nadd action=drop chain=prerouting comment=\"defconf: drop packets with bad SRC ipv6\" src-address-list=bad_src_ipv6\nadd action=drop chain=prerouting comment=\"defconf: drop packets with bad DST ipv6\" dst-address-list=bad_dst_ipv6\nadd action=drop chain=prerouting comment=\"defconf: drop non global from WAN\" in-interface-list=WAN src-address-list=not_global_ipv6\nadd action=drop chain=prerouting comment=\"defconf: drop bad UDP\" port=0 protocol=udp log=yes log-prefix=fw_udp_0_port\nadd action=jump chain=prerouting comment=\"defconf: jump to ICMPv6 chain\" jump-target=icmp6 protocol=icmpv6\nadd action=jump chain=prerouting comment=\"defconf: jump to TCP chain\" jump-target=bad_tcp protocol=tcp\nadd action=accept chain=prerouting comment=\"defconf: accept local multicast scope\" dst-address=ff02::/16\nadd action=drop chain=prerouting comment=\"defconf: drop other multicast destinations\" dst-address=ff00::/8\nadd action=accept chain=prerouting comment=\"defconf: accept everything else from LAN\" in-interface-list=LAN\nadd action=accept chain=prerouting comment=\"defconf: accept everything else from WAN\" in-interface-list=WAN\nadd action=drop chain=prerouting comment=\"defconf: drop the rest\"\nadd action=drop chain=bad_tcp comment=\"defconf: TCP flag filter\" protocol=tcp tcp-flags=!fin,!syn,!rst,!ack\nadd action=drop chain=bad_tcp comment=\"defconf: tcp-flags=fin,syn\" protocol=tcp tcp-flags=fin,syn\nadd action=drop chain=bad_tcp comment=\"defconf: tcp-flags=fin,rst\" protocol=tcp tcp-flags=fin,rst\nadd action=drop chain=bad_tcp comment=\"defconf: tcp-flags=fin,!ack\" protocol=tcp tcp-flags=fin,!ack\nadd action=drop chain=bad_tcp comment=\"defconf: tcp-flags=fin,urg\" protocol=tcp tcp-flags=fin,urg\nadd action=drop chain=bad_tcp comment=\"defconf: tcp-flags=syn,rst\" protocol=tcp tcp-flags=syn,rst\nadd action=drop chain=bad_tcp comment=\"defconf: tcp-flags=rst,urg\" protocol=tcp tcp-flags=rst,urg\nadd action=drop chain=bad_tcp comment=\"defconf: TCP port 0 drop\" port=0 protocol=tcp log=yes log-prefix=fw_tcp_0_port\nadd action=accept chain=icmp6 comment=\"defconf: rfc4890 drop ll if hop-limit!=255\" dst-address=fe80::/10 hop-limit=not-equal:255 protocol=icmpv6\nadd action=accept chain=icmp6 comment=\"defconf: dst unreachable\" icmp-options=1:0-255 protocol=icmpv6\nadd action=accept chain=icmp6 comment=\"defconf: packet too big\" icmp-options=2:0-255 protocol=icmpv6\nadd action=accept chain=icmp6 comment=\"defconf: limit exceeded\" icmp-options=3:0-1 protocol=icmpv6\nadd action=accept chain=icmp6 comment=\"defconf: bad header\" icmp-options=4:0-2 protocol=icmpv6\nadd action=accept chain=icmp6 comment=\"defconf: echo request\" icmp-options=128:0-255 protocol=icmpv6\nadd action=accept chain=icmp6 comment=\"defconf: echo reply\" icmp-options=129:0-255 protocol=icmpv6\nadd action=accept chain=icmp6 comment=\"defconf: rfc4890 multicast listener query only LAN\" src-address=fe80::/10 icmp-options=130:0-255 in-interface-list=LAN protocol=icmpv6\nadd action=accept chain=icmp6 comment=\"defconf: rfc4890 multicast listener query report only LAN\" src-address=fe80::/10 icmp-options=131:0-255 in-interface-list=LAN protocol=icmpv6\nadd action=accept chain=icmp6 comment=\"defconf: rfc4890 multicast listener query done only LAN\" src-address=fe80::/10 icmp-options=132:0-255 in-interface-list=LAN protocol=icmpv6\nadd action=accept chain=icmp6 comment=\"defconf: rfc4890 router solic only LAN\" hop-limit=equal:255 icmp-options=133:0-255 in-interface-list=LAN protocol=icmpv6\nadd action=accept chain=icmp6 comment=\"defconf: rfc4890 router advert only LAN\" hop-limit=equal:255 icmp-options=134:0-255 in-interface-list=LAN protocol=icmpv6\nadd action=accept chain=icmp6 comment=\"defconf: rfc4890 neighbor solic only LAN\" hop-limit=equal:255 icmp-options=135:0-255 in-interface-list=LAN protocol=icmpv6\nadd action=accept chain=icmp6 comment=\"defconf: rfc4890 neighbor advert only LAN\" hop-limit=equal:255 icmp-options=136:0-255 in-interface-list=LAN protocol=icmpv6\nadd action=accept chain=icmp6 comment=\"defconf: rfc4890 inverse ND solic only LAN\" hop-limit=equal:255 icmp-options=141:0-255 in-interface-list=LAN protocol=icmpv6\nadd action=accept chain=icmp6 comment=\"defconf: rfc4890 inverse ND advert only LAN\" hop-limit=equal:255 icmp-options=142:0-255 in-interface-list=LAN protocol=icmpv6\nadd action=accept chain=icmp6 comment=\"defconf: rfc4890 multicast listener report v2 only LAN\" src-address=fe80::/10 icmp-options=143:0-255 in-interface-list=LAN protocol=icmpv6\nadd action=accept chain=icmp6 comment=\"defconf: rfc4890 certificate path solicitation only LAN\" hop-limit=equal:255 icmp-options=148:0-255 in-interface-list=LAN protocol=icmpv6\nadd action=accept chain=icmp6 comment=\"defconf: rfc4890 certificate path advertisement only LAN\" hop-limit=equal:255 icmp-options=149:0-255 in-interface-list=LAN protocol=icmpv6\nadd action=accept chain=icmp6 comment=\"defconf: rfc4890 multicast router advertisement only LAN\" src-address=fe80::/10 hop-limit=equal:1 icmp-options=151:0-255 in-interface-list=LAN protocol=icmpv6\nadd action=accept chain=icmp6 comment=\"defconf: rfc4890 multicast router solicitation only LAN\" src-address=fe80::/10 hop-limit=equal:1 icmp-options=152:0-255 in-interface-list=LAN protocol=icmpv6\nadd action=accept chain=icmp6 comment=\"defconf: rfc4890 multicast router termination only LAN\" src-address=fe80::/10 hop-limit=equal:1 icmp-options=153:0-255 in-interface-list=LAN protocol=icmpv6\nadd action=drop chain=icmp6 comment=\"defconf: drop all other ICMP\" protocol=icmpv6\n\n\n/ipv6 route\nadd blackhole comment=\"defconf: RFC6890 for loopback address\" disabled=no dst-address=::1/128\nadd blackhole comment=\"defconf: RFC6890 for unspecified address\" disabled=no dst-address=::/128\nadd blackhole comment=\"defconf: RFC6890 for IPv4-IPv6 translat\" disabled=no dst-address=64:ff9b::/96\nadd blackhole comment=\"defconf: RFC6890 for IPv4-mapped address\" disabled=no dst-address=::ffff:0:0/96\nadd blackhole comment=\"defconf: RFC6890 for discard-only address block\" disabled=no dst-address=100::/64\nadd blackhole comment=\"defconf: RFC6890 for IETF protocol assignments\" disabled=no dst-address=2001::/23\nadd blackhole comment=\"defconf: RFC6890 for TEREDO\" disabled=no dst-address=2001::/32\nadd blackhole comment=\"defconf: RFC6890 for benchmarking\" disabled=no dst-address=2001:2::/48\nadd blackhole comment=\"defconf: RFC6890 for documentation\" disabled=no dst-address=2001:db8::/32\nadd blackhole comment=\"defconf: RFC6890 for ORCHID\" disabled=no dst-address=2001:10::/28\nadd blackhole comment=\"defconf: RFC6890 for 6to4\" disabled=no dst-address=2002::/16\nadd blackhole comment=\"defconf: RFC6890 for unique-local\" disabled=no dst-address=fc00::/7\nadd blackhole comment=\"defconf: RFC6890 for linked-scoped unicast\" disabled=no dst-address=fe80::/10\n</code></pre> <p>\u5f00\u542fUPnP\u8bbe\u7f6e</p> <p>1\u3001\u70b9\u51fb\u201cIP\u201d -- \u201cUPNP\u201d\uff0c\u5c06Enabled\uff08\u542f\u7528\uff09\u548cAllow To Disable External Interface\uff08\u5141\u8bb8\u7981\u7528\u5916\u90e8\u63a5\u53e3\uff09\uff0c\u6253\u94a9\u5e76\u70b9\u51fbApple\uff0cOK\uff0c\u4fdd\u5b58\u8bbe\u7f6e\u3002</p> <pre><code># IP / UPnP \nEnabled: yes\nAllow To Disable External Interface: yes\nShow Dummy Rule: yes\n</code></pre> <p>2\u3001\u91cd\u65b0\u6253\u5f00\u201cIP\u201d -- \u201cUPNP\u201d\uff0cUPNP Settings\u754c\u9762\uff0c\u70b9\u51fbInterfaces\uff0c\u7136\u540e\u5728UPnP Interface Settings\u754c\u9762\u70b9\u51fb\u201c+\u201d\u53f7\uff0c\u6dfb\u52a02\u6761\u914d\u7f6e\u3002</p> <pre><code>- \u5916\u7f51 - Interface\uff1apppoe-out1(\u5982\u679c\u662fPPPOE\u63a5\u5165\u5916\u7f51\uff0c\u5c31\u586bpppoe-out1\u63a5\u53e3\u540d\uff0c\u9759\u6001IP\u63a5\u5165\u5c31\u586bWAN\u63a5\u53e3\u540d)\uff0ctype\uff1aexternal\u3002\n- \u5185\u7f51 - Interface\uff1abridge1\uff08\u7f51\u6865\u540d\u79f0\uff0c\u5982\u672a\u4f7f\u7528\u7f51\u6865\u5219\u9009\u62e9LAN\u53e3\uff09\uff0ctype\uff1ainternal\u3002  \n</code></pre>"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/RouterOS%E5%88%9D%E5%A7%8B%E5%8C%96%E8%AE%BE%E7%BD%AE/#enable-container-mode","title":"enable container mode","text":"<pre><code>/system/device-mode/update container=yes\n</code></pre>"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/RouterOS%E5%88%9D%E5%A7%8B%E5%8C%96%E8%AE%BE%E7%BD%AE/#create-network","title":"Create network","text":"<p>Add veth interface for the container:</p> <pre><code>/interface/veth/add name=veth1 address=172.17.0.2/24 gateway=172.17.0.1\n</code></pre> <p>Create a bridge for containers and add veth to it:</p> <pre><code>/interface/bridge/add name=containers\n/ip/address/add address=172.17.0.1/24 interface=containers\n/interface/bridge/port add bridge=containers interface=veth1\n</code></pre> <p>Setup NAT for outgoing traffic:</p> <pre><code>/ip/firewall/nat/add chain=srcnat action=masquerade src-address=172.17.0.0/24\n</code></pre>"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/RouterOS%E5%88%9D%E5%A7%8B%E5%8C%96%E8%AE%BE%E7%BD%AE/#add-environment-variables-and-mounts-optional","title":"Add environment variables and mounts (optional)","text":"<p>Create environment variables for container(optional):</p> <pre><code>/container/envs/add name=pihole_envs key=TZ value=\"Europe/Riga\"\n/container/envs/add name=pihole_envs key=WEBPASSWORD value=\"mysecurepassword\"\n/container/envs/add name=pihole_envs key=DNSMASQ_USER value=\"root\"\n</code></pre> <p>Define mounts (optional):</p> <pre><code>/container/mounts/add name=etc_pihole src=disk1/etc dst=/etc/pihole\n/container/mounts/add name=dnsmasq_pihole src=disk1/etc-dnsmasq.d dst=/etc/dnsmasq.d\n</code></pre>"},{"location":"%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/RouterOS/RouterOS%E5%88%9D%E5%A7%8B%E5%8C%96%E8%AE%BE%E7%BD%AE/#a-get-an-image-from-an-external-library","title":"a) get an image from an external library","text":"<pre><code>/container/config/set registry-url=https://registry-1.docker.io tmpdir=container\n</code></pre> <pre><code>/container/add remote-image=jeessy/ddns-go:latest interface=veth1 root-dir=container/ddns-go logging=yes\n\n</code></pre>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/K8S/HAProxy%E5%92%8CKeepalived/","title":"HAProxy\u548cKeepalived","text":""},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/K8S/HAProxy%E5%92%8CKeepalived/#haproxy","title":"\u5b89\u88c5HAProxy","text":"<p>\u5229\u7528HAProxy\u5b9e\u73b0kubeapi\u670d\u52a1\u7684\u8d1f\u8f7d\u5747\u8861</p> <pre><code># \u4fee\u6539\u5185\u6838\u53c2\u6570\ncat &gt;&gt; /etc/sysctl.conf &lt;&lt;EOF\nnet.ipv4.ip_nonlocal_bind = 1\nEOF\n\n# \u4ece\u6307\u5b9a\u7684\u6587\u4ef6\u52a0\u8f7d\u7cfb\u7edf\u53c2\u6570\uff0c\u5982\u4e0d\u6307\u5b9a\u5373\u4ece/etc/sysctl.conf\u4e2d\u52a0\u8f7d\nsysctl -p\n\n# \u5b89\u88c5\u914d\u7f6eHAProxy\napt update\napt -y install haproxy\n\n# \u4fee\u6539\u914d\u7f6e\ncat &gt;&gt; /etc/haproxy/haproxy.cfg &lt;&lt;EOF\nlisten stats\n    mode http\n    bind *:1080\n    stats enable\n    log global\n    stats uri /status\n    stats auth admin:123456\nlisten kubernetes-api-6443\n    bind 0.0.0.0:6443\n    mode tcp\n    server k8s-master1.t-plus.com.cn 10.10.10.31:6443 check inter 3s fall 3 rise 3\n    server k8s-master2.t-plus.com.cn 10.10.10.32:6443 check inter 3s fall 3 rise 3\n    server k8s-master3.t-plus.com.cn 10.10.10.33:6443 check inter 3s fall 3 rise 3\nEOF\n\n# \u91cd\u542f\u670d\u52a1\nsystemctl restart haproxy\n</code></pre>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/K8S/HAProxy%E5%92%8CKeepalived/#keepalived","title":"\u5b89\u88c5Keepalived","text":"<p>\u5b89\u88c5keepalived\u5b9e\u73b0HAProxy\u9ad8\u53ef\u7528</p> <pre><code># \u5b89\u88c5keepalived\napt update\napt -y install keepalived\n\n# \u7f16\u8f91keepalived\u7684\u914d\u7f6e\u6587\u4ef6\nvim /etc/keepalived/keepalived.conf\n\n! Configuration File for keepalived\nglobal_defs {                   #\u5168\u5c40\u53c2\u6570\n  router_id k8s-ha1.t-plus.com.cn   #\u6307\u5b9a\u540d\u79f0\uff0c\u5404\u4e2a\u670d\u52a1\u5668\u540d\u79f0\u8981\u4e0d\u4e00\u6837\n}\n\nvrrp_script check_haproxy {\n  script \"/etc/keepalived/check_haproxy.sh\"\n  interval 3\n  weight -30\n  fall 3\n  rise 2\n  timeout 2\n}\n\nvrrp_instance VI_1 {            #\u6307\u5b9avrrp\u70ed\u5907\u53c2\u6570\n  state MASTER                  #\u670d\u52a1\u5668\u89d2\u8272\u662fmaster\uff0c\u5907\u4efd\u670d\u52a1\u5668\u8bbe\u7f6e\u4e3aBACKUP\n  interface ens160               #\u4fee\u6539\u7269\u7406\u7f51\u5361\u540d\u79f0 \n  virtual_router_id 10          #\u7ec4\u53f7\u76f8\u540c\n  priority 100                  #\u4f18\u5148\u7ea7\uff0c\u4e3b\u670d\u52a1\u5668\u8bbe\u7f6e\u8981\u5927\u4e8e\u5907\u670d\u52a1\u5668\n  advert_int 1\n  authentication {\n   auth_type PASS               #\u9a8c\u8bc1\u7c7b\u578b\u548c\u5bc6\u7801\uff0c\u4e0d\u5efa\u8bae\u4fee\u6539\n   auth_pass 123456\n}\nvirtual_ipaddress {\n  10.10.10.30/24               #\u6f02\u79fb\u5730\u5740\uff08VIP\uff09\u5730\u5740\uff0c\u53ef\u4ee5\u6709\u591a\u4e2a\n }\ntrack_script{\n  check_haproxy\n}\n\n\n# \u7f16\u5199\u811a\u672c\ncat &gt; /etc/keepalived/check_haproxy.sh &lt;&lt;EOF\n#!/bin/bash\n/usr/bin/killall -O haproxy || systemctl restart haproxy\nEOF\n\nchmod a+x /etc/keepalived/check_haproxy.sh\nsystemctl restart keepalived\n\n</code></pre> <pre><code>#!/bin/bash\n\nSTAT=`ps -C haproxy --no-header | wc -l`\n\nif [[ ! \"$STAT\" -eq 1  ]];then\n        /etc/init.d/keepalived stop\nfi\n</code></pre>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/K8S/ansible%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/","title":"Ansible\u5b66\u4e60\u7b14\u8bb0","text":"<p>1 \u5b89\u88c5 sudo pip install ansible</p> <p>2 \u914d\u7f6e 2.1 \u7ba1\u7406\u670d\u52a1\u5668\uff1ainventory\u6587\u4ef6   \u901a\u5e38\u547d\u540d\u4e3ahosts\u6587\u4ef6\uff0c\u53ef\u4ee5\u52a0\u6807\u7b7e\u5206\u7ec4\uff0c\u53ef\u4ee5\u4f7f\u7528 1:N\u7b49\u901a\u914d\u7b26\u7b49\uff1b</p> <p>2.2 ansible.cfg\u6587\u4ef6 vi /etc/ansible/ansible.cfg</p>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/K8S/ansible%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#host_key_checking-false","title":"\u5efa\u8bae\u53d6\u6d88\u6ce8\u91ca host_key_checking = false","text":""},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/K8S/ansible%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#log_path-varlogansiblelog","title":"\u5efa\u8bae\u53d6\u6d88\u6ce8\u91ca log_path = /var/log/ansible.log","text":"<p>hostname ansible    #\u4fee\u6539\u4e3b\u673a\u540d sudo vi /etc/netplan/00-installer-config.yaml   #\u8bbe\u7f6e\u56fa\u5b9aIP</p> <p>vi /etc/ssh/sshd_config     #\u914d\u7f6essh systemctl restart sshd</p> <p>2 \u6279\u91cf\u63a8\u9001\u516c\u94a5</p> <p>ssh-keygen ssh-copy-id  10.10.10.?  #\u5206\u522b\u6267\u884c\u591a\u53f0\u673a\u5668\u7684IP</p>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/K8S/ansible%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_1","title":"\u6216\u8005\u7f16\u5199\u5267\u672c","text":"<ul> <li>hosts: all   user: root   tasks:</li> <li>name: ssh-copy      authorized_key: user=root key=\"{{ lookup('file', '/home/root/.ssh/id_rsa.pub') }}\"      tags:<ul> <li>sshkey</li> </ul> </li> </ul> <p>3 \u6a21\u5757\uff08Modules\uff09</p> <p>-apt  \u8fd9\u4e2a\u6a21\u5757\u662fubuntu\u548cDebian\u4f5c\u4e3a\u8fdc\u7aef\u8282\u70b9\u7684\u65f6\u5019\u7528\u7684\u6700\u591a\u7684\u5305\u7ba1\u7406\u5de5\u5177   deb: \u8f6f\u4ef6\u5305\u540d\u5b57\uff0c\u53ef\u9009   install_recommends: \u9ed8\u8ba4\u4e3atrue\uff0c\u8bbe\u7f6e\u4e3aFalse\u4ee3\u8868\u53ea\u4e0b\u8f7d\u4e0d\u5b89\u88c5   update_cache: yes\u76f8\u5f53\u4e8eapt-get update   name: apt\u8981\u4e0b\u8f7d\u7684\u8f6f\u4ef6\u540d\uff0c\u6307\u5b9a\u7248\u672c\u53ef\u7528name=git=1.6   state: (present, adsent, latest) present\u8868\u793a\u4e3a\u5b89\u88c5\uff0c\u7136\u540e\u662f\u5220\u9664\uff0c\u518d\u662f\u5b89\u88c5\u4f4d\u6700\u65b0\u7248\u672c</p> <p>-copy  \u5728\u8fdc\u7a0b\u4e3b\u673a\u4e0a\u9762\u590d\u5236\u6587\u4ef6   src: \u590d\u5236\u5230\u8fdc\u7a0b\u7684\u6587\u4ef6\u5728\u672c\u5730\u7684\u5730\u5740\uff0c\u5982\u679c\u8def\u5f84\u4ee5/\u7ed3\u5c3e\uff0c\u53ea\u590d\u5236\u76ee\u5f55\u91cc\u9762\u7684\u5185\u5bb9\uff0c\u5982\u679c\u6ca1\u6709\uff0c\u5219\u5305\u542b\u76ee\u5f55\u5728\u5185\u7684\u6574\u4e2a\u5185\u5bb9\u5168\u90e8\u590d\u5236   content: \u4ee3\u66ffsrc\uff0c\u53ef\u4ee5\u76f4\u63a5\u8bbe\u5b9a\u6307\u5b9a\u6587\u4ef6\u7684\u503c   dest: \u590d\u5236\u5230\u8fdc\u7a0b\u6587\u4ef6\u7684\u8def\u5f84   directory_mode: \u76ee\u5f55\u6743\u9650   force:\u9ed8\u8ba4\u4e3ayes\uff0c\u5f3a\u5236\u8986\u76d6   others: \u6240\u6709file\u6a21\u5757\u91cc\u9762\u7684\u9009\u9879   mode: 0644</p> <p>-synchronize  \u4f7f\u7528rsync\u540c\u6b65\u6587\u4ef6\uff0c\u5c06\u4e3b\u63a7\u65b9\u76ee\u5f55\u63a8\u9001\u5230\u6307\u5b9a\u8282\u70b9\u7684\u76ee\u5f55\u4e0b   delete: \u5220\u9664\u4e0d\u5b58\u5728\u7684\u6587\u4ef6   src: \u8981\u540c\u6b65\u5230\u76ee\u7684\u5730\u7684\u6e90\u4e3b\u673a\u7684\u8def\u5f84   dest: \u76ee\u7684\u5730\u4e0a\u540c\u6b65\u5730\u5740   dest_port: \u76ee\u7684\u5730\u673a\u4e0a\u7684\u7aef\u53e3   mode: push/pull\uff0c\u9ed8\u8ba4push\uff0c\u672c\u673a\u5411\u8fdc\u7a0b\u4f20\u6587\u4ef6   rsync_opts: ansible 10.10.10.231 -m synchronize -a 'mode=pull  src=/root/chia-blockchain/venv dest=/root/ compress=yes'</p> <p>-service   arguments: \u547d\u4ee4\u9009\u9879   enabled: \u662f\u5426\u5f00\u673a\u542f\u52a8 yes   name: \u5fc5\u9009\uff0c\u670d\u52a1\u540d\u79f0   runlevel: \u8fd0\u884c\u7ea7\u522b   sleep: restarted\u4e4b\u95f4\u7684\u95f4\u9694   state: started/stopped/restarted/reloaded</p> <p>-get_url \u7528\u4e8e\u4ecehttp\uff0cftp\uff0chttps\u670d\u52a1\u5668\u4e0a\u9762\u4e0a\u4e0b\u8f7d\u6587\u4ef6\uff0c\u7c7b\u4f3cwget   sha256sum: \u4e0b\u8f7d\u540esha256\u9a8c\u8bc1   timeout: \u4e0b\u8f7d\u8d85\u65f6\u65f6\u95f4\uff0c\u9ed8\u8ba4\u4e3a10s   url: \u4e0b\u8f7d\u7684url   url_password, url_username: \u5982\u679c\u4e0b\u8f7d\u9700\u8981\u63d0\u4f9b\u9a8c\u8bc1   dest: \u4e0b\u8f7d\u5230\u54ea\u91cc   headers: \u4ee5key:value\u7684\u683c\u5f0f\u81ea\u5b9a\u4e49http\u6807\u5934</p> <p>-file \u7528\u4e8e\u8fdc\u7a0b\u4e3b\u673a\u4e0a\u9762\u7684\u6587\u4ef6\u64cd\u4f5c   force: \u5f3a\u5236\u521b\u5efa\u8f6f\u8fde\u63a5   group: \u6587\u4ef6\u76ee\u5f55\u7684\u5c5e\u7ec4   mode: \u6587\u4ef6\u76ee\u5f55\u7684\u6743\u9650   owner: \u6587\u4ef6\u76ee\u5f55\u7684\u5c5e\u4e3b   path: \u5fc5\u9009\uff0c\u6587\u4ef6\u76ee\u5f55\u7684\u8def\u5f84   recurse: \u9012\u5f52\u7684\u8bbe\u7f6e\u6587\u4ef6\u7684\u5c5e\u6027   src: \u88ab\u8fde\u63a5\u7684\u6e90\u6587\u4ef6\u8def\u5f84\uff0c\u5f53state=link\u7684\u65f6\u5019   dest: \u88ab\u8fde\u63a5\u5230\u7684\u8def\u5f84\uff0c\u5f53state=link\u7684\u65f6\u5019   state: directory \u5982\u679c\u76ee\u5f55\u4e0d\u5b58\u5728\u5219\u521b\u5efa\u76ee\u5f55   file \u5982\u679c\u6587\u4ef6\u4e0d\u5b58\u5728\u5219\u521b\u5efa   link \u521b\u5efa\u8f6f\u8fde\u63a5   hard \u521b\u5efa\u786c\u94fe\u63a5   touch \u5982\u679c\u6587\u4ef6\u4e0d\u5b58\u5728\u5219\u521b\u5efa\uff0c\u5982\u679c\u5b58\u5728\u5219\u4fee\u6539\u6700\u540e\u4fee\u6539\u65f6\u95f4\u5c5e\u6027   absent \u5220\u9664\u6587\u4ef6\u76ee\u5f55\u6216\u8005\u53d6\u6d88\u8fde\u63a5\u6587\u4ef6</p>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/K8S/ansible%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#4-playbooks","title":"4 \u5267\u672c\uff08Playbooks\uff09","text":""},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/K8S/ansible%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#hosts-could-have-been-remote-or-all-as-well","title":"hosts could have been \"remote\" or \"all\" as well","text":"<ul> <li>hosts: local   connection: local   become: yes   become_user: root   tasks:</li> <li>name: Install Nginx      apt:        name: nginx        state: installed        update_cache: true</li> </ul>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/K8S/ansible%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_2","title":"Ansible\u5b66\u4e60\u7b14\u8bb0","text":"<p>crontab -l  \u67e5\u770b crontab -e  \u7f16\u8f91</p> <p>tar -cvf bdir.tar bdir  #\u6253\u5305 tar -xzvf bdir.tar      #\u89e3\u538b\u5230\u5f53\u524d\u76ee\u5f55\u4e0b</p> <p>screen -X -S ID quit   \u5220\u9664screen</p> <p>ansible 10.10.10.231 -m synchronize -a 'src=/root/.chia/mainnet/ dest=/root/.chia/</p> <p>ansible localhost -m cron -a 'name=\"auto ploti\" minute= hour=/1 day= month= weekday= job=\"bash /home/start.sh\"'  ansible localhost -m cron -a 'name=\"auto move plots\" minute=/30 hour= day= month= weekday= job=\"\\mv /mnt/d/chia_final/*.plot /mnt/e/\"'</p>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/K8S/jenkins%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/","title":"\u542f\u52a8jenkins docker","text":"<p>docker run \\   -v /usr/bin/docker:/usr/bin/docker \\   -v /var/run/docker.sock:/var/run/docker.sock \\   -v /home/ubuntu/myjenkins/jenkins_home/:/var/jenkins_home \\   -u root \\   -d --name jenkins \\   -p 8120:8080 \\   jenkins/jenkins:jdk11</p> <p># \u67e5\u770btoken\u547d\u4ee4 cat /var/jenkins_home/secrets/initialAdminPassword</p>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/K8S/jenkins%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#docker-allure","title":"\u542f\u52a8\u6d4b\u8bd5docker, \u6302\u8f7dallure\u62a5\u544a\u76ee\u5f55","text":"<p>docker run \\   -v /home/ubuntu/myjenkins/jenkins_home/beifan/:/app/.allure_results/ \\   --shm-size 2G ccr.ccs.tencentyun.com/beifan/ui_framework:v1</p>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/K8S/kubernetes%E5%AE%89%E8%A3%85/","title":"Kubernetes\u5b89\u88c5","text":""},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/K8S/kubernetes%E5%AE%89%E8%A3%85/#ip","title":"\u4fee\u6539IP\u5730\u5740","text":"<pre><code>vim /etc/netplan/00-installer-config.yaml\n# This is the network config written by 'subiquity'\nnetwork:\n  ethernets:\n    ens192: #\u4f60\u5b9e\u9645\u7f51\u5361\u5730\u5740\n      addresses:\n      - 10.10.10.40/24\n      gateway4: 10.10.10.2\n      nameservers:\n        addresses:\n        - 114.114.114.114\n        search: []\n  version: 2\n\n</code></pre>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/K8S/kubernetes%E5%AE%89%E8%A3%85/#_1","title":"\u4fee\u6539\u4e3b\u673a\u540d","text":"<pre><code>hostnamectl set-hostname [YOUR NEW HOSTNAME]\n</code></pre>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/K8S/kubernetes%E5%AE%89%E8%A3%85/#ssh","title":"ssh\u767b\u5f55","text":"<pre><code>#\u751f\u6210\u5bc6\u5319\u5bf9\nssh-keygen -t rsa -C \"bobo522487@gmail.com\"\n\n#\u5c06\u672c\u673a\u516c\u94a5\u590d\u5236\u5230\u670d\u52a1\u5668\u4e0a\nssh-copy-id -i /root/.ssh/id_rsa.pub  root@10.10.10.xx\n\n</code></pre>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/K8S/kubernetes%E5%AE%89%E8%A3%85/#_2","title":"\u8bbe\u7f6e\u57df\u540d\u89e3\u6790","text":"<pre><code>cat &gt; /etc/hosts &lt;&lt;EOF\n10.10.10.30 k8s-kubeapi.t-plus.com.cn k8s-kubeapi\n10.10.10.31 k8s-master1.t-plus.com.cn k8s-master1\n10.10.10.32 k8s-master2.t-plus.com.cn k8s-master2\n10.10.10.33 k8s-master3.t-plus.com.cn k8s-master3\n10.10.10.34 k8s-node1.t-plus.com.cn k8s-node1\n10.10.10.35 k8s-node2.t-plus.com.cn k8s-node2\n10.10.10.36 k8s-node3.t-plus.com.cn k8s-node3\n10.10.10.38 k8s-ha1.t-plus.com.cn k8s-ha1\n10.10.10.39 k8s-ha2.t-plus.com.cn k8s-ha2\nEOF\n\nfor i in {32..39};do scp /etc/hosts 10.10.10.$i:/etc/ ;done\n</code></pre>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/K8S/kubernetes%E5%AE%89%E8%A3%85/#swap","title":"\u7981\u7528swap","text":"<pre><code>swapoff -a\nsed -i '/swap/s/^/#/' /etc/fstab\n</code></pre>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/K8S/kubernetes%E5%AE%89%E8%A3%85/#docker","title":"\u5b89\u88c5docker","text":"<pre><code>apt-get -y install docker.io\n\n# \u4fee\u6539cgroupdriver\ncat &gt; /etc/docker/daemon.json &lt;&lt;EOF\n{\n\"exec-opts\":[\"native.cgroupdriver=systemd\"]\n}\nEOF\n</code></pre>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/K8S/kubernetes%E5%AE%89%E8%A3%85/#kubelet-kubeadm-kubectl","title":"\u5b89\u88c5kubelet kubeadm kubectl","text":"<pre><code>apt-get install -y kubelet kubeadm kubectl\n</code></pre>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/K8S/kubernetes%E5%AE%89%E8%A3%85/#cri-dockerd","title":"\u5b89\u88c5cri-dockerd","text":"<pre><code>curl -LO https://github.com/mirantis/cri-dockerd/release/download/v0.2.5/cri-dockerd_0.2.6.3-0.ubuntu-focal_amd64.deb\n\ndpkg -i cri-dockerd_0.2.6.3-0.ubuntu-focal_amd64.deb\n\nfor i in {32..39};do scp cri-dockerd_0.2.6.3-0.ubuntu-focal_amd64.deb 10.10.10.$i:;ssh 10.10.10.$i \"dpkg -i cri-dockerd_0.2.6.3-0.ubuntu-focal_amd64.deb\";done\n</code></pre> <ol> <li>Update the <code>apt</code> package index and install packages needed to use the Kubernetes <code>apt</code> repository:</li> </ol> <p><code>shell    sudo apt-get update    sudo apt-get install -y apt-transport-https ca-certificates curl</code></p> <ol> <li>Download the Google Cloud public signing key:</li> </ol> <p><code>shell    sudo curl -fsSLo /usr/share/keyrings/kubernetes-archive-keyring.gpg https://packages.cloud.google.com/apt/doc/apt-key.gpg</code></p> <ol> <li>Add the Kubernetes <code>apt</code> repository:</li> </ol> <p><code>shell    echo \"deb [signed-by=/usr/share/keyrings/kubernetes-archive-keyring.gpg] https://apt.kubernetes.io/ kubernetes-xenial main\" | sudo tee /etc/apt/sources.list.d/kubernetes.list</code></p> <ol> <li>Update <code>apt</code> package index, install kubelet, kubeadm and kubectl, and pin their version:</li> </ol> <p><code>shell    sudo apt-get update    sudo apt-get install -y kubelet kubeadm kubectl    sudo apt-mark hold kubelet kubeadm kubectl</code></p> <p>\u521d\u59cb\u5316</p> <pre><code>kubeadm init \\\n        --control-plane-endpoint=\"k8s-kubeapi.t-plus.com.cn\" \\\n        --image-repository registry.cn-hangzhou.aliyuncs.com/google_containers \\\n        --cri-socket unix:///run/cri-dockerd.sock \\\n        --pod-network-cidr=10.244.0.0/16 \\\n        --service-cidr=10.96.0.0/12\n\n</code></pre> <p>\u5b89\u88c5\u7f51\u7edc\u63d2\u4ef6</p> <pre><code>kubectl apply -f https://raw.githubusercontent.com/flannel-io/flannel/master/Documentation/kube-flannel.yml\n</code></pre>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/K8S/prometheus%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/","title":"Prometheus\u5b66\u4e60\u7b14\u8bb0","text":"<ol> <li>\u90e8\u7f72</li> </ol> <p>prometheus docker run -d -p 9090:9090 -v /root/prometheus/prometheus.yml:/etc/prometheus/prometheus.yml  prom/prometheus</p> <p>grafana</p> <p>alertmanager</p> <ol> <li> <p>\u90e8\u7f72Node-exporter docker run -d --net=\"host\" --pid=\"host\" -v \"/:/host:ro,rslave\" quay.io/prometheus/node-exporter:latest --path.rootfs=/host</p> </li> <li> <p>\u90e8\u7f72Cadvisor-exporter  docker run --volume=/:/rootfs:ro --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --detach=true --name=cadvisor --net=host google/cadvisor:latest</p> </li> </ol>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/K8S/prometheus%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_1","title":"Prometheus\u5b66\u4e60\u7b14\u8bb0","text":"<p>curl -X POST http://10.10.10.18:9090/-/reload</p>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/K8S/prometheus%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_2","title":"Prometheus\u5b66\u4e60\u7b14\u8bb0","text":"<p>\u5220\u9664\u6307\u5b9a Metric \u540d\u79f0\u548c\u7279\u5b9a label \u540d\u79f0\u7684\u5168\u90e8\u6570\u636e curl -X POST -g 'http://172.16.109.26:9091/api/v1/admin/tsdb/delete_series?match[]=total_plots_count{hostname=\"p31\"}'</p>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/K8S/prometheus%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_3","title":"Prometheus\u5b66\u4e60\u7b14\u8bb0","text":"<p>\u5220\u9664\u6240\u6709\u5bb9\u5668 docker rm <code>docker ps -a -q</code></p> <p>\u5220\u9664\u6240\u6709\u955c\u50cf docker rmi <code>docker images -q</code></p> <p>\u67e5\u627e\u5927\u4e8e100M\u7684\u6587\u4ef6 find . -type f -size +1000000k</p>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/K8S/prometheus%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_4","title":"\u5f00\u673a\u81ea\u542f\u52a8","text":"<p>systemctl enable docker</p>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/K8S/prometheus%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_5","title":"\u67e5\u770b\u5bb9\u5668\u4fe1\u606f","text":"<p>docker inspect [CONTAINER ID]</p>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/K8S/prometheus%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_6","title":"\u8fdb\u5165\u5bb9\u5668","text":"<p>docker exec -u root -it [CONTAINER ID] /bin/sh</p>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/K8S/prometheus%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_7","title":"\u67e5\u770b\u5bb9\u5668\u65e5\u5fd7","text":"<p>docker logs -f [CONTAINER ID] \u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014</p>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/docker/%E5%9C%A8%20Debian%20%E4%B8%8A%E5%AE%89%E8%A3%85%20Docker%20%E5%BC%95%E6%93%8E/","title":"\u5728 Debian \u4e0a\u5b89\u88c5 Docker \u5f15\u64ce","text":"<p>\u8981\u5728 Debian \u4e0a\u5f00\u59cb\u4f7f\u7528 Docker Engine\uff0c\u8bf7\u786e\u4fdd \u6ee1\u8db3\u5148\u51b3\u6761\u4ef6\uff0c\u7136\u540e\u6309\u7167 \u5b89\u88c5\u6b65\u9aa4\u8fdb\u884c\u64cd\u4f5c\u3002</p>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/docker/%E5%9C%A8%20Debian%20%E4%B8%8A%E5%AE%89%E8%A3%85%20Docker%20%E5%BC%95%E6%93%8E/#_1","title":"\u4f7f\u7528\u4fbf\u6377\u811a\u672c\u5b89\u88c5","text":"<pre><code>curl -fsSL https://get.docker.com -o get-docker.sh\nsudo sh get-docker.sh\n</code></pre> <p>\u60a8\u73b0\u5728\u5df2\u7ecf\u6210\u529f\u5b89\u88c5\u5e76\u542f\u52a8\u4e86 Docker Engine\u3002\u8be5<code>docker</code> \u670d\u52a1\u5728\u57fa\u4e8e Debian \u7684\u53d1\u884c\u7248\u4e0a\u81ea\u52a8\u542f\u52a8\u3002\u5728<code>RPM</code>CentOS\u3001Fedora\u3001RHEL \u6216 SLES \u7b49\u57fa\u7840\u53d1\u884c\u7248\u4e0a\uff0c\u60a8\u9700\u8981\u4f7f\u7528\u9002\u5f53\u7684<code>systemctl</code>\u6216<code>service</code>\u547d\u4ee4\u624b\u52a8\u542f\u52a8\u5b83\u3002\u6b63\u5982\u6d88\u606f\u6240\u793a\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u975e root \u7528\u6237\u65e0\u6cd5\u8fd0\u884c Docker \u547d\u4ee4\u3002</p> <p>\u4ee5\u975e\u7279\u6743\u7528\u6237\u8eab\u4efd\u4f7f\u7528 Docker\uff0c\u8fd8\u662f\u4ee5\u65e0\u6839\u6a21\u5f0f\u5b89\u88c5\uff1f</p> <p>\u5b89\u88c5\u811a\u672c\u9700\u8981\u5b89\u88c5\u548c\u4f7f\u7528 Docker \u7684\u6743\u9650<code>root</code>\u3002<code>sudo</code>\u5982\u679c\u60a8\u60f3\u6388\u4e88\u975e root \u7528\u6237\u8bbf\u95ee Docker \u7684\u6743\u9650\uff0c\u8bf7\u53c2\u9605 Linux \u7684\u5b89\u88c5\u540e\u6b65\u9aa4\u3002\u60a8\u8fd8\u53ef\u4ee5\u5728\u6ca1\u6709<code>root</code>\u7279\u6743\u7684\u60c5\u51b5\u4e0b\u5b89\u88c5 Docker\uff0c\u6216\u914d\u7f6e\u4e3a\u5728\u65e0\u6839\u6a21\u5f0f\u4e0b\u8fd0\u884c\u3002\u6709\u5173\u5728 rootless \u6a21\u5f0f\u4e0b\u8fd0\u884c Docker \u7684\u8bf4\u660e\uff0c\u8bf7\u53c2\u9605 \u4ee5\u975e root \u7528\u6237\u8eab\u4efd\u8fd0\u884c Docker \u5b88\u62a4\u8fdb\u7a0b\uff08rootless \u6a21\u5f0f\uff09\u3002</p> <p>\u8981\u521b\u5efa<code>docker</code>\u7ec4\u5e76\u6dfb\u52a0\u60a8\u7684\u7528\u6237\uff1a</p> <ol> <li>\u521b\u5efa<code>docker</code>\u7fa4\u7ec4\u3002</li> </ol> <p><code>console    $ sudo groupadd docker</code></p> <ol> <li>\u5c06\u60a8\u7684\u7528\u6237\u6dfb\u52a0\u5230<code>docker</code>\u7ec4\u4e2d\u3002</li> </ol> <p><code>console    sudo usermod -aG docker $USER</code></p> <ol> <li>\u6ce8\u9500\u5e76\u91cd\u65b0\u767b\u5f55\uff0c\u4ee5\u4fbf\u91cd\u65b0\u8bc4\u4f30\u60a8\u7684\u7ec4\u6210\u5458\u8eab\u4efd\u3002</li> </ol> <p>\u5982\u679c\u60a8\u5728\u865a\u62df\u673a\u4e2d\u8fd0\u884c Linux\uff0c\u5219\u53ef\u80fd\u9700\u8981\u91cd\u65b0\u542f\u52a8\u865a\u62df\u673a\u624d\u80fd\u4f7f\u66f4\u6539\u751f\u6548\u3002</p> <p>\u60a8\u8fd8\u53ef\u4ee5\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\u6765\u6fc0\u6d3b\u5bf9\u7ec4\u7684\u66f4\u6539\uff1a</p> <p><code>console    newgrp docker</code></p> <ol> <li>\u9a8c\u8bc1\u60a8\u662f\u5426\u53ef\u4ee5<code>docker</code>\u5728\u6ca1\u6709<code>sudo</code>.</li> </ol> <p><code>console    $ docker run hello-world</code></p> <p>\u6b64\u547d\u4ee4\u4e0b\u8f7d\u6d4b\u8bd5\u6620\u50cf\u5e76\u5728\u5bb9\u5668\u4e2d\u8fd0\u884c\u5b83\u3002\u5f53\u5bb9\u5668\u8fd0\u884c\u65f6\uff0c\u5b83\u4f1a\u6253\u5370\u4e00\u6761\u6d88\u606f\u5e76\u9000\u51fa\u3002</p>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/docker/%E5%9C%A8%20Debian%20%E4%B8%8A%E5%AE%89%E8%A3%85%20Docker%20%E5%BC%95%E6%93%8E/#docker","title":"\u5378\u8f7d Docker \u5f15\u64ce","text":"<ol> <li>\u5378\u8f7d Docker Engine\u3001CLI\u3001containerd \u548c Docker Compose \u8f6f\u4ef6\u5305\uff1a</li> </ol> <p><code>console    $ sudo apt-get purge docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin docker-ce-rootless-extras</code></p> <ol> <li>\u4e3b\u673a\u4e0a\u7684\u6620\u50cf\u3001\u5bb9\u5668\u3001\u5377\u6216\u81ea\u5b9a\u4e49\u914d\u7f6e\u6587\u4ef6\u4e0d\u4f1a\u81ea\u52a8\u5220\u9664\u3002\u8981\u5220\u9664\u6240\u6709\u6620\u50cf\u3001\u5bb9\u5668\u548c\u5377\uff1a</li> </ol> <p><code>console    $ sudo rm -rf /var/lib/docker    $ sudo rm -rf /var/lib/containerd</code></p> <p>\u60a8\u5fc5\u987b\u624b\u52a8\u5220\u9664\u4efb\u4f55\u7f16\u8f91\u7684\u914d\u7f6e\u6587\u4ef6\u3002</p>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/docker/%E8%87%AA%E5%8A%A8%E6%9B%B4%E6%96%B0%E5%B7%B2%E5%90%AF%E5%8A%A8%E5%AE%B9%E5%99%A8%E7%9A%84%E9%95%9C%E5%83%8F/","title":"\u81ea\u52a8\u66f4\u65b0\u5df2\u542f\u52a8\u5bb9\u5668\u7684\u955c\u50cf","text":"<pre><code>#!/bin/bash\n\n# \u5b9a\u4e49\u5b58\u653edocker-compose.yml\u6587\u4ef6\u7684\u76ee\u5f55\nCOMPOSE_DIR=\"/root/docker\"\n\n# \u904d\u5386\u6307\u5b9a\u76ee\u5f55\u4e0b\u7684\u6240\u6709docker-compose.yml\u6587\u4ef6\nfind \"$COMPOSE_DIR\" -type f \\( -name \"docker-compose.yml\" -o -name \"docker-compose.yaml\" \\) | while read -r compose_file; do\n  # \u8bfb\u53d6docker-compose.yml\u6587\u4ef6\u5185\u5bb9\n  compose_content=$(&lt;\"$compose_file\")\n\n  # \u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914dcontainer_name\uff0c\u5e76\u53bb\u9664\u53ef\u80fd\u7684\u7a7a\u683c\n  container_name_match=$(echo \"$compose_content\" | grep -oP 'container_name:\\s*\\K\\S+' | tr -d \"'\\\"\")\n  if [ -z \"$container_name_match\" ]; then\n    echo \"Unable to find container_name in $compose_file\"\n    continue\n  fi\n\n  # \u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914dimage\uff0c\u5e76\u53bb\u9664\u53ef\u80fd\u7684\u7a7a\u683c\n  image_name_match=$(echo \"$compose_content\" | grep -oP 'image:\\s*\\K\\S+' | tr -d \"'\\\"\")\n  if [ -z \"$image_name_match\" ]; then\n    echo \"Unable to find image in $compose_file\"\n    continue\n  fi\n\n  # \u83b7\u53d6\u5f53\u524d\u8fd0\u884c\u7684\u5bb9\u5668\u540d\u79f0\n  running_containers=($(docker ps --format '{{.Names}}' | awk '{print $NF}'))\n\n  # \u904d\u5386\u5bb9\u5668\u540d\u79f0\u6570\u7ec4\n  for container in \"${running_containers[@]}\"; do\n    # \u68c0\u67e5container_name\u662f\u5426\u5728running_containers\u6570\u7ec4\u4e2d\n    if [[ \"$container\" == \"$container_name_match\" ]]; then\n      # \u62c9\u53d6\u65b0\u7684\u955c\u50cf\n      echo \"Pulling latest image for $image_name_match...\"\n      output=$(docker pull \"$image_name_match\" 2&gt;&amp;1)\n      # \u68c0\u67e5\u8f93\u51fa\u4e2d\u662f\u5426\u5305\u542b \"Downloaded newer image\"\n      if echo \"$output\" | grep -q \"Downloaded newer image for\"; then\n        echo \"New image for $image_name_match is available and has been downloaded.\"\n        echo \"Restarting container $container_name_match to use the new image...\"\n        docker-compose -f \"$compose_file\" restart \"$container_name_match\" || { echo \"Failed to restart container $container_name_match\"; break; }\n      else\n        echo \"No new image available for $image_name_match.\"\n      fi\n      # \u627e\u5230\u5339\u914d\u7684\u5bb9\u5668\u5e76\u5904\u7406\u540e\uff0c\u9000\u51fa\u5f53\u524d\u5faa\u73af\n      break\n    fi\n  done\ndone\n\necho \"All services have been checked and updated if necessary.\"\n</code></pre>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/playwright/playwright/","title":"\u5165\u95e8","text":""},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/playwright/playwright/#_2","title":"\u5b89\u88c5","text":"<pre><code>pip install --upgrade pip\npip install playwright\nplaywright install\n</code></pre>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/playwright/playwright/#_3","title":"\u8fd0\u884c\u6d4b\u8bd5","text":"<p>\u60a8\u53ef\u4ee5\u8fd0\u884c\u5355\u4e2a\u6d4b\u8bd5\u3001\u4e00\u7ec4\u6d4b\u8bd5\u6216\u6240\u6709\u6d4b\u8bd5\u3002\u6d4b\u8bd5\u53ef\u4ee5\u5728\u4e00\u4e2a\u6d4f\u89c8\u5668\u6216\u591a\u4e2a\u6d4f\u89c8\u5668\u4e0a\u8fd0\u884c\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6d4b\u8bd5\u4ee5\u65e0\u5934\u65b9\u5f0f\u8fd0\u884c\uff0c\u8fd9\u610f\u5473\u7740\u5728\u8fd0\u884c\u6d4b\u8bd5\u65f6\u4e0d\u4f1a\u6253\u5f00\u6d4f\u89c8\u5668\u7a97\u53e3\uff0c\u5e76\u4e14\u4f1a\u5728\u7ec8\u7aef\u4e2d\u770b\u5230\u7ed3\u679c\u3002\u5982\u679c\u60a8\u613f\u610f\uff0c\u53ef\u4ee5\u4f7f\u7528\u8be5<code>--headed</code>\u6807\u5fd7\u5728 headed \u6a21\u5f0f\u4e0b\u8fd0\u884c\u6d4b\u8bd5\u3002</p> <ul> <li>\u5728 Chromium \u4e0a\u8fd0\u884c\u6d4b\u8bd5</li> </ul> <p><code>bash   pytest</code></p> <ul> <li>\u8fd0\u884c\u5355\u4e2a\u6d4b\u8bd5\u6587\u4ef6</li> </ul> <p><code>bash   pytest test_login.py</code></p> <ul> <li>\u8fd0\u884c\u4e00\u7ec4\u6d4b\u8bd5\u6587\u4ef6</li> </ul> <p><code>bash   pytest tests/todo-page/ tests/landing-page/</code></p> <ul> <li>\u4f7f\u7528\u51fd\u6570\u540d\u8fd0\u884c\u6d4b\u8bd5</li> </ul> <p><code>bash   pytest -k \"test_add_a_todo_item\"</code></p>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/playwright/playwright/#_4","title":"\u5f55\u5236\u6a21\u5f0f","text":"<p><code>bash   playwright codegen</code></p>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/playwright/playwright/#_5","title":"\u8ddf\u8e2a\u67e5\u770b\u5668","text":"<p>Playwright Trace Viewer \u662f\u4e00\u4e2a GUI \u5de5\u5177\uff0c\u53ef\u8ba9\u60a8\u63a2\u7d22\u8bb0\u5f55\u7684 Playwright \u6d4b\u8bd5\u8ddf\u8e2a\uff0c\u8fd9\u610f\u5473\u7740\u60a8\u53ef\u4ee5\u5728\u6d4b\u8bd5\u7684\u6bcf\u4e2a\u52a8\u4f5c\u4e2d\u524d\u540e\u79fb\u52a8\uff0c\u5e76\u76f4\u89c2\u5730\u67e5\u770b\u6bcf\u4e2a\u52a8\u4f5c\u671f\u95f4\u53d1\u751f\u7684\u60c5\u51b5\u3002</p> <pre><code>browser = chromium.launch()\ncontext = browser.new_context()\n\n# Start tracing before creating / navigating a page.\ncontext.tracing.start(screenshots=True, snapshots=True, sources=True)\n\npage.goto(\"https://playwright.dev\")\n\n# Stop tracing and export it into a zip archive.\ncontext.tracing.stop(path = \"trace.zip\")\n</code></pre> <p>\u8fd9\u5c06\u8bb0\u5f55\u8ddf\u8e2a\u5e76\u5c06\u5176\u653e\u5165\u540d\u4e3a<code>trace.zip</code>.</p>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/playwright/playwright/#_6","title":"\u6253\u5305\u6587\u4ef6","text":"<pre><code>$env:PLAYWRIGHT_BROWSERS_PATH=\"0\"\nplaywright install chromium\npyinstaller -F main.py\n</code></pre>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/playwright/playwright/#_7","title":"\u53d1\u884c\u8bf4\u660e","text":"<p>\u4f7f\u7528\u8fd9\u4e9b\u65b0\u7684 API \u7f16\u5199\u5b9a\u4f4d\u5668\u662f\u4e00\u79cd\u4e50\u8da3\uff1a</p> <ul> <li>page.get_by_text(text, **kwargs)\u6309\u6587\u672c\u5185\u5bb9\u5b9a\u4f4d\u3002</li> <li>page.get_by_role(role, **kwargs)\u901a\u8fc7ARIA \u89d2\u8272\u3001ARIA \u5c5e\u6027\u548c\u53ef\u8bbf\u95ee\u540d\u79f0\u6765\u5b9a\u4f4d\u3002</li> <li>page.get_by_label(text, **kwargs)\u901a\u8fc7\u5173\u8054\u6807\u7b7e\u7684\u6587\u672c\u5b9a\u4f4d\u8868\u5355\u63a7\u4ef6\u3002</li> <li>page.get_by_test_id(test_id)\u6839\u636e<code>data-testid</code>\u5c5e\u6027\u5b9a\u4f4d\u5143\u7d20\uff08\u53ef\u4ee5\u914d\u7f6e\u5176\u4ed6\u5c5e\u6027\uff09\u3002</li> <li>page.get_by_placeholder(text, **kwargs)\u901a\u8fc7\u5360\u4f4d\u7b26\u5b9a\u4f4d\u8f93\u5165\u3002</li> <li>page.get_by_alt_text(text, **kwargs)\u901a\u8fc7\u66ff\u4ee3\u6587\u672c\u6765\u5b9a\u4f4d\u5143\u7d20\uff0c\u901a\u5e38\u662f\u56fe\u50cf\u3002</li> <li>page.get_by_title(text, **kwargs)\u901a\u8fc7\u6807\u9898\u5b9a\u4f4d\u5143\u7d20\u3002</li> </ul>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/playwright/playwright/#_8","title":"\u6307\u5357","text":""},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/playwright/playwright/#_9","title":"\u52a8\u4f5c","text":""},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/playwright/playwright/#_10","title":"\u8f93\u5165","text":"<p>Playwright \u53ef\u4ee5\u4e0e HTML \u8f93\u5165\u5143\u7d20\u4ea4\u4e92\uff0c\u4f8b\u5982\u6587\u672c\u8f93\u5165\u3001\u590d\u9009\u6846\u3001\u5355\u9009\u6309\u94ae\u3001\u9009\u62e9\u9009\u9879\u3001\u9f20\u6807\u5355\u51fb\u3001\u952e\u5165\u5b57\u7b26\u3001\u952e\u548c\u5feb\u6377\u65b9\u5f0f\u4ee5\u53ca\u4e0a\u4f20\u6587\u4ef6\u548c\u7126\u70b9\u5143\u7d20\u3002</p> <pre><code># Text input\npage.get_by_role(\"textbox\").fill(\"Peter\")\n\n# Date input\npage.get_by_label(\"Birth date\").fill(\"2020-02-02\")\n\n# Time input\npage.get_by_label(\"Appointment time\").fill(\"13:15\")\n\n# Local datetime input\npage.get_by_label(\"Local time\").fill(\"2020-03-02T05:15\")\n</code></pre>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/playwright/playwright/#_11","title":"\u6309\u952e","text":"<pre><code># Hit Enter\npage.get_by_text(\"Submit\").press(\"Enter\")\n\n# Dispatch Control+Right\npage.get_by_role(\"textbox\").press(\"Control+ArrowRight\")\n\n# Press $ sign on keyboard\npage.get_by_role(\"textbox\").press(\"$\")\n</code></pre> <p>\u6a21\u62df\u771f\u5b9e\u9010\u4e2a\u5b57\u7b26\u5730\u8f93\u5165\u5b57\u6bb5</p> <pre><code># Type character by character\npage.locator('#area').type('Hello World!')\n</code></pre>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/playwright/playwright/#_12","title":"\u9f20\u6807","text":"<pre><code># Generic click\npage.get_by_role(\"button\").click()\n\n# Double click\npage.get_by_text(\"Item\").dblclick()\n\n# Right click\npage.get_by_text(\"Item\").click(button=\"right\")\n\n# Shift + click\npage.get_by_text(\"Item\").click(modifiers=[\"Shift\"])\n\n# Hover over element\npage.get_by_text(\"Item\").hover()\n\n# Click the top left corner\npage.get_by_text(\"Item\").click(position={ \"x\": 0, \"y\": 0})\n</code></pre>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/playwright/playwright/#_13","title":"\u81ea\u52a8\u7b49\u5f85","text":"<p>Playwright \u5728\u6267\u884c\u64cd\u4f5c\u4e4b\u524d\u5bf9\u5143\u7d20\u6267\u884c\u4e00\u7cfb\u5217\u53ef\u64cd\u4f5c\u6027\u68c0\u67e5\uff0c\u4ee5\u786e\u4fdd\u8fd9\u4e9b\u64cd\u4f5c\u6309\u9884\u671f\u8fd0\u884c\u3002\u5b83\u4f1a\u81ea\u52a8\u7b49\u5f85\u6240\u6709\u76f8\u5173\u68c0\u67e5\u901a\u8fc7\uff0c\u7136\u540e\u624d\u6267\u884c\u8bf7\u6c42\u7684\u64cd\u4f5c\u3002\u5982\u679c\u6240\u9700\u7684\u68c0\u67e5\u672a\u5728\u7ed9\u5b9a\u8303\u56f4\u5185\u901a\u8fc7<code>timeout</code>\uff0c\u5219\u64cd\u4f5c\u5931\u8d25\u5e76\u663e\u793a<code>TimeoutError</code>.</p>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/playwright/playwright/#api","title":"API\u6d4b\u8bd5","text":""},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/playwright/playwright/#api_1","title":"\u7f16\u5199API","text":"<p>APIRequestContext\u53ef\u4ee5\u901a\u8fc7\u7f51\u7edc\u53d1\u9001\u5404\u79cd HTTP(S) \u8bf7\u6c42\u3002</p>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/playwright/playwright/#debugging-selectors","title":"Debugging Selectors","text":"<pre><code>$env:DEBUG=\"pw:api\"\npytest -s\n</code></pre> <pre><code>&gt; playwright.$('.auth-form &gt;&gt; text=Log in');\n\n&lt;button&gt;Log in&lt;/button&gt;\n</code></pre>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/playwright/playwright/#_14","title":"\u5267\u4f5c\u5bb6.$$(\u9009\u62e9\u5668)","text":"<p>\u4e0e \u76f8\u540c<code>playwright.$</code>\uff0c\u4f46\u8fd4\u56de\u6240\u6709\u5339\u914d\u7684\u5143\u7d20\u3002</p> <pre><code>&gt; playwright.$$('li &gt;&gt; text=John')\n\n&gt; [&lt;li&gt;, &lt;li&gt;, &lt;li&gt;, &lt;li&gt;]\n</code></pre>"},{"location":"%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/playwright/playwright/#chrome-extensions","title":"Chrome Extensions","text":"<pre><code>from playwright.sync_api import sync_playwright\n\npath_to_extension = \"./my-extension\"\nuser_data_dir = \"/tmp/test-user-data-dir\"\n\ndef run(playwright):\n    context = playwright.chromium.launch_persistent_context(\n        user_data_dir,\n        headless=False,\n        args=[\n            f\"--disable-extensions-except={path_to_extension}\",\n            f\"--load-extension={path_to_extension}\",\n        ],\n    )\n    if len(context.background_pages) == 0:\n        background_page = context.wait_for_event('backgroundpage')\n    else:\n        background_page = context.background_pages[0]\n\n    # Test the background page as you would any other page.\n    context.close()\n\n\nwith sync_playwright() as playwright:\n    run(playwright)\n</code></pre>"}]}